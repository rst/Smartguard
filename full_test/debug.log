# Logfile created on Mon May 12 22:27:13 -0400 2008 by /
  [4;36;1mSQL (0.258240)[0m   [0;1mDROP TABLE blog_entries[0m
  [4;35;1mSQL (0.189245)[0m   [0mDROP SEQUENCE blog_entries_seq[0m
  [4;36;1mSQL (0.266103)[0m   [0;1mCREATE TABLE blog_entries (id NUMBER(38) NOT NULL PRIMARY KEY, blog_id NUMBER(38) NOT NULL, entry_txt CLOB NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;35;1mSQL (0.012739)[0m   [0mCREATE SEQUENCE blog_entries_seq START WITH 10000[0m
  [4;36;1mSQL (0.102324)[0m   [0;1mCREATE INDEX blog_entries_by_firm ON blog_entries (owner_firm_id)[0m
  [4;35;1mSQL (0.033891)[0m   [0mCREATE INDEX blog_entries_by_owner ON blog_entries (owner_id)[0m
  [4;36;1mSQL (0.079062)[0m   [0;1mDROP TABLE blogs[0m
  [4;35;1mSQL (0.011985)[0m   [0mDROP SEQUENCE blogs_seq[0m
  [4;36;1mSQL (0.094601)[0m   [0;1mCREATE TABLE blogs (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;35;1mSQL (0.030920)[0m   [0mCREATE SEQUENCE blogs_seq START WITH 10000[0m
  [4;36;1mSQL (0.120023)[0m   [0;1mCREATE INDEX blogs_by_firm ON blogs (owner_firm_id)[0m
  [4;35;1mSQL (0.008752)[0m   [0mCREATE INDEX blogs_by_owner ON blogs (owner_id)[0m
  [4;36;1mSQL (0.007991)[0m   [0;1mCREATE UNIQUE INDEX ix_blogs_by_name_owner_firm ON blogs (name, owner_firm_id)[0m
  [4;35;1mSQL (0.078576)[0m   [0mDROP TABLE entry_comments[0m
  [4;36;1mSQL (0.024703)[0m   [0;1mDROP SEQUENCE entry_comments_seq[0m
  [4;35;1mSQL (0.150952)[0m   [0mCREATE TABLE entry_comments (id NUMBER(38) NOT NULL PRIMARY KEY, blog_entry_id NUMBER(38) DEFAULT NULL, comment_txt CLOB NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;36;1mSQL (0.008818)[0m   [0;1mCREATE SEQUENCE entry_comments_seq START WITH 10000[0m
  [4;35;1mSQL (0.062085)[0m   [0mCREATE INDEX entry_comments_by_firm ON entry_comments (owner_firm_id)[0m
  [4;36;1mSQL (0.008553)[0m   [0;1mCREATE INDEX entry_comments_by_owner ON entry_comments (owner_id)[0m
  [4;35;1mSQL (0.000000)[0m   [0mOCIError: ORA-02449: unique/primary keys in table referenced by foreign keys: DROP TABLE firms[0m
  [4;36;1mSQL (0.000000)[0m   [0;1mOCIError: ORA-00955: name is already used by an existing object: CREATE TABLE firms (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;36;1mSQL (0.000000)[0m   [0;1mOCIError: ORA-00942: table or view does not exist: DROP TABLE blog_entries[0m
  [4;35;1mSQL (0.051111)[0m   [0mCREATE TABLE blog_entries (id NUMBER(38) NOT NULL PRIMARY KEY, blog_id NUMBER(38) NOT NULL, entry_txt CLOB NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;36;1mSQL (0.008340)[0m   [0;1mCREATE SEQUENCE blog_entries_seq START WITH 10000[0m
  [4;35;1mSQL (0.008244)[0m   [0mCREATE INDEX blog_entries_by_firm ON blog_entries (owner_firm_id)[0m
  [4;36;1mSQL (0.008609)[0m   [0;1mCREATE INDEX blog_entries_by_owner ON blog_entries (owner_id)[0m
  [4;35;1mSQL (0.000000)[0m   [0mOCIError: ORA-00942: table or view does not exist: DROP TABLE blogs[0m
  [4;36;1mSQL (0.028280)[0m   [0;1mCREATE TABLE blogs (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;35;1mSQL (0.008436)[0m   [0mCREATE SEQUENCE blogs_seq START WITH 10000[0m
  [4;36;1mSQL (0.008334)[0m   [0;1mCREATE INDEX blogs_by_firm ON blogs (owner_firm_id)[0m
  [4;35;1mSQL (0.009253)[0m   [0mCREATE INDEX blogs_by_owner ON blogs (owner_id)[0m
  [4;36;1mSQL (0.008468)[0m   [0;1mCREATE UNIQUE INDEX ix_blogs_by_name_owner_firm ON blogs (name, owner_firm_id)[0m
  [4;35;1mSQL (0.000000)[0m   [0mOCIError: ORA-00942: table or view does not exist: DROP TABLE entry_comments[0m
  [4;36;1mSQL (0.031113)[0m   [0;1mCREATE TABLE entry_comments (id NUMBER(38) NOT NULL PRIMARY KEY, blog_entry_id NUMBER(38) DEFAULT NULL, comment_txt CLOB NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;35;1mSQL (0.012807)[0m   [0mCREATE SEQUENCE entry_comments_seq START WITH 10000[0m
  [4;36;1mSQL (0.009317)[0m   [0;1mCREATE INDEX entry_comments_by_firm ON entry_comments (owner_firm_id)[0m
  [4;35;1mSQL (0.007887)[0m   [0mCREATE INDEX entry_comments_by_owner ON entry_comments (owner_id)[0m
  [4;36;1mSQL (0.000000)[0m   [0;1mOCIError: ORA-00942: table or view does not exist: DROP TABLE firms[0m
  [4;35;1mSQL (0.026016)[0m   [0mCREATE TABLE firms (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;36;1mSQL (0.013725)[0m   [0;1mCREATE SEQUENCE firms_seq START WITH 10000[0m
  [4;35;1mSQL (0.000000)[0m   [0mOCIError: ORA-00942: table or view does not exist: DROP TABLE pcheck_log_entries[0m
  [4;36;1mSQL (0.033134)[0m   [0;1mCREATE TABLE pcheck_log_entries (id NUMBER(38) NOT NULL PRIMARY KEY, request_log_entry_id NUMBER(38) NOT NULL, success NUMBER(1) NOT NULL, model_class VARCHAR2(100) NOT NULL, model_id NUMBER(38) DEFAULT NULL, privilege VARCHAR2(40) NOT NULL, user_id NUMBER(38) NOT NULL, user_name VARCHAR2(100) NOT NULL, created_at DATE DEFAULT NULL, updated_at DATE DEFAULT NULL) [0m
  [4;35;1mSQL (0.012771)[0m   [0mCREATE SEQUENCE pcheck_log_entries_seq START WITH 10000[0m
  [4;36;1mSQL (0.000000)[0m   [0;1mOCIError: ORA-00942: table or view does not exist: DROP TABLE permissions[0m
  [4;35;1mSQL (0.032664)[0m   [0mCREATE TABLE permissions (id NUMBER(38) NOT NULL PRIMARY KEY, role_id NUMBER(38) DEFAULT NULL, is_grant NUMBER(1) NOT NULL, has_grant_option NUMBER(1) NOT NULL, class_name VARCHAR2(40) NOT NULL, privilege VARCHAR2(40) NOT NULL, target_owned_by_self NUMBER(1) NOT NULL, target_owner_id NUMBER(38) DEFAULT NULL, target_owner_firm_id NUMBER(38) DEFAULT NULL, target_id NUMBER(38) DEFAULT NULL, target_name VARCHAR2(100) DEFAULT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;36;1mSQL (0.014071)[0m   [0;1mCREATE SEQUENCE permissions_seq START WITH 10000[0m
  [4;35;1mSQL (0.008777)[0m   [0mCREATE INDEX index_permissions_on_role_id ON permissions (role_id)[0m
  [4;36;1mSQL (0.000000)[0m   [0;1mOCIError: ORA-00942: table or view does not exist: DROP TABLE request_log_entries[0m
  [4;35;1mSQL (0.029289)[0m   [0mCREATE TABLE request_log_entries (id NUMBER(38) NOT NULL PRIMARY KEY, created_at DATE DEFAULT NULL, updated_at DATE DEFAULT NULL, acting_user_id NUMBER(38) DEFAULT NULL, user_of_record_id NUMBER(38) DEFAULT NULL, acting_user_name VARCHAR2(255) DEFAULT NULL, user_of_record_name VARCHAR2(255) DEFAULT NULL, controller VARCHAR2(100) NOT NULL, action VARCHAR2(100) NOT NULL, http_method VARCHAR2(50) NOT NULL, status VARCHAR2(100) NOT NULL, model_class VARCHAR2(100) DEFAULT NULL, model_id NUMBER(38) DEFAULT NULL, remote_ip VARCHAR2(50) DEFAULT NULL) [0m
  [4;36;1mSQL (0.005956)[0m   [0;1mCREATE SEQUENCE request_log_entries_seq START WITH 10000[0m
  [4;35;1mSQL (0.000000)[0m   [0mOCIError: ORA-00942: table or view does not exist: DROP TABLE role_assignments[0m
  [4;36;1mSQL (0.030361)[0m   [0;1mCREATE TABLE role_assignments (id NUMBER(38) NOT NULL PRIMARY KEY, user_id NUMBER(38) NOT NULL, role_id NUMBER(38) NOT NULL, default_user_id NUMBER(38) DEFAULT NULL, default_firm_id NUMBER(38) DEFAULT NULL, invalid_after DATE DEFAULT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;35;1mSQL (0.008644)[0m   [0mCREATE SEQUENCE role_assignments_seq START WITH 10000[0m
  [4;36;1mSQL (0.000000)[0m   [0;1mOCIError: ORA-00942: table or view does not exist: DROP TABLE roles[0m
  [4;35;1mSQL (0.025754)[0m   [0mCREATE TABLE roles (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;36;1mSQL (0.011996)[0m   [0;1mCREATE SEQUENCE roles_seq START WITH 10000[0m
  [4;35;1mSQL (0.008389)[0m   [0mCREATE INDEX roles_by_firm ON roles (owner_firm_id)[0m
  [4;36;1mSQL (0.008810)[0m   [0;1mCREATE INDEX roles_by_owner ON roles (owner_id)[0m
  [4;35;1mSQL (0.000000)[0m   [0mOCIError: ORA-00942: table or view does not exist: DROP TABLE users[0m
  [4;36;1mSQL (0.028699)[0m   [0;1mCREATE TABLE users (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, owner_firm_id NUMBER(38) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;35;1mSQL (0.008238)[0m   [0mCREATE SEQUENCE users_seq START WITH 10000[0m
  [4;36;1mSQL (0.007364)[0m   [0;1mCREATE TABLE schema_info (version NUMBER(38))[0m
  [4;35;1mSQL (0.008893)[0m   [0mINSERT INTO schema_info (version) VALUES(0)[0m
  [4;36;1mSQL (0.022493)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'SCHEMA_INFO'
 order by column_id
[0m
  [4;35;1mSQL (0.014798)[0m   [0mUPDATE schema_info SET version = 1[0m
  [4;36;1mAcPhonyBlog Columns (0.001309)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;35;1mUser Load (0.008661)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000937)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.019915)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.007752)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.018815)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.027973)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.006745)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:57', 10000, 2, 5, '2008-05-12 22:29:57')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.021318)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10000)
  [4;35;1mSQL (0.012039)[0m   [0mselect 'x' from roles where id = 10000 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.006740)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:57', 10000, 10000, 5, NULL, '2008-05-12 22:29:57', NULL)[0m
  [4;35;1mRoleAssignment Load (0.009261)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.010590)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.017001)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10000)
  [4;36;1mSQL (0.011808)[0m   [0;1mselect 'x' from roles where id = 10000 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.007021)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:57', NULL, NULL, 10000, 10000, NULL, 0, '2008-05-12 22:29:57', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.003264)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10000)
  [4;35;1mRole Destroy (0.007316)[0m   [0m DELETE FROM roles
 WHERE id = 10000
[0m
  [4;36;1mRoleAssignment Load (0.001968)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000827)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.007576)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10000
[0m
  [4;35;1mRoleAssignment Load (0.001216)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001320)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002157)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001449)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001124)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000629)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:57', 10001, 2, 5, '2008-05-12 22:29:57')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002205)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10001)
  [4;36;1mSQL (0.001444)[0m   [0;1mselect 'x' from roles where id = 10001 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000623)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:57', 10001, 10001, 5, NULL, '2008-05-12 22:29:57', NULL)[0m
  [4;36;1mRole Load (0.008192)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001623)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.002071)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001317)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:57', 4, 10002, 5, NULL, '2008-05-12 22:29:57', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001057)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002847)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.012096)[0m   [0;1mselect 'x' from roles where id = 10001 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001749)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10001) [0m
  [4;36;1mPermission Create (0.007747)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:57', NULL, 'fred the blog', 10001, 10001, NULL, 0, '2008-05-12 22:29:57', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002564)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10001)
  [4;36;1mRole Destroy (0.001445)[0m   [0;1m DELETE FROM roles
 WHERE id = 10001
[0m
  [4;35;1mRoleAssignment Load (0.001095)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001479)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000461)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10001
[0m
  [4;36;1mUser Load (0.001460)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000429)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10002
[0m
  [4;36;1mRoleAssignment Load (0.001658)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000605)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002597)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000982)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001443)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000650)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001438)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001086)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002865)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001394)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:57', 10002, 2, 5, '2008-05-12 22:29:57')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001511)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10002)
  [4;35;1mSQL (0.002049)[0m   [0mselect 'x' from roles where id = 10002 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001268)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:57', 10002, 10003, 5, NULL, '2008-05-12 22:29:57', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001031)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002616)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000914)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10002)
  [4;36;1mSQL (0.002206)[0m   [0;1mselect 'x' from roles where id = 10002 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001427)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:57', NULL, NULL, 10002, 10002, NULL, 0, '2008-05-12 22:29:57', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002022)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10002)
  [4;35;1mRole Destroy (0.001337)[0m   [0m DELETE FROM roles
 WHERE id = 10002
[0m
  [4;36;1mRoleAssignment Load (0.001077)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001477)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000436)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10003
[0m
  [4;35;1mRoleAssignment Load (0.001645)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000606)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002627)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000702)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001741)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001259)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:57', 10003, 2, 5, '2008-05-12 22:29:57')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001476)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10003)
  [4;36;1mSQL (0.002038)[0m   [0;1mselect 'x' from roles where id = 10003 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001255)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:57', 10003, 10004, 5, NULL, '2008-05-12 22:29:57', NULL)[0m
  [4;36;1mRole Load (0.000884)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002038)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001367)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000582)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:57', 4, 10005, 5, NULL, '2008-05-12 22:29:57', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001697)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002024)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002387)[0m   [0;1mselect 'x' from roles where id = 10003 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000927)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10003) [0m
  [4;36;1mPermission Create (0.000723)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:57', NULL, 'fred the blog', 10003, 10003, NULL, 0, '2008-05-12 22:29:57', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002899)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10003)
  [4;36;1mRole Destroy (0.000685)[0m   [0;1m DELETE FROM roles
 WHERE id = 10003
[0m
  [4;35;1mRoleAssignment Load (0.001752)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000818)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001105)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10004
[0m
  [4;36;1mUser Load (0.000785)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001097)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10005
[0m
  [4;36;1mRoleAssignment Load (0.000971)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001276)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002119)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001620)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000774)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001308)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000742)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001772)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002151)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000701)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:57', 10004, 2, 5, '2008-05-12 22:29:57')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002156)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10004)
  [4;35;1mSQL (0.001388)[0m   [0mselect 'x' from roles where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000602)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:57', 10004, 10006, 5, NULL, '2008-05-12 22:29:57', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001690)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001935)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001547)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10004)
  [4;36;1mSQL (0.001513)[0m   [0;1mselect 'x' from roles where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000737)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:57', NULL, NULL, 10004, 10004, NULL, 0, '2008-05-12 22:29:57', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002810)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10004)
  [4;35;1mRole Destroy (0.000675)[0m   [0m DELETE FROM roles
 WHERE id = 10004
[0m
  [4;36;1mRoleAssignment Load (0.001736)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000906)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001108)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10006
[0m
  [4;35;1mRoleAssignment Load (0.000976)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001276)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002107)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001411)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001086)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000598)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10005, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002153)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10005)
  [4;36;1mSQL (0.001381)[0m   [0;1mselect 'x' from roles where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000589)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10005, 10007, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRole Load (0.001535)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001345)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.002019)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001250)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 4, 10008, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001019)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002815)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001728)[0m   [0;1mselect 'x' from roles where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001594)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10005) [0m
  [4;36;1mPermission Create (0.001382)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, 'fred the blog', 10005, 10005, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002361)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10005)
  [4;36;1mRole Destroy (0.001369)[0m   [0;1m DELETE FROM roles
 WHERE id = 10005
[0m
  [4;35;1mRoleAssignment Load (0.001075)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001482)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000445)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10007
[0m
  [4;36;1mUser Load (0.001456)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000447)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10008
[0m
  [4;36;1mRoleAssignment Load (0.001637)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000605)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002909)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001504)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000773)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001308)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000724)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001759)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002157)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000715)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10006, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002168)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10006)
  [4;35;1mSQL (0.001379)[0m   [0mselect 'x' from roles where id = 10006 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000605)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10006, 10009, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001711)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001950)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001024)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10006)
  [4;36;1mSQL (0.001606)[0m   [0;1mselect 'x' from roles where id = 10006 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000734)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, NULL, 10006, 10006, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002697)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10006)
  [4;35;1mRole Destroy (0.000651)[0m   [0m DELETE FROM roles
 WHERE id = 10006
[0m
  [4;36;1mRoleAssignment Load (0.001744)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000825)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001118)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10009
[0m
  [4;35;1mRoleAssignment Load (0.000988)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001285)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001969)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001386)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001097)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000602)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10007, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002157)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10007)
  [4;36;1mSQL (0.001398)[0m   [0;1mselect 'x' from roles where id = 10007 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000593)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10007, 10010, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRole Load (0.001571)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001378)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.002032)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001251)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 4, 10011, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001044)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002708)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001686)[0m   [0;1mselect 'x' from roles where id = 10007 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001614)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10007) [0m
  [4;36;1mPermission Create (0.001373)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, 'fred the blog', 10007, 10007, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002238)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10007)
  [4;36;1mRole Destroy (0.001423)[0m   [0;1m DELETE FROM roles
 WHERE id = 10007
[0m
  [4;35;1mRoleAssignment Load (0.001091)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001487)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000440)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10010
[0m
  [4;36;1mUser Load (0.001457)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000421)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10011
[0m
  [4;36;1mRoleAssignment Load (0.001642)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000609)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002791)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000736)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001758)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001273)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10008, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001496)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10008)
  [4;35;1mSQL (0.002061)[0m   [0mselect 'x' from roles where id = 10008 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001264)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10008, 10012, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001363)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.002022)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001249)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 4, 10013, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001031)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002817)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001716)[0m   [0;1mselect 'x' from roles where id = 10008 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001585)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10008) [0m
  [4;36;1mPermission Create (0.001371)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, 'fred the blog', 10008, 10008, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002344)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10008)
  [4;36;1mRole Destroy (0.001391)[0m   [0;1m DELETE FROM roles
 WHERE id = 10008
[0m
  [4;35;1mRoleAssignment Load (0.001090)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001488)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000446)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10012
[0m
  [4;36;1mUser Load (0.001453)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000421)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10013
[0m
  [4;36;1mRoleAssignment Load (0.001643)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000608)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002913)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000966)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001450)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000642)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001410)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001085)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002823)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001376)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10009, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001492)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10009)
  [4;35;1mSQL (0.002048)[0m   [0mselect 'x' from roles where id = 10009 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001265)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10009, 10014, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001035)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002602)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000871)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10009)
  [4;36;1mSQL (0.002195)[0m   [0;1mselect 'x' from roles where id = 10009 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001396)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, NULL, 10009, 10009, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002020)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10009)
  [4;35;1mRole Destroy (0.001339)[0m   [0m DELETE FROM roles
 WHERE id = 10009
[0m
  [4;36;1mRoleAssignment Load (0.001109)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001488)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000481)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10014
[0m
  [4;35;1mRoleAssignment Load (0.001738)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000643)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002666)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000751)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001776)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001293)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10010, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001505)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10010)
  [4;36;1mSQL (0.002089)[0m   [0;1mselect 'x' from roles where id = 10010 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001277)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10010, 10015, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRole Load (0.000907)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002092)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001425)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000624)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 4, 10016, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001719)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002050)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002360)[0m   [0;1mselect 'x' from roles where id = 10010 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000946)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10010) [0m
  [4;36;1mPermission Create (0.000732)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, 'fred the blog', 10010, 10010, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002926)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10010)
  [4;36;1mRole Destroy (0.000759)[0m   [0;1m DELETE FROM roles
 WHERE id = 10010
[0m
  [4;35;1mRoleAssignment Load (0.001774)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000832)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001144)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10015
[0m
  [4;36;1mUser Load (0.000809)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001116)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10016
[0m
  [4;36;1mRoleAssignment Load (0.001014)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001274)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002108)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001617)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000768)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001304)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000740)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001745)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002149)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000702)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10011, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002153)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10011)
  [4;35;1mSQL (0.001381)[0m   [0mselect 'x' from roles where id = 10011 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000597)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10011, 10017, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001689)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001929)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001543)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10011)
  [4;36;1mSQL (0.001509)[0m   [0;1mselect 'x' from roles where id = 10011 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000725)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, NULL, 10011, 10011, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002795)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10011)
  [4;35;1mRole Destroy (0.000669)[0m   [0m DELETE FROM roles
 WHERE id = 10011
[0m
  [4;36;1mRoleAssignment Load (0.001735)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000814)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001113)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10017
[0m
  [4;35;1mRoleAssignment Load (0.000968)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001272)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002111)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001404)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001076)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000596)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10012, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002150)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10012)
  [4;36;1mSQL (0.001366)[0m   [0;1mselect 'x' from roles where id = 10012 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000587)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10012, 10018, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRole Load (0.001560)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001356)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.002016)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001256)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 4, 10019, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001035)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002815)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001730)[0m   [0;1mselect 'x' from roles where id = 10012 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001600)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10012) [0m
  [4;36;1mPermission Create (0.001379)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, 'fred the blog', 10012, 10012, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002237)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10012)
  [4;36;1mRole Destroy (0.001341)[0m   [0;1m DELETE FROM roles
 WHERE id = 10012
[0m
  [4;35;1mRoleAssignment Load (0.001077)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001484)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000446)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10018
[0m
  [4;36;1mUser Load (0.001455)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000419)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10019
[0m
  [4;36;1mRoleAssignment Load (0.001640)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000608)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002774)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000946)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001435)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000637)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001412)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001086)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002801)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001374)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10013, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001488)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10013)
  [4;35;1mSQL (0.002040)[0m   [0mselect 'x' from roles where id = 10013 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001319)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10013, 10020, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001049)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002650)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000876)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10013)
  [4;36;1mSQL (0.002197)[0m   [0;1mselect 'x' from roles where id = 10013 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001405)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, NULL, 10013, 10013, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002137)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10013)
  [4;35;1mRole Destroy (0.001339)[0m   [0m DELETE FROM roles
 WHERE id = 10013
[0m
  [4;36;1mRoleAssignment Load (0.001063)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001482)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000438)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10020
[0m
  [4;35;1mRoleAssignment Load (0.001643)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000607)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002767)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000735)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001748)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001264)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10014, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001484)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10014)
  [4;36;1mSQL (0.002039)[0m   [0;1mselect 'x' from roles where id = 10014 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001254)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10014, 10021, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRole Load (0.000893)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002029)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001363)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000582)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 4, 10022, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001704)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002148)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002396)[0m   [0;1mselect 'x' from roles where id = 10014 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000934)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10014) [0m
  [4;36;1mPermission Create (0.000708)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, 'fred the blog', 10014, 10014, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002894)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10014)
  [4;36;1mRole Destroy (0.000700)[0m   [0;1m DELETE FROM roles
 WHERE id = 10014
[0m
  [4;35;1mRoleAssignment Load (0.001746)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000819)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001105)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10021
[0m
  [4;36;1mUser Load (0.000782)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001087)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10022
[0m
  [4;36;1mRoleAssignment Load (0.000971)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001277)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002093)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001617)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000773)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001303)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000745)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001750)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002153)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000709)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10015, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002163)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10015)
  [4;35;1mSQL (0.001381)[0m   [0mselect 'x' from roles where id = 10015 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000602)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10015, 10023, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001691)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001931)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001540)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10015)
  [4;36;1mSQL (0.001522)[0m   [0;1mselect 'x' from roles where id = 10015 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000722)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, NULL, 10015, 10015, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002692)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10015)
  [4;35;1mRole Destroy (0.000660)[0m   [0m DELETE FROM roles
 WHERE id = 10015
[0m
  [4;36;1mRoleAssignment Load (0.001737)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000816)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001106)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10023
[0m
  [4;35;1mRoleAssignment Load (0.000980)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001276)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001981)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001376)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001079)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000595)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:29:58', 10016, 2, 5, '2008-05-12 22:29:58')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002147)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10016)
  [4;36;1mSQL (0.001379)[0m   [0;1mselect 'x' from roles where id = 10016 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000593)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 10016, 10024, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRole Load (0.001559)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001376)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.002020)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001253)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:29:58', 4, 10025, 5, NULL, '2008-05-12 22:29:58', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001032)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002692)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001677)[0m   [0;1mselect 'x' from roles where id = 10016 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001597)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10016) [0m
  [4;36;1mPermission Create (0.001374)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:29:58', NULL, 'fred the blog', 10016, 10016, NULL, 0, '2008-05-12 22:29:58', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002113)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10016)
  [4;36;1mRole Destroy (0.001346)[0m   [0;1m DELETE FROM roles
 WHERE id = 10016
[0m
  [4;35;1mRoleAssignment Load (0.001084)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001491)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000465)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10024
[0m
  [4;36;1mUser Load (0.001472)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000425)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10025
[0m
  [4;36;1mRoleAssignment Load (0.001645)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000612)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002637)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001578)[0m   [0mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;36;1mBlog Load (0.016089)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id IS NULL) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.026273)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.000929)[0m   [0;1mSELECT * FROM users WHERE (users.id = 2) [0m
  [4;35;1mBlog Load (0.001833)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.001131)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001643)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.008328)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = '' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001808)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'x' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.000990)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'ab' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001687)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'mertz family blog' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.005664)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001826)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'ricardo family blog' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.001014)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001672)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.001046)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Create (0.006800)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx', '2008-05-12 22:29:59', 10000, 4, 2, '2008-05-12 22:29:59')[0m
  [4;36;1mUser Load (0.000962)[0m   [0;1mSELECT * FROM users WHERE (users.id = 2) [0m
  [4;35;1mFirm Load (0.001445)[0m   [0mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;36;1mUser Load (0.000801)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;35;1mRole Load (0.001511)[0m   [0mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;36;1mSQL (0.011825)[0m   [0;1mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 4
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 4)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002419)[0m   [0mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 4
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 4)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000964)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;35;1mPermission Load (0.011374)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 4
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: assign Role admin(1)
  [4;36;1mUser Load (0.000955)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;35;1mRole Load (0.001525)[0m   [0mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;36;1mPermission Load (0.002819)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 4
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role admin(2)
  [4;35;1mRole Load (0.001012)[0m   [0mSELECT * FROM roles WHERE (roles.id = 1) [0m
=== FAILED permission check: edit Role admin(1)
  [4;36;1mUser Load (0.001480)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mRole Load (0.000852)[0m   [0mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;36;1mPermission Load (0.002751)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role admin(2)
  [4;35;1mSQL (0.001700)[0m   [0mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000792)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', NULL, NULL, 2, 10017, NULL, 0, '2008-05-12 22:30:00', 'post', NULL)[0m
  [4;35;1mUser Load (0.001506)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;36;1mPermission Load (0.002140)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 4
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role admin(2)
  [4;35;1mSQL (0.012730)[0m   [0mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 4
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 4)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mBlog Load (0.007663)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mBlog Load (0.001684)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mRole Load (0.001549)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;35;1mUser Load (0.000805)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001437)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000690)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001389)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001085)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002791)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001398)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:00', 10017, 2, 5, '2008-05-12 22:30:00')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001525)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10017)
  [4;35;1mSQL (0.002095)[0m   [0mselect 'x' from roles where id = 10017 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001299)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:00', 10017, 10026, 5, NULL, '2008-05-12 22:30:00', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001039)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002631)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000902)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: edit Role admin(1)
=== permission check: edit Role test role(10017)
  [4;36;1mSQL (0.002182)[0m   [0;1mselect 'x' from roles where id = 10017 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.007841)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:30:00', 1, 'admin', 10017, 10018, NULL, 0, '2008-05-12 22:30:00', 'edit', NULL)[0m
  [4;36;1mPermission Load (0.002371)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role admin(1)
  [4;35;1mSQL (0.002470)[0m   [0mselect 'x' from roles where id = 1 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10017)
  [4;36;1mRole Destroy (0.000618)[0m   [0;1m DELETE FROM roles
 WHERE id = 10017
[0m
  [4;35;1mRoleAssignment Load (0.001732)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000814)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001127)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10026
[0m
  [4;36;1mRoleAssignment Load (0.000989)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002085)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Create (0.000762)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', NULL, NULL, 1, 10019, NULL, 0, '2008-05-12 22:30:00', 'any', NULL)[0m
  [4;36;1mFirm Load (0.001455)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mUser Load (0.000819)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001441)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000647)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001740)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002137)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000692)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:00', 10018, 2, 5, '2008-05-12 22:30:00')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002161)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10018)
  [4;36;1mSQL (0.001389)[0m   [0;1mselect 'x' from roles where id = 10018 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000604)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:00', 10018, 10027, 5, NULL, '2008-05-12 22:30:00', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001696)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001927)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10018)
  [4;36;1mSQL (0.002225)[0m   [0;1mselect 'x' from roles where id = 10018 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.007801)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', NULL, NULL, 10018, 10020, 2, 0, '2008-05-12 22:30:00', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002354)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.009241)[0m   [0mSELECT * FROM blogs WHERE (blogs.owner_firm_id = 2) [0m
  [4;36;1mBlog Load (0.020799)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.017599)[0m   [0mSELECT * FROM blogs WHERE (blogs.owner_firm_id = 2) AND (name like 'ric%') [0m
  [4;36;1mBlog Load (0.029876)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
 and name like 'ric%') [0m
  [4;35;1mBlog Load (0.009113)[0m   [0mSELECT * FROM blogs WHERE (blogs.owner_firm_id = 2) AND (name like 'ricky%') [0m
  [4;36;1mBlog Load (0.012870)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
 and name like 'ricky%') [0m
=== permission check: destroy Role test role(10018)
  [4;35;1mRole Destroy (0.001367)[0m   [0m DELETE FROM roles
 WHERE id = 10018
[0m
  [4;36;1mRoleAssignment Load (0.001073)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001488)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000460)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10027
[0m
  [4;35;1mRoleAssignment Load (0.001642)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000611)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002772)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000921)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mUser Load (0.001445)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mUser Load (0.000766)[0m   [0;1mSELECT * FROM users WHERE (users.id = 1) [0m
  [4;35;1mRole Load (0.001510)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;36;1mPermission Load (0.002178)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role twiddler(3)
  [4;35;1mSQL (0.002356)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.007892)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', NULL, NULL, 3, 10021, NULL, 0, '2008-05-12 22:30:00', 'any', 3)[0m
  [4;35;1mPermission Update (0.007778)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10021[0m
  [4;36;1mPermission Update (0.001441)[0m   [0;1mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10021[0m
  [4;35;1mPermission Update (0.000609)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10021[0m
  [4;36;1mPermission Update (0.001254)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'blurfl', created_at = '2008-05-12 22:30:00' WHERE id = 10021[0m
  [4;35;1mPermission Update (0.000586)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10021[0m
  [4;36;1mPermission Update (0.001237)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10021[0m
  [4;35;1mPermission Update (0.000585)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10021[0m
  [4;36;1mFirm Load (0.001495)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mFirm Load (0.000717)[0m   [0mSELECT * FROM firms WHERE (firms.id = 4) [0m
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.002300)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001434)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', NULL, NULL, 3, 10022, 2, 0, '2008-05-12 22:30:00', 'any', NULL)[0m
  [4;36;1mPermission Update (0.007850)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10022[0m
  [4;35;1mPermission Update (0.001441)[0m   [0mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10022[0m
  [4;36;1mPermission Update (0.000606)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10022[0m
  [4;35;1mPermission Update (0.001253)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:30:00' WHERE id = 10022[0m
  [4;36;1mPermission Update (0.000585)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10022[0m
  [4;35;1mPermission Update (0.001235)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10022[0m
  [4;36;1mPermission Update (0.000582)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10022[0m
=== permission check: edit Role twiddler(3)
  [4;35;1mSQL (0.002366)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001399)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:00', NULL, NULL, 3, 10023, NULL, 0, '2008-05-12 22:30:00', 'any', NULL)[0m
  [4;35;1mPermission Update (0.007866)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10023[0m
  [4;36;1mPermission Update (0.001436)[0m   [0;1mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10023[0m
  [4;35;1mPermission Update (0.000603)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10023[0m
  [4;36;1mPermission Update (0.001256)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:30:00' WHERE id = 10023[0m
  [4;35;1mPermission Update (0.000592)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10023[0m
  [4;36;1mPermission Update (0.001234)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10023[0m
  [4;35;1mPermission Update (0.000589)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10023[0m
  [4;36;1mBlog Load (0.001613)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
=== permission check: edit Role twiddler(3)
  [4;35;1mSQL (0.001646)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000765)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', 1, 'mertz family blog', 3, 10024, NULL, 0, '2008-05-12 22:30:00', 'any', NULL)[0m
  [4;35;1mPermission Update (0.008515)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10024[0m
  [4;36;1mPermission Update (0.000777)[0m   [0;1mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10024[0m
  [4;35;1mPermission Update (0.001282)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10024[0m
  [4;36;1mPermission Update (0.000593)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:30:00' WHERE id = 10024[0m
  [4;35;1mPermission Update (0.001269)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10024[0m
  [4;36;1mPermission Update (0.000586)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10024[0m
  [4;35;1mPermission Update (0.001257)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:00', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:00' WHERE id = 10024[0m
  [4;36;1mBlog Load (0.025654)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'Ricardo blog' AND blogs.owner_firm_id IS NULL) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001561)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000776)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001340)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000716)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001765)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002133)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000726)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:00', 10019, 2, 5, '2008-05-12 22:30:00')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002194)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10019)
  [4;35;1mSQL (0.001412)[0m   [0mselect 'x' from roles where id = 10019 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000621)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:00', 10019, 10028, 5, NULL, '2008-05-12 22:30:00', NULL)[0m
  [4;35;1mRole Load (0.001547)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001365)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.002021)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001252)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:00', 4, 10029, 5, NULL, '2008-05-12 22:30:00', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001048)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002709)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.000993)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
=== FAILED permission check: grok Blog mertz family blog(1)
=== FAILED permission check: grok Blog mertz family blog(1)
  [4;36;1mSQL (0.002195)[0m   [0;1mselect 'x' from roles where id = 10019 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000935)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10019) [0m
  [4;36;1mPermission Create (0.000714)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', 1, 'mertz family blog', 10019, 10025, NULL, 0, '2008-05-12 22:30:00', 'grok', NULL)[0m
  [4;35;1mPermission Load (0.002896)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grok Blog mertz family blog(1)
=== permission check: destroy Role test role(10019)
  [4;36;1mRole Destroy (0.000677)[0m   [0;1m DELETE FROM roles
 WHERE id = 10019
[0m
  [4;35;1mRoleAssignment Load (0.001746)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000813)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001112)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10028
[0m
  [4;36;1mUser Load (0.000790)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001090)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10029
[0m
  [4;36;1mRoleAssignment Load (0.000965)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001276)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002108)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001593)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000773)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001304)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000721)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001740)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002127)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000712)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:00', 10020, 2, 5, '2008-05-12 22:30:00')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002206)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10020)
  [4;35;1mSQL (0.001405)[0m   [0mselect 'x' from roles where id = 10020 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000627)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:00', 10020, 10030, 5, NULL, '2008-05-12 22:30:00', NULL)[0m
  [4;35;1mRole Load (0.001551)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001368)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.002022)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001253)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:00', 4, 10031, 5, NULL, '2008-05-12 22:30:00', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001033)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002698)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001597)[0m   [0mselect 'x' from roles where id = 10020 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001585)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10020) [0m
  [4;35;1mPermission Create (0.001386)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:00', NULL, NULL, 10020, 10026, NULL, 0, '2008-05-12 22:30:00', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002229)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.002314)[0m   [0mselect 'x' from roles where id = 10020 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000904)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10020) [0m
  [4;35;1mPermission Create (0.001359)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:00', NULL, NULL, 10020, 10027, NULL, 0, '2008-05-12 22:30:00', 'any', NULL)[0m
  [4;36;1mSQL (0.023711)[0m   [0;1mSELECT count(*) AS count_all FROM permissions WHERE (permissions.role_id = 10020) [0m
  [4;35;1mPermission Load (0.003061)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10020)
  [4;36;1mRole Destroy (0.000670)[0m   [0;1m DELETE FROM roles
 WHERE id = 10020
[0m
  [4;35;1mRoleAssignment Load (0.001745)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000815)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001112)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10030
[0m
  [4;36;1mUser Load (0.000786)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001088)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10031
[0m
  [4;36;1mRoleAssignment Load (0.000971)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001273)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002111)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000925)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;36;1mPermission Load (0.002806)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 4
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000923)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mPermission Load (0.002681)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.000841)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mUser Load (0.001462)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000761)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001304)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001083)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002764)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001367)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:00', 10021, 2, 5, '2008-05-12 22:30:00')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001495)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10021)
  [4;35;1mSQL (0.002052)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001268)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:00', 10021, 10032, 5, NULL, '2008-05-12 22:30:00', NULL)[0m
  [4;35;1mRole Load (0.000869)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002019)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001358)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000624)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:00', 4, 10033, 5, NULL, '2008-05-12 22:30:00', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001709)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002029)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001580)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mUser Load (0.000765)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;35;1mFirm Load (0.001381)[0m   [0mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;36;1mSQL (0.004852)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mBlog Load (0.001843)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 5' AND blogs.owner_firm_id = 3) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Create (0.001312)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 5', '2008-05-12 22:30:00', 10001, 3, 5, '2008-05-12 22:30:00')[0m
  [4;35;1mSQL (0.000564)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mBlog Load (0.001681)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 6' AND blogs.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Create (0.001187)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 6', '2008-05-12 22:30:00', 10002, 2, 5, '2008-05-12 22:30:00')[0m
  [4;36;1mSQL (0.000547)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mBlog Load (0.001668)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 7' AND blogs.owner_firm_id = 3) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Create (0.001165)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 7', '2008-05-12 22:30:00', 10003, 3, 3, '2008-05-12 22:30:00')[0m
  [4;35;1mSQL (0.000530)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mBlog Load (0.001667)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 8' AND blogs.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Create (0.001157)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 8', '2008-05-12 22:30:00', 10004, 2, 3, '2008-05-12 22:30:00')[0m
  [4;36;1mSQL (0.001198)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mBlog Load (0.000992)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 9' AND blogs.owner_firm_id = 3) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Create (0.000489)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 9', '2008-05-12 22:30:00', 10005, 3, 4, '2008-05-12 22:30:00')[0m
  [4;35;1mSQL (0.001195)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mBlog Load (0.000989)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 10' AND blogs.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Create (0.000492)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 10', '2008-05-12 22:30:00', 10006, 2, 4, '2008-05-12 22:30:00')[0m
  [4;36;1mBlog Load (0.001579)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mRole Load (0.000859)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;36;1mSQL (0.002300)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000965)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;36;1mPermission Create (0.000730)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', NULL, NULL, 3, 10028, NULL, 0, '2008-05-12 22:30:00', 'post', 3)[0m
  [4;35;1mSQL (0.002240)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000954)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mPermission Create (0.000690)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', NULL, NULL, 3, 10029, 3, 0, '2008-05-12 22:30:00', 'post', NULL)[0m
  [4;36;1mSQL (0.002344)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000971)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;36;1mPermission Create (0.000671)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:00', NULL, NULL, 3, 10030, NULL, 0, '2008-05-12 22:30:00', 'post', NULL)[0m
  [4;35;1mSQL (0.002246)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000966)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mPermission Create (0.000681)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:00', 1, 'mertz family blog', 3, 10031, NULL, 0, '2008-05-12 22:30:00', 'post', NULL)[0m
  [4;36;1mSQL (0.008617)[0m   [0;1mSELECT count(*) AS count_all FROM permissions WHERE (permissions.role_id = 10021) [0m
  [4;35;1mPermission Load (0.008880)[0m   [0mSELECT * FROM permissions WHERE (permissions.role_id = 4) [0m
  [4;36;1mSQL (0.012401)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001593)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000730)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:01', NULL, NULL, 10021, 10032, NULL, 0, '2008-05-12 22:30:01', 'post', 3)[0m
  [4;35;1mPermission Load (0.002907)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000905)[0m   [0;1mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10032[0m
  [4;35;1mSQL (0.002534)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002253)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.001566)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10032[0m
  [4;36;1mPermission Update (0.000599)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'blurfl', created_at = '2008-05-12 22:30:01' WHERE id = 10032[0m
  [4;35;1mSQL (0.002501)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002248)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.001536)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10032[0m
  [4;36;1mPermission Update (0.000594)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10032[0m
  [4;35;1mSQL (0.002463)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002233)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.001523)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10032[0m
  [4;36;1mPermission Update (0.000593)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'any', created_at = '2008-05-12 22:30:01' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.017995)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001001)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.001546)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.007356)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.002742)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.000633)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.002390)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.007401)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.002117)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.000849)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.001525)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.000567)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.002476)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.003820)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002933)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.005295)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.001479)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mSQL (0.001824)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004460)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002251)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001741)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000763)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.002472)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.003793)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002903)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001040)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.001406)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mPermission Update (0.000653)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.001884)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.000847)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.001527)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.000546)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.002472)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.000557)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.002366)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.000541)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.001828)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.000816)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.001513)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.000537)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.002359)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.003774)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002911)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001006)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.001405)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mSQL (0.001789)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004440)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002220)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001674)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000721)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.002448)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.003763)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002888)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001005)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.001382)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.007103)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10032
[0m
  [4;35;1mPermission Load (0.003121)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001902)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002135)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001408)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:01', NULL, NULL, 10021, 10033, 3, 0, '2008-05-12 22:30:01', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002228)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.001531)[0m   [0;1mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10033[0m
  [4;35;1mSQL (0.001797)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002886)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000854)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10033[0m
  [4;36;1mPermission Update (0.001254)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:30:01' WHERE id = 10033[0m
  [4;35;1mSQL (0.001781)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002887)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000847)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10033[0m
  [4;36;1mPermission Update (0.001249)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10033[0m
  [4;35;1mSQL (0.001779)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002883)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000839)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10033[0m
  [4;36;1mPermission Update (0.001256)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'any', created_at = '2008-05-12 22:30:01' WHERE id = 10033[0m
  [4;35;1mRoleAssignment Load (0.001219)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001511)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000847)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001216)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001828)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001227)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001726)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001221)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.001160)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001481)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000841)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001199)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001696)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004514)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002234)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001674)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000734)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mSQL (0.002465)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003831)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002893)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001017)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001394)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001787)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004493)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002227)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001689)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000760)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mPermission Update (0.001685)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10033[0m
  [4;35;1mRoleAssignment Load (0.001249)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001507)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000853)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001227)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001831)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001244)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001722)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001222)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.001156)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001484)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000889)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001208)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001705)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004518)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002240)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001675)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000756)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mSQL (0.002482)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003846)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002888)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001006)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001411)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001798)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004507)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002229)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001677)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000735)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001210)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10033
[0m
  [4;35;1mPermission Load (0.002295)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002579)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001461)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000752)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:01', NULL, NULL, 10021, 10034, NULL, 0, '2008-05-12 22:30:01', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002903)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000877)[0m   [0;1mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10034[0m
  [4;35;1mSQL (0.002466)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002220)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.001535)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10034[0m
  [4;36;1mPermission Update (0.000608)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:30:01' WHERE id = 10034[0m
  [4;35;1mSQL (0.002451)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002218)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000901)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10034[0m
  [4;36;1mPermission Update (0.001410)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10034[0m
  [4;35;1mSQL (0.001806)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002895)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000862)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10034[0m
  [4;36;1mPermission Update (0.001270)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'any', created_at = '2008-05-12 22:30:01' WHERE id = 10034[0m
  [4;35;1mRoleAssignment Load (0.001241)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001534)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000864)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001230)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001817)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001249)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001726)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001237)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.001176)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001496)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000848)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001214)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001712)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004462)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002270)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001699)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000769)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mSQL (0.002464)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003772)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002907)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001034)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001430)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001804)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004445)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002241)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001690)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000766)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mPermission Update (0.001304)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10034[0m
  [4;35;1mRoleAssignment Load (0.001207)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001513)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000853)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001223)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001806)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001239)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001712)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001222)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.001167)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001492)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000849)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001211)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001700)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004442)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002240)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001681)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000738)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mSQL (0.002456)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003765)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002894)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001012)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001404)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001798)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004435)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002215)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001673)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000726)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001176)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10034
[0m
  [4;35;1mPermission Load (0.002293)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002566)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001458)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000768)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:01', 1, 'mertz family blog', 10021, 10035, NULL, 0, '2008-05-12 22:30:01', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002900)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.001554)[0m   [0;1mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10035[0m
  [4;35;1mSQL (0.001801)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002894)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000870)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10035[0m
  [4;36;1mPermission Update (0.001263)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:30:01' WHERE id = 10035[0m
  [4;35;1mSQL (0.001785)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002892)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000865)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10035[0m
  [4;36;1mPermission Update (0.001266)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10035[0m
  [4;35;1mSQL (0.001786)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002903)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000858)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10035[0m
  [4;36;1mPermission Update (0.001273)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:01', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'any', created_at = '2008-05-12 22:30:01' WHERE id = 10035[0m
  [4;35;1mRoleAssignment Load (0.001223)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001505)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000848)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001225)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001769)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001248)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001677)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001227)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.001169)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001488)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000841)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001204)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001685)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004368)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002236)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001679)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000749)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:01', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mSQL (0.002443)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003699)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002899)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001022)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001415)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001775)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004359)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002231)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001693)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000732)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mPermission Update (0.001303)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:30:02', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:30:01' WHERE id = 10035[0m
  [4;35;1mRoleAssignment Load (0.001196)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001507)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000848)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001220)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001761)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001233)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001671)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mRoleAssignment Update (0.001215)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mRoleAssignment Load (0.001152)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001484)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000843)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;36;1mRoleAssignment Update (0.001204)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001676)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004366)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002239)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001680)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000742)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;36;1mSQL (0.002439)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003689)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002878)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001012)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001420)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
  [4;35;1mSQL (0.001779)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004362)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002233)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001676)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000736)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:02', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:00' WHERE id = 10032[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001150)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10035
[0m
  [4;35;1mPermission Load (0.002265)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002297)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001417)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10036, NULL, 0, '2008-05-12 22:30:02', 'post', 3)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001429)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000671)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10037, 3, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002871)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004091)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001638)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000640)[0m   [0m DELETE FROM permissions
 WHERE id = 10036
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001103)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10037
[0m
  [4;35;1mPermission Load (0.002209)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002297)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001441)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10038, NULL, 0, '2008-05-12 22:30:02', 'post', 3)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001429)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000684)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:02', NULL, NULL, 10021, 10039, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002879)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004095)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001635)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000634)[0m   [0m DELETE FROM permissions
 WHERE id = 10038
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001095)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10039
[0m
  [4;35;1mPermission Load (0.002208)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001753)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001418)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10040, NULL, 0, '2008-05-12 22:30:02', 'post', 3)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001512)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000694)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', 1, 'mertz family blog', 10021, 10041, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002906)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004065)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001648)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000658)[0m   [0m DELETE FROM permissions
 WHERE id = 10040
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001110)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10041
[0m
  [4;35;1mPermission Load (0.002218)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002332)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001405)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10042, 3, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001427)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000687)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10043, NULL, 0, '2008-05-12 22:30:02', 'post', 3)[0m
  [4;36;1mPermission Load (0.002885)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004114)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001645)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000647)[0m   [0m DELETE FROM permissions
 WHERE id = 10042
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001105)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10043
[0m
  [4;35;1mPermission Load (0.002230)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002330)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001399)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10044, 3, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001421)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000677)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:02', NULL, NULL, 10021, 10045, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002883)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004104)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001636)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000642)[0m   [0m DELETE FROM permissions
 WHERE id = 10044
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001100)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10045
[0m
  [4;35;1mPermission Load (0.002216)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002300)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001392)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10046, 3, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001413)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000677)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', 1, 'mertz family blog', 10021, 10047, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002882)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004121)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001638)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000633)[0m   [0m DELETE FROM permissions
 WHERE id = 10046
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001101)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10047
[0m
  [4;35;1mPermission Load (0.002206)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002301)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001393)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:02', NULL, NULL, 10021, 10048, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001420)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000680)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10049, NULL, 0, '2008-05-12 22:30:02', 'post', 3)[0m
  [4;36;1mPermission Load (0.002881)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004096)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001633)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000616)[0m   [0m DELETE FROM permissions
 WHERE id = 10048
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001092)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10049
[0m
  [4;35;1mPermission Load (0.002193)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002297)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001395)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:02', NULL, NULL, 10021, 10050, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001408)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000681)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10051, 3, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002886)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004092)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001629)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000637)[0m   [0m DELETE FROM permissions
 WHERE id = 10050
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001131)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10051
[0m
  [4;35;1mPermission Load (0.002221)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002305)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001396)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:02', NULL, NULL, 10021, 10052, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001421)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000678)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', 1, 'mertz family blog', 10021, 10053, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002864)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004032)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001635)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000630)[0m   [0m DELETE FROM permissions
 WHERE id = 10052
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001094)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10053
[0m
  [4;35;1mPermission Load (0.002200)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002293)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001401)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', 1, 'mertz family blog', 10021, 10054, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001406)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000667)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10055, NULL, 0, '2008-05-12 22:30:02', 'post', 3)[0m
  [4;36;1mPermission Load (0.002872)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004034)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001632)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000639)[0m   [0m DELETE FROM permissions
 WHERE id = 10054
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001102)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10055
[0m
  [4;35;1mPermission Load (0.002210)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002312)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001401)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', 1, 'mertz family blog', 10021, 10056, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001399)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000669)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', NULL, NULL, 10021, 10057, 3, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002871)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004114)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001637)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000639)[0m   [0m DELETE FROM permissions
 WHERE id = 10056
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001101)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10057
[0m
  [4;35;1mPermission Load (0.002213)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002298)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001406)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:02', 1, 'mertz family blog', 10021, 10058, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001405)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000673)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:30:02', NULL, NULL, 10021, 10059, NULL, 0, '2008-05-12 22:30:02', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002876)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004039)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.001637)[0m   [0;1mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000625)[0m   [0m DELETE FROM permissions
 WHERE id = 10058
[0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.001094)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10059
[0m
  [4;35;1mPermission Load (0.002203)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10021)
  [4;36;1mRole Destroy (0.001357)[0m   [0;1m DELETE FROM roles
 WHERE id = 10021
[0m
  [4;35;1mRoleAssignment Load (0.001761)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000824)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001123)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10032
[0m
  [4;36;1mUser Load (0.000799)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001104)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10033
[0m
  [4;36;1mRoleAssignment Load (0.000969)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001281)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.003078)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000837)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001447)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000695)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001402)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001157)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002858)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001409)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:02', 10022, 2, 5, '2008-05-12 22:30:02')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001538)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10022)
  [4;35;1mSQL (0.002109)[0m   [0mselect 'x' from roles where id = 10022 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001291)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:02', 10022, 10034, 5, NULL, '2008-05-12 22:30:02', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001059)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002620)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.017892)[0m   [0mSELECT count(*) AS count_all FROM users WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'frammis' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 5)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mSQL (0.002293)[0m   [0;1mselect 'x' from roles where id = 10022 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000949)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10022) [0m
  [4;36;1mPermission Create (0.000719)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('User', 0, 1, '2008-05-12 22:30:02', NULL, NULL, 10022, 10060, NULL, 0, '2008-05-12 22:30:02', 'any', NULL)[0m
  [4;35;1mPermission Load (0.002882)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001602)[0m   [0;1mSELECT count(*) AS count_all FROM users WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'frammis' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 5)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mUser Load (0.013664)[0m   [0mSELECT * FROM users WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'frammis' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 5)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: destroy Role test role(10022)
  [4;36;1mRole Destroy (0.000692)[0m   [0;1m DELETE FROM roles
 WHERE id = 10022
[0m
  [4;35;1mRoleAssignment Load (0.001752)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000829)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001124)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10034
[0m
  [4;36;1mRoleAssignment Load (0.000982)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001282)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002100)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001687)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mUser Load (0.000787)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mRole Load (0.001536)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;36;1mUser Load (0.000794)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001433)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000654)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001396)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001105)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002845)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001394)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:02', 10023, 2, 5, '2008-05-12 22:30:02')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001539)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10023)
  [4;36;1mSQL (0.002100)[0m   [0;1mselect 'x' from roles where id = 10023 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001293)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:02', 10023, 10035, 5, NULL, '2008-05-12 22:30:02', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001053)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002622)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000882)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10023)
  [4;35;1mSQL (0.002185)[0m   [0mselect 'x' from roles where id = 10023 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001401)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:30:02', 3, 'twiddler', 10023, 10061, NULL, 0, '2008-05-12 22:30:02', 'edit', NULL)[0m
  [4;35;1mPermission Load (0.002146)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.002573)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10023)
  [4;35;1mRole Destroy (0.000649)[0m   [0m DELETE FROM roles
 WHERE id = 10023
[0m
  [4;36;1mRoleAssignment Load (0.001742)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000815)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001118)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10035
[0m
  [4;35;1mRoleAssignment Load (0.000991)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001277)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002116)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001425)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001087)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000598)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10024, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002165)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10024)
  [4;36;1mSQL (0.001385)[0m   [0;1mselect 'x' from roles where id = 10024 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000598)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10024, 10036, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001703)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002063)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001556)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mRole Load (0.000904)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
=== permission check: edit Role test role(10024)
  [4;36;1mSQL (0.002212)[0m   [0;1mselect 'x' from roles where id = 10024 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001390)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 1, 0, '2008-05-12 22:30:03', NULL, NULL, 10024, 10062, NULL, 0, '2008-05-12 22:30:03', 'post', 3)[0m
  [4;36;1mPermission Load (0.002268)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Create (0.000748)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:03', NULL, NULL, 3, 10063, NULL, 0, '2008-05-12 22:30:03', 'post', 3)[0m
=== permission check: destroy Role test role(10024)
  [4;36;1mRole Destroy (0.001171)[0m   [0;1m DELETE FROM roles
 WHERE id = 10024
[0m
  [4;35;1mRoleAssignment Load (0.001054)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001483)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000438)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10036
[0m
  [4;36;1mRoleAssignment Load (0.001644)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000609)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002921)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000797)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001751)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001265)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10025, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001497)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10025)
  [4;35;1mSQL (0.002053)[0m   [0mselect 'x' from roles where id = 10025 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001264)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10025, 10037, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001027)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002844)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000912)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10025)
  [4;36;1mSQL (0.002193)[0m   [0;1mselect 'x' from roles where id = 10025 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001374)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:30:03', 3, 'twiddler', 10025, 10064, NULL, 0, '2008-05-12 22:30:03', 'edit', NULL)[0m
  [4;36;1mPermission Load (0.002240)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role twiddler(3)
  [4;35;1mPermission Destroy (0.001389)[0m   [0m DELETE FROM permissions
 WHERE id = 10063
[0m
=== permission check: destroy Role test role(10025)
  [4;36;1mRole Destroy (0.000448)[0m   [0;1m DELETE FROM roles
 WHERE id = 10025
[0m
  [4;35;1mRoleAssignment Load (0.001732)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000817)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001116)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10037
[0m
  [4;36;1mRoleAssignment Load (0.000976)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001280)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002254)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRole Load (0.001727)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;36;1mPermission Load (0.010856)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 3
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000822)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001505)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;35;1mPermission Load (0.008775)[0m   [0mSELECT * FROM permissions WHERE (permissions.role_id = 1) [0m
  [4;36;1mRole Load (0.001643)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;35;1mPermission Load (0.008636)[0m   [0mSELECT * FROM permissions WHERE (permissions.role_id = 2) [0m
  [4;36;1mPermission Load (0.002767)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000827)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mUser Load (0.001465)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001449)[0m   [0mselect 'x' from roles where id = 1 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001977)[0m   [0;1mselect 'x' from roles where id = 1 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001301)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001936)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mUser Load (0.000832)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001511)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;35;1mRoleAssignment Create (0.001347)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 1, 10038, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;36;1mPermission Load (0.002056)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001549)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mSQL (0.001551)[0m   [0;1mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002147)[0m   [0mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001346)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001926)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mUser Load (0.000834)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.001510)[0m   [0mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;36;1mRoleAssignment Create (0.001274)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 2, 10039, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;35;1mPermission Load (0.002079)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001549)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mRoleAssignment Load (0.009234)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 1)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001627)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.000848)[0m   [0mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;36;1mRoleAssignment Update (0.001303)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:03', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = '2008-05-13 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:03' WHERE id = 10038[0m
  [4;35;1mPermission Load (0.002160)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001546)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mRoleAssignment Update (0.000621)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:03', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = '2008-05-14 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:03' WHERE id = 10038[0m
  [4;36;1mPermission Load (0.002768)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000860)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mRoleAssignment Update (0.001303)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:03', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:03' WHERE id = 10038[0m
  [4;35;1mPermission Load (0.002109)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001535)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mRoleAssignment Update (0.000605)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:03', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:03' WHERE id = 10038[0m
  [4;36;1mRoleAssignment Load (0.001899)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 1)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000830)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001510)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;35;1mRoleAssignment Update (0.000544)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:03', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = '2008-05-12 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:03' WHERE id = 10038[0m
  [4;36;1mSQL (0.001399)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mSQL (0.000598)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002743)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRoleAssignment Update (0.000724)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:03', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = '2008-05-11 22:29:57', default_user_id = NULL, created_at = '2008-05-12 22:30:03' WHERE id = 10038[0m
  [4;36;1mSQL (0.001451)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mSQL (0.000601)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002694)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRoleAssignment Update (0.000713)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:03', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:03' WHERE id = 10038[0m
  [4;36;1mBlog Load (0.001607)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mPhonyPatBlog Columns (0.001255)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mPhonyPatBlog Load (0.001550)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mBlog Load (0.000834)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;36;1mPhonyPatBlog Load (0.001489)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;35;1mBlog Load (0.000817)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;36;1mPhonyPatBlog Load (0.001493)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;35;1mBlog Load (0.000819)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;36;1mPhonyPatBlog Load (0.001487)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;35;1mFirm Load (0.000715)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mUser Load (0.001528)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000768)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001323)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001074)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002825)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001379)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10026, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001508)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10026)
  [4;35;1mSQL (0.002067)[0m   [0mselect 'x' from roles where id = 10026 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001323)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10026, 10040, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001060)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002677)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10026)
  [4;35;1mSQL (0.001585)[0m   [0mselect 'x' from roles where id = 10026 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000743)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:03', 2, 'Dubuque', 10026, 10065, NULL, 0, '2008-05-12 22:30:03', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10026)
  [4;35;1mSQL (0.002103)[0m   [0mselect 'x' from roles where id = 10026 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001338)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:30:03', 3, 'ricky''s dubuque blog', 10026, 10066, NULL, 0, '2008-05-12 22:30:03', 'add_post', NULL)[0m
=== permission check: edit Role test role(10026)
  [4;35;1mSQL (0.001382)[0m   [0mselect 'x' from roles where id = 10026 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000677)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:03', NULL, NULL, 10026, 10067, NULL, 0, '2008-05-12 22:30:03', 'create', NULL)[0m
  [4;35;1mPermission Load (0.002844)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000949)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;35;1mPhonyPatEntry Columns (0.001907)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOG_ENTRIES'
 order by column_id
[0m
=== permission check: blog_within_firm Firm Dubuque(2)
  [4;36;1mSQL (0.020600)[0m   [0;1mselect 'x' from firms where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
[0m
=== permission check: add_post PhonyPatBlog ricky's dubuque blog(3)
  [4;35;1mSQL (0.012708)[0m   [0mselect 'x' from blogs where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: create PhonyPatEntry X()
  [4;36;1mPhonyPatEntry Create (0.007781)[0m   [0;1mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:30:03', 10000, 2, 3, empty_clob(), 4, '2008-05-12 22:30:03')[0m
  [4;35;1mWritable Large Object (0.007417)[0m   [0mSELECT entry_txt FROM blog_entries WHERE id = 10000[0m
=== permission check: destroy Role test role(10026)
  [4;36;1mRole Destroy (0.000646)[0m   [0;1m DELETE FROM roles
 WHERE id = 10026
[0m
  [4;35;1mRoleAssignment Load (0.001816)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000815)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001117)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10040
[0m
  [4;36;1mRoleAssignment Load (0.000977)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001284)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002122)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001460)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001105)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000657)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10027, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002182)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10027)
  [4;35;1mSQL (0.001400)[0m   [0mselect 'x' from roles where id = 10027 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000619)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10027, 10041, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001707)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002081)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10027)
  [4;35;1mSQL (0.002317)[0m   [0mselect 'x' from roles where id = 10027 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001390)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:30:03', NULL, NULL, 10027, 10068, 2, 0, '2008-05-12 22:30:03', 'add_post', NULL)[0m
  [4;35;1mPermission Load (0.002150)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyPatBlog Load (0.013221)[0m   [0;1mSELECT * FROM blogs WHERE (id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: destroy Role test role(10027)
  [4;35;1mRole Destroy (0.000658)[0m   [0m DELETE FROM roles
 WHERE id = 10027
[0m
  [4;36;1mRoleAssignment Load (0.001722)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000808)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001104)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10041
[0m
  [4;35;1mRoleAssignment Load (0.000969)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001274)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002084)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001429)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001084)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000603)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10028, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002157)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10028)
  [4;36;1mSQL (0.001393)[0m   [0;1mselect 'x' from roles where id = 10028 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000591)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10028, 10042, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001695)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002058)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10028)
  [4;36;1mSQL (0.002293)[0m   [0;1mselect 'x' from roles where id = 10028 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001377)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:30:03', NULL, NULL, 10028, 10069, 2, 0, '2008-05-12 22:30:03', 'add_post', NULL)[0m
=== permission check: edit Role test role(10028)
  [4;36;1mSQL (0.001397)[0m   [0;1mselect 'x' from roles where id = 10028 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000692)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:30:03', 3, 'ricky''s dubuque blog', 10028, 10070, NULL, 0, '2008-05-12 22:30:03', 'kill_post', NULL)[0m
  [4;36;1mPermission Load (0.002929)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyPatBlog Load (0.001189)[0m   [0mSELECT * FROM blogs WHERE (blogs.owner_firm_id = 2) [0m
  [4;36;1mPhonyPatBlog Load (0.014502)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: destroy Role test role(10028)
  [4;35;1mRole Destroy (0.000691)[0m   [0m DELETE FROM roles
 WHERE id = 10028
[0m
  [4;36;1mRoleAssignment Load (0.001737)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000813)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001106)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10042
[0m
  [4;35;1mRoleAssignment Load (0.000969)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001273)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002246)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001693)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mPhonyPatBlog Load (0.000844)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mBlog Load (0.001492)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;35;1mPhonyPatBlog Load (0.000818)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;36;1mBlog Load (0.001487)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;35;1mPhonyPatBlog Load (0.000815)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;36;1mBlog Load (0.001484)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;35;1mPhonyPatBlog Load (0.000813)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;36;1mFirm Load (0.001385)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mUser Load (0.000822)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001430)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000654)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001750)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002180)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000713)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10029, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002191)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10029)
  [4;36;1mSQL (0.001415)[0m   [0;1mselect 'x' from roles where id = 10029 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000630)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10029, 10043, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001711)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001952)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10029)
  [4;36;1mSQL (0.002257)[0m   [0;1mselect 'x' from roles where id = 10029 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001404)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:03', 2, 'Dubuque', 10029, 10071, NULL, 0, '2008-05-12 22:30:03', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10029)
  [4;36;1mSQL (0.001432)[0m   [0;1mselect 'x' from roles where id = 10029 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000662)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:30:03', 3, 'ricky''s dubuque blog', 10029, 10072, NULL, 0, '2008-05-12 22:30:03', 'add_post', NULL)[0m
=== permission check: edit Role test role(10029)
  [4;36;1mSQL (0.002049)[0m   [0;1mselect 'x' from roles where id = 10029 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001341)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:03', NULL, NULL, 10029, 10073, NULL, 0, '2008-05-12 22:30:03', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002034)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001584)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
=== permission check: blog_within_firm Firm Dubuque(2)
  [4;36;1mSQL (0.001454)[0m   [0;1mselect 'x' from firms where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
[0m
=== permission check: add_post PhonyPatBlog ricky's dubuque blog(3)
  [4;35;1mSQL (0.002114)[0m   [0mselect 'x' from blogs where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: create PhonyPatEntry X()
  [4;36;1mPhonyPatEntry Create (0.001362)[0m   [0;1mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:30:03', 10001, 2, 3, empty_clob(), 4, '2008-05-12 22:30:03')[0m
  [4;35;1mWritable Large Object (0.000565)[0m   [0mSELECT entry_txt FROM blog_entries WHERE id = 10001[0m
=== permission check: destroy Role test role(10029)
  [4;36;1mRole Destroy (0.000469)[0m   [0;1m DELETE FROM roles
 WHERE id = 10029
[0m
  [4;35;1mRoleAssignment Load (0.001722)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000808)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001104)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10043
[0m
  [4;36;1mRoleAssignment Load (0.000971)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001276)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001983)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001520)[0m   [0mSELECT * FROM firms WHERE (firms.id = 1) [0m
  [4;36;1mSQL (0.000680)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001738)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001259)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10030, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001451)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10030)
  [4;36;1mSQL (0.002048)[0m   [0;1mselect 'x' from roles where id = 10030 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001259)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10030, 10044, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001021)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002596)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10030)
  [4;36;1mSQL (0.001561)[0m   [0;1mselect 'x' from roles where id = 10030 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000707)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:03', 2, 'Dubuque', 10030, 10074, NULL, 0, '2008-05-12 22:30:03', 'blog_within_firm', NULL)[0m
  [4;36;1mPermission Load (0.002790)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.019028)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and 2 + 2 = 5) [0m
=== permission check: destroy Role test role(10030)
  [4;36;1mRole Destroy (0.001319)[0m   [0;1m DELETE FROM roles
 WHERE id = 10030
[0m
  [4;35;1mRoleAssignment Load (0.001079)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001485)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000438)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10044
[0m
  [4;36;1mRoleAssignment Load (0.001644)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000616)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002802)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000756)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001757)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001268)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10031, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001499)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10031)
  [4;35;1mSQL (0.002048)[0m   [0mselect 'x' from roles where id = 10031 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001261)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10031, 10045, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001225)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002741)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10031)
  [4;35;1mSQL (0.001636)[0m   [0mselect 'x' from roles where id = 10031 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000731)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:03', NULL, NULL, 10031, 10075, 2, 0, '2008-05-12 22:30:03', 'create', NULL)[0m
  [4;35;1mPermission Load (0.002823)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.011969)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10031)
  [4;35;1mRole Destroy (0.001324)[0m   [0m DELETE FROM roles
 WHERE id = 10031
[0m
  [4;36;1mRoleAssignment Load (0.001047)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001483)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000438)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10045
[0m
  [4;35;1mRoleAssignment Load (0.001636)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000617)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002802)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000765)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001764)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001277)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10032, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001502)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10032)
  [4;36;1mSQL (0.002063)[0m   [0;1mselect 'x' from roles where id = 10032 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001260)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10032, 10046, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001030)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002735)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10032)
  [4;36;1mSQL (0.001624)[0m   [0;1mselect 'x' from roles where id = 10032 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000728)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:03', 2, 'Dubuque', 10032, 10076, NULL, 0, '2008-05-12 22:30:03', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10032)
  [4;36;1mSQL (0.002226)[0m   [0;1mselect 'x' from roles where id = 10032 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001386)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:03', NULL, NULL, 10032, 10077, 2, 0, '2008-05-12 22:30:03', 'update', NULL)[0m
  [4;36;1mPermission Load (0.002171)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001990)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and 2 + 2 = 5) [0m
=== permission check: destroy Role test role(10032)
  [4;36;1mRole Destroy (0.000540)[0m   [0;1m DELETE FROM roles
 WHERE id = 10032
[0m
  [4;35;1mRoleAssignment Load (0.001700)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000823)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001110)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10046
[0m
  [4;36;1mRoleAssignment Load (0.000982)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001282)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002143)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001439)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001105)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000603)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10033, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002185)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10033)
  [4;35;1mSQL (0.002062)[0m   [0mselect 'x' from roles where id = 10033 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001264)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10033, 10047, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001030)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002743)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10033)
  [4;35;1mSQL (0.001632)[0m   [0mselect 'x' from roles where id = 10033 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000714)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:03', 2, 'Dubuque', 10033, 10078, NULL, 0, '2008-05-12 22:30:03', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10033)
  [4;35;1mSQL (0.002083)[0m   [0mselect 'x' from roles where id = 10033 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001331)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:03', NULL, NULL, 10033, 10079, 2, 0, '2008-05-12 22:30:03', 'create', NULL)[0m
  [4;35;1mPermission Load (0.002281)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.002869)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10033)
  [4;35;1mRole Destroy (0.000674)[0m   [0m DELETE FROM roles
 WHERE id = 10033
[0m
  [4;36;1mRoleAssignment Load (0.001749)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000827)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001114)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10047
[0m
  [4;35;1mRoleAssignment Load (0.000985)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001282)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002275)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001482)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001105)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000911)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:03', 10034, 2, 5, '2008-05-12 22:30:03')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002220)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10034)
  [4;36;1mSQL (0.001401)[0m   [0;1mselect 'x' from roles where id = 10034 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000632)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:03', 10034, 10048, 5, NULL, '2008-05-12 22:30:03', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001714)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002207)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10034)
  [4;36;1mSQL (0.002357)[0m   [0;1mselect 'x' from roles where id = 10034 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001417)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10034, 10080, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10034)
  [4;36;1mSQL (0.001505)[0m   [0;1mselect 'x' from roles where id = 10034 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000689)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10034, 10081, 2, 0, '2008-05-12 22:30:04', 'create', NULL)[0m
=== permission check: edit Role test role(10034)
  [4;36;1mSQL (0.002085)[0m   [0;1mselect 'x' from roles where id = 10034 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001347)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 1, 'Shire', 10034, 10082, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
  [4;36;1mPermission Load (0.002296)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.002930)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10034)
  [4;36;1mRole Destroy (0.000732)[0m   [0;1m DELETE FROM roles
 WHERE id = 10034
[0m
  [4;35;1mRoleAssignment Load (0.001741)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000812)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001113)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10048
[0m
  [4;36;1mRoleAssignment Load (0.000982)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002285)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001461)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001090)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000624)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10035, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002187)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10035)
  [4;35;1mSQL (0.001399)[0m   [0mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000611)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10035, 10049, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001697)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002197)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10035)
  [4;35;1mSQL (0.002354)[0m   [0mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001406)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10035, 10083, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10035)
  [4;35;1mSQL (0.001422)[0m   [0mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000697)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10035, 10084, 2, 0, '2008-05-12 22:30:04', 'create', NULL)[0m
=== permission check: edit Role test role(10035)
  [4;35;1mSQL (0.002071)[0m   [0mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001344)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 1, 'Shire', 10035, 10085, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10035)
  [4;35;1mSQL (0.001393)[0m   [0mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000668)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10035, 10086, 1, 0, '2008-05-12 22:30:04', 'create', NULL)[0m
  [4;35;1mPermission Load (0.002971)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.021755)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (1,2)) [0m
=== permission check: destroy Role test role(10035)
  [4;35;1mRole Destroy (0.001424)[0m   [0m DELETE FROM roles
 WHERE id = 10035
[0m
  [4;36;1mRoleAssignment Load (0.001074)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001486)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000447)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10049
[0m
  [4;35;1mRoleAssignment Load (0.001640)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000609)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002969)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001557)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mPhonyPatBlog Load (0.000836)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mBlog Load (0.001491)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;35;1mPhonyPatBlog Load (0.000818)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;36;1mBlog Load (0.001487)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;35;1mPhonyPatBlog Load (0.000818)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;36;1mBlog Load (0.001483)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;35;1mPhonyPatBlog Load (0.000821)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;36;1mFirm Load (0.001387)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mUser Load (0.000817)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001429)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000650)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001743)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002158)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000734)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10036, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002197)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10036)
  [4;36;1mSQL (0.001414)[0m   [0;1mselect 'x' from roles where id = 10036 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000635)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10036, 10050, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001704)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001947)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10036)
  [4;36;1mSQL (0.002248)[0m   [0;1mselect 'x' from roles where id = 10036 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001407)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10036, 10087, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10036)
  [4;36;1mSQL (0.001424)[0m   [0;1mselect 'x' from roles where id = 10036 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000667)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:30:04', 3, 'ricky''s dubuque blog', 10036, 10088, NULL, 0, '2008-05-12 22:30:04', 'add_post', NULL)[0m
=== permission check: edit Role test role(10036)
  [4;36;1mSQL (0.002054)[0m   [0;1mselect 'x' from roles where id = 10036 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001335)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10036, 10089, NULL, 0, '2008-05-12 22:30:04', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002047)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001583)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
=== permission check: blog_within_firm Firm Dubuque(2)
  [4;36;1mSQL (0.001386)[0m   [0;1mselect 'x' from firms where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
[0m
=== permission check: add_post PhonyPatBlog ricky's dubuque blog(3)
  [4;35;1mSQL (0.002077)[0m   [0mselect 'x' from blogs where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: create PhonyPatEntry X()
  [4;36;1mPhonyPatEntry Create (0.001353)[0m   [0;1mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:30:04', 10002, 2, 3, empty_clob(), 4, '2008-05-12 22:30:04')[0m
  [4;35;1mWritable Large Object (0.000588)[0m   [0mSELECT entry_txt FROM blog_entries WHERE id = 10002[0m
=== permission check: destroy Role test role(10036)
  [4;36;1mRole Destroy (0.000472)[0m   [0;1m DELETE FROM roles
 WHERE id = 10036
[0m
  [4;35;1mRoleAssignment Load (0.001734)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000805)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001116)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10050
[0m
  [4;36;1mRoleAssignment Load (0.000974)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001992)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001536)[0m   [0mSELECT * FROM firms WHERE (firms.id = 1) [0m
  [4;36;1mSQL (0.000680)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001752)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001272)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10037, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001483)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10037)
  [4;36;1mSQL (0.002080)[0m   [0;1mselect 'x' from roles where id = 10037 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001273)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10037, 10051, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001028)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002607)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10037)
  [4;36;1mSQL (0.001577)[0m   [0;1mselect 'x' from roles where id = 10037 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000724)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10037, 10090, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
  [4;36;1mPermission Load (0.002811)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001249)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and 2 + 2 = 5) [0m
=== permission check: destroy Role test role(10037)
  [4;36;1mRole Destroy (0.001207)[0m   [0;1m DELETE FROM roles
 WHERE id = 10037
[0m
  [4;35;1mRoleAssignment Load (0.001013)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001474)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000442)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10051
[0m
  [4;36;1mRoleAssignment Load (0.001638)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000613)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002792)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000758)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001742)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001260)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10038, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001492)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10038)
  [4;35;1mSQL (0.002038)[0m   [0mselect 'x' from roles where id = 10038 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001262)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10038, 10052, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001027)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002732)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10038)
  [4;35;1mSQL (0.001615)[0m   [0mselect 'x' from roles where id = 10038 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000729)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10038, 10091, 2, 0, '2008-05-12 22:30:04', 'update', NULL)[0m
  [4;35;1mPermission Load (0.002811)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001812)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10038)
  [4;35;1mRole Destroy (0.001252)[0m   [0m DELETE FROM roles
 WHERE id = 10038
[0m
  [4;36;1mRoleAssignment Load (0.001042)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001480)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000441)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10052
[0m
  [4;35;1mRoleAssignment Load (0.001637)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000609)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002751)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000761)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001744)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001261)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10039, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001484)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10039)
  [4;36;1mSQL (0.002045)[0m   [0;1mselect 'x' from roles where id = 10039 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001259)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10039, 10053, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001025)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002727)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10039)
  [4;36;1mSQL (0.001624)[0m   [0;1mselect 'x' from roles where id = 10039 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000713)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10039, 10092, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10039)
  [4;36;1mSQL (0.002063)[0m   [0;1mselect 'x' from roles where id = 10039 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001324)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10039, 10093, 2, 0, '2008-05-12 22:30:04', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002268)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001929)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and 2 + 2 = 5) [0m
=== permission check: destroy Role test role(10039)
  [4;36;1mRole Destroy (0.000542)[0m   [0;1m DELETE FROM roles
 WHERE id = 10039
[0m
  [4;35;1mRoleAssignment Load (0.001687)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000811)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001106)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10053
[0m
  [4;36;1mRoleAssignment Load (0.000965)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001276)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002261)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001458)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001076)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000614)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10040, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002192)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10040)
  [4;35;1mSQL (0.001390)[0m   [0mselect 'x' from roles where id = 10040 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000598)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10040, 10054, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001690)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002193)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10040)
  [4;35;1mSQL (0.002350)[0m   [0mselect 'x' from roles where id = 10040 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001384)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10040, 10094, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10040)
  [4;35;1mSQL (0.001396)[0m   [0mselect 'x' from roles where id = 10040 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000655)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10040, 10095, 2, 0, '2008-05-12 22:30:04', 'update', NULL)[0m
  [4;35;1mPermission Load (0.002935)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001982)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10040)
  [4;35;1mRole Destroy (0.001334)[0m   [0m DELETE FROM roles
 WHERE id = 10040
[0m
  [4;36;1mRoleAssignment Load (0.001053)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001475)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000437)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10054
[0m
  [4;35;1mRoleAssignment Load (0.001635)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000606)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002907)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000791)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001751)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001578)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10041, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001530)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10041)
  [4;36;1mSQL (0.002054)[0m   [0;1mselect 'x' from roles where id = 10041 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001288)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10041, 10055, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001030)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002857)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10041)
  [4;36;1mSQL (0.001704)[0m   [0;1mselect 'x' from roles where id = 10041 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000752)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10041, 10096, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10041)
  [4;36;1mSQL (0.002115)[0m   [0;1mselect 'x' from roles where id = 10041 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001341)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10041, 10097, 2, 0, '2008-05-12 22:30:04', 'update', NULL)[0m
=== permission check: edit Role test role(10041)
  [4;36;1mSQL (0.001393)[0m   [0;1mselect 'x' from roles where id = 10041 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000672)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 1, 'Shire', 10041, 10098, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
  [4;36;1mPermission Load (0.002952)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001985)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10041)
  [4;36;1mRole Destroy (0.001324)[0m   [0;1m DELETE FROM roles
 WHERE id = 10041
[0m
  [4;35;1mRoleAssignment Load (0.001065)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001482)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001113)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10055
[0m
  [4;36;1mRoleAssignment Load (0.000973)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001279)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002242)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001471)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001082)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000620)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10042, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002175)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10042)
  [4;35;1mSQL (0.001393)[0m   [0mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000604)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10042, 10056, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001703)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002192)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10042)
  [4;35;1mSQL (0.002345)[0m   [0mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001402)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10042, 10099, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10042)
  [4;35;1mSQL (0.001410)[0m   [0mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000726)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10042, 10100, 2, 0, '2008-05-12 22:30:04', 'update', NULL)[0m
=== permission check: edit Role test role(10042)
  [4;35;1mSQL (0.002155)[0m   [0mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001359)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 1, 'Shire', 10042, 10101, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10042)
  [4;35;1mSQL (0.001396)[0m   [0mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000674)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10042, 10102, 1, 0, '2008-05-12 22:30:04', 'update', NULL)[0m
  [4;35;1mPermission Load (0.002967)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.002440)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (1,2)) [0m
=== permission check: destroy Role test role(10042)
  [4;35;1mRole Destroy (0.001353)[0m   [0m DELETE FROM roles
 WHERE id = 10042
[0m
  [4;36;1mRoleAssignment Load (0.001071)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001481)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000452)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10056
[0m
  [4;35;1mRoleAssignment Load (0.001645)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000608)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002927)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001022)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mPhonyPatBlog Load (0.001510)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mBlog Load (0.000820)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;35;1mPhonyPatBlog Load (0.001486)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;36;1mBlog Load (0.000819)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;35;1mPhonyPatBlog Load (0.001488)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;36;1mBlog Load (0.000816)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;35;1mPhonyPatBlog Load (0.001484)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;36;1mFirm Load (0.000715)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mUser Load (0.001492)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000766)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001317)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001069)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002823)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001382)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10043, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001516)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10043)
  [4;36;1mSQL (0.002070)[0m   [0;1mselect 'x' from roles where id = 10043 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001283)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10043, 10057, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001040)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002617)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10043)
  [4;36;1mSQL (0.001555)[0m   [0;1mselect 'x' from roles where id = 10043 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000717)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:30:04', 2, 'Dubuque', 10043, 10103, NULL, 0, '2008-05-12 22:30:04', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10043)
  [4;36;1mSQL (0.002068)[0m   [0;1mselect 'x' from roles where id = 10043 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001330)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:30:04', 3, 'ricky''s dubuque blog', 10043, 10104, NULL, 0, '2008-05-12 22:30:04', 'add_post', NULL)[0m
=== permission check: edit Role test role(10043)
  [4;36;1mSQL (0.001389)[0m   [0;1mselect 'x' from roles where id = 10043 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000676)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:30:04', NULL, NULL, 10043, 10105, NULL, 0, '2008-05-12 22:30:04', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002707)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000906)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
=== permission check: blog_within_firm Firm Dubuque(2)
  [4;36;1mSQL (0.002059)[0m   [0;1mselect 'x' from firms where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
[0m
=== permission check: add_post PhonyPatBlog ricky's dubuque blog(3)
  [4;35;1mSQL (0.001396)[0m   [0mselect 'x' from blogs where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: create PhonyPatEntry X()
  [4;36;1mPhonyPatEntry Create (0.000681)[0m   [0;1mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:30:04', 10003, 2, 3, empty_clob(), 4, '2008-05-12 22:30:04')[0m
  [4;35;1mWritable Large Object (0.001228)[0m   [0mSELECT entry_txt FROM blog_entries WHERE id = 10003[0m
=== permission check: destroy Role test role(10043)
  [4;36;1mRole Destroy (0.001137)[0m   [0;1m DELETE FROM roles
 WHERE id = 10043
[0m
  [4;35;1mRoleAssignment Load (0.001060)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001481)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000451)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10057
[0m
  [4;36;1mRoleAssignment Load (0.001645)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000616)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002669)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.011506)[0m   [0mSELECT * FROM firms [0m
  [4;36;1mFirm Load (0.001481)[0m   [0;1mSELECT * FROM firms [0m
  [4;35;1mBlog Load (0.000944)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mUser Load (0.001491)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000765)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001319)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000728)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001757)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002312)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001404)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10044, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001666)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10044)
  [4;36;1mSQL (0.002089)[0m   [0;1mselect 'x' from roles where id = 10044 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001301)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10044, 10058, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001047)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002626)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000889)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mUser Load (0.001486)[0m   [0mSELECT * FROM users WHERE (users.id = 2) [0m
  [4;36;1mFirm Load (0.000726)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mBlogEntry Columns (0.001939)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOG_ENTRIES'
 order by column_id
[0m
=== FAILED permission check: change_post Blog mertz family blog(1)
=== permission check: edit Role test role(10044)
  [4;36;1mSQL (0.001628)[0m   [0;1mselect 'x' from roles where id = 10044 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000746)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:04', 1, 'mertz family blog', 10044, 10106, NULL, 0, '2008-05-12 22:30:04', 'change_post', NULL)[0m
  [4;36;1mPermission Load (0.002832)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_post Blog mertz family blog(1)
=== permission check: change_post Blog mertz family blog(1)
  [4;35;1mBlogEntry Create (0.001399)[0m   [0mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:30:04', 10004, 4, 1, empty_clob(), 2, '2008-05-12 22:30:04')[0m
  [4;36;1mWritable Large Object (0.000577)[0m   [0;1mSELECT entry_txt FROM blog_entries WHERE id = 10004[0m
=== permission check: change_post Blog mertz family blog(1)
=== permission check: change_post Blog mertz family blog(1)
  [4;35;1mBlogEntry Create (0.001208)[0m   [0mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:30:04', 10005, 4, 1, empty_clob(), 2, '2008-05-12 22:30:04')[0m
  [4;36;1mWritable Large Object (0.000559)[0m   [0;1mSELECT entry_txt FROM blog_entries WHERE id = 10005[0m
=== permission check: destroy Role test role(10044)
  [4;35;1mRole Destroy (0.000479)[0m   [0m DELETE FROM roles
 WHERE id = 10044
[0m
  [4;36;1mRoleAssignment Load (0.001745)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000824)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001118)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10058
[0m
  [4;35;1mRoleAssignment Load (0.000994)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001291)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002154)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001465)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001130)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000609)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10045, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002193)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10045)
  [4;36;1mSQL (0.001436)[0m   [0;1mselect 'x' from roles where id = 10045 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000615)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10045, 10059, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001717)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002067)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001583)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mEntryComment Columns (0.001290)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'ENTRY_COMMENTS'
 order by column_id
[0m
=== FAILED permission check: add_comment BlogEntry X(10004)
=== permission check: edit Role test role(10045)
  [4;36;1mSQL (0.001639)[0m   [0;1mselect 'x' from roles where id = 10045 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.007148)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:30:04', 10004, NULL, 10045, 10107, NULL, 0, '2008-05-12 22:30:04', 'add_comment', NULL)[0m
  [4;36;1mPermission Load (0.003036)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: add_comment BlogEntry X(10004)
  [4;35;1mSQL (0.012257)[0m   [0mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mEntryComment Create (0.007080)[0m   [0;1mINSERT INTO entry_comments (updated_at, comment_txt, id, owner_firm_id, owner_id, blog_entry_id, created_at) VALUES('2008-05-12 22:30:04', empty_clob(), 10000, 4, 2, 10004, '2008-05-12 22:30:04')[0m
  [4;35;1mWritable Large Object (0.008084)[0m   [0mSELECT comment_txt FROM entry_comments WHERE id = 10000[0m
=== permission check: destroy Role test role(10045)
  [4;36;1mRole Destroy (0.001308)[0m   [0;1m DELETE FROM roles
 WHERE id = 10045
[0m
  [4;35;1mRoleAssignment Load (0.001142)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001498)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000461)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10059
[0m
  [4;36;1mRoleAssignment Load (0.001649)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000620)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002785)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000743)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001779)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001278)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:04', 10046, 2, 5, '2008-05-12 22:30:04')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001519)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10046)
  [4;35;1mSQL (0.002089)[0m   [0mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001318)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:04', 10046, 10060, 5, NULL, '2008-05-12 22:30:04', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001063)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002794)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000915)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10004)
=== permission check: edit Role test role(10046)
  [4;36;1mSQL (0.002204)[0m   [0;1mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001428)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:30:04', 10004, NULL, 10046, 10108, NULL, 0, '2008-05-12 22:30:04', 'kill_comment', NULL)[0m
  [4;36;1mPermission Load (0.002290)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000828)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.001396)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyWithCallbacks Columns (0.001253)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mSQL (0.001331)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mUser Load (0.000826)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001444)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000637)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001376)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001068)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002813)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001390)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10047, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001502)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10047)
  [4;35;1mSQL (0.002046)[0m   [0mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001278)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10047, 10061, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001038)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002608)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10047)
  [4;35;1mSQL (0.001554)[0m   [0mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000734)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10047, 10109, NULL, 0, '2008-05-12 22:30:05', 'update', 3)[0m
  [4;35;1mPermission Load (0.002811)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: create PhonyWithCallbacks phony blog()
=== permission check: destroy Role test role(10047)
  [4;36;1mRole Destroy (0.000707)[0m   [0;1m DELETE FROM roles
 WHERE id = 10047
[0m
  [4;35;1mRoleAssignment Load (0.001745)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000811)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001115)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10061
[0m
  [4;36;1mRoleAssignment Load (0.000970)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001279)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002104)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001296)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.000653)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001744)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001262)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10048, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001496)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10048)
  [4;36;1mSQL (0.002047)[0m   [0;1mselect 'x' from roles where id = 10048 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001261)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10048, 10062, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRole Load (0.000887)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002030)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001352)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000580)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 4, 10063, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001692)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002150)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10048)
  [4;36;1mRole Destroy (0.001322)[0m   [0;1m DELETE FROM roles
 WHERE id = 10048
[0m
  [4;35;1mRoleAssignment Load (0.001066)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001484)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000440)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10062
[0m
  [4;36;1mUser Load (0.001454)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000420)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10063
[0m
  [4;36;1mRoleAssignment Load (0.001638)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000607)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002763)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000759)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001740)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001262)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10049, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001488)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10049)
  [4;35;1mSQL (0.002047)[0m   [0mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001260)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10049, 10064, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001021)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002721)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000905)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: create PhonyWithCallbacks phony blog()
=== permission check: edit Role test role(10049)
  [4;36;1mSQL (0.002222)[0m   [0;1mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001376)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10049, 10110, NULL, 0, '2008-05-12 22:30:05', 'create', 3)[0m
  [4;36;1mPermission Load (0.002252)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create PhonyWithCallbacks phony blog()
  [4;35;1mPhonyWithCallbacks Create (0.000696)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:30:05', 10007, 3, 3, '2008-05-12 22:30:05')[0m
=== permission check: destroy Role test role(10049)
  [4;36;1mRole Destroy (0.001176)[0m   [0;1m DELETE FROM roles
 WHERE id = 10049
[0m
  [4;35;1mRoleAssignment Load (0.001051)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001484)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000440)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10064
[0m
  [4;36;1mRoleAssignment Load (0.001643)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000608)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002918)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000678)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.001364)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001072)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000596)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10050, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002160)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10050)
  [4;36;1mSQL (0.001374)[0m   [0;1mselect 'x' from roles where id = 10050 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000590)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10050, 10065, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001694)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002174)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001588)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithCallbacks Load (0.000894)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== FAILED permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: edit Role test role(10050)
  [4;36;1mSQL (0.002211)[0m   [0;1mselect 'x' from roles where id = 10050 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001391)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10050, 10111, NULL, 0, '2008-05-12 22:30:05', 'find', 3)[0m
  [4;36;1mPermission Load (0.002387)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithCallbacks Load (0.001730)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: destroy Role test role(10050)
  [4;36;1mRole Destroy (0.000529)[0m   [0;1m DELETE FROM roles
 WHERE id = 10050
[0m
  [4;35;1mRoleAssignment Load (0.001703)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000801)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001105)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10065
[0m
  [4;36;1mRoleAssignment Load (0.000976)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001273)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002393)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001488)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001083)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000600)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10051, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002175)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10051)
  [4;35;1mSQL (0.001373)[0m   [0mselect 'x' from roles where id = 10051 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000593)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10051, 10066, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001697)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002311)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001595)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithCallbacks Load (0.000868)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== FAILED permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: edit Role test role(10051)
  [4;35;1mSQL (0.002194)[0m   [0mselect 'x' from roles where id = 10051 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001380)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10051, 10112, NULL, 0, '2008-05-12 22:30:05', 'find', 3)[0m
  [4;35;1mPermission Load (0.002383)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithCallbacks Load (0.001726)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: destroy Role test role(10051)
  [4;35;1mRole Destroy (0.000530)[0m   [0m DELETE FROM roles
 WHERE id = 10051
[0m
  [4;36;1mRoleAssignment Load (0.001699)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000802)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001101)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10066
[0m
  [4;35;1mRoleAssignment Load (0.000969)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001281)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002387)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001501)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001087)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000594)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10052, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002168)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10052)
  [4;36;1mSQL (0.001377)[0m   [0;1mselect 'x' from roles where id = 10052 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000591)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10052, 10067, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001698)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002309)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10052)
  [4;36;1mSQL (0.002367)[0m   [0;1mselect 'x' from roles where id = 10052 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001413)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10052, 10113, NULL, 0, '2008-05-12 22:30:05', 'create', 3)[0m
  [4;36;1mPermission Load (0.002397)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001691)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000754)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: update PhonyWithCallbacks phony blog updated(10007)
=== permission check: destroy Role test role(10052)
  [4;35;1mRole Destroy (0.001229)[0m   [0m DELETE FROM roles
 WHERE id = 10052
[0m
  [4;36;1mRoleAssignment Load (0.001040)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001458)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000739)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10067
[0m
  [4;35;1mRoleAssignment Load (0.001665)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000612)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.003065)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000815)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001745)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001297)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10053, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001518)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10053)
  [4;36;1mSQL (0.002043)[0m   [0;1mselect 'x' from roles where id = 10053 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001283)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10053, 10068, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001023)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002983)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000932)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithCallbacks Load (0.001536)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== FAILED permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: edit Role test role(10053)
  [4;36;1mSQL (0.001535)[0m   [0;1mselect 'x' from roles where id = 10053 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000744)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10053, 10114, NULL, 0, '2008-05-12 22:30:05', 'find', 3)[0m
  [4;36;1mPermission Load (0.003050)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithCallbacks Load (0.001063)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: destroy Role test role(10053)
  [4;36;1mRole Destroy (0.001224)[0m   [0;1m DELETE FROM roles
 WHERE id = 10053
[0m
  [4;35;1mRoleAssignment Load (0.001025)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001467)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000445)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10068
[0m
  [4;36;1mRoleAssignment Load (0.001632)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000605)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.003056)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000829)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001753)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001293)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10054, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001516)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10054)
  [4;35;1mSQL (0.002043)[0m   [0mselect 'x' from roles where id = 10054 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001277)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10054, 10069, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001034)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002991)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000934)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: update PhonyWithCallbacks phony blog updated(10007)
=== permission check: edit Role test role(10054)
  [4;36;1mSQL (0.002247)[0m   [0;1mselect 'x' from roles where id = 10054 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001410)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10054, 10115, NULL, 0, '2008-05-12 22:30:05', 'update', 3)[0m
  [4;36;1mPermission Load (0.002523)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: update PhonyWithCallbacks phony blog updated(10007)
  [4;35;1mPhonyWithCallbacks Update (0.008402)[0m   [0mUPDATE blogs SET name = 'phony blog updated', updated_at = '2008-05-12 22:30:05', owner_firm_id = 3, owner_id = 3, created_at = '2008-05-12 22:30:05' WHERE id = 10007[0m
=== permission check: destroy Role test role(10054)
  [4;36;1mRole Destroy (0.000610)[0m   [0;1m DELETE FROM roles
 WHERE id = 10054
[0m
  [4;35;1mRoleAssignment Load (0.001790)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000816)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001111)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10069
[0m
  [4;36;1mRoleAssignment Load (0.000968)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001276)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002485)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001515)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001080)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000625)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10055, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002182)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10055)
  [4;35;1mSQL (0.001378)[0m   [0mselect 'x' from roles where id = 10055 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000627)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10055, 10070, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001693)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002457)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001625)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithCallbacks Load (0.000868)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== FAILED permission check: find PhonyWithCallbacks phony blog updated(10007)
=== permission check: edit Role test role(10055)
  [4;35;1mSQL (0.002206)[0m   [0mselect 'x' from roles where id = 10055 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001404)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10055, 10116, NULL, 0, '2008-05-12 22:30:05', 'find', 3)[0m
  [4;35;1mPermission Load (0.002515)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithCallbacks Load (0.001753)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== permission check: find PhonyWithCallbacks phony blog updated(10007)
=== permission check: destroy Role test role(10055)
  [4;35;1mRole Destroy (0.000554)[0m   [0m DELETE FROM roles
 WHERE id = 10055
[0m
  [4;36;1mRoleAssignment Load (0.001693)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000801)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001112)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10070
[0m
  [4;35;1mRoleAssignment Load (0.000971)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001277)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002528)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001524)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001084)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000619)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10056, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002187)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10056)
  [4;36;1mSQL (0.001382)[0m   [0;1mselect 'x' from roles where id = 10056 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000616)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10056, 10071, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001691)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002450)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10056)
  [4;36;1mSQL (0.002413)[0m   [0;1mselect 'x' from roles where id = 10056 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001403)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10056, 10117, NULL, 0, '2008-05-12 22:30:05', 'update', 3)[0m
  [4;36;1mPermission Load (0.002520)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: destroy PhonyWithCallbacks phony blog updated(10007)
=== permission check: destroy Role test role(10056)
  [4;35;1mRole Destroy (0.001418)[0m   [0m DELETE FROM roles
 WHERE id = 10056
[0m
  [4;36;1mRoleAssignment Load (0.001056)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001479)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000445)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10071
[0m
  [4;35;1mRoleAssignment Load (0.001635)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000607)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.003196)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000684)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mSQL (0.001361)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001087)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000621)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10057, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002179)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10057)
  [4;35;1mSQL (0.001375)[0m   [0mselect 'x' from roles where id = 10057 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000603)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10057, 10072, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001697)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002457)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001624)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: destroy PhonyWithCallbacks phony blog updated(10007)
=== permission check: edit Role test role(10057)
  [4;36;1mSQL (0.001545)[0m   [0;1mselect 'x' from roles where id = 10057 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000762)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10057, 10118, NULL, 0, '2008-05-12 22:30:05', 'destroy', 3)[0m
  [4;36;1mPermission Load (0.003209)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy PhonyWithCallbacks phony blog updated(10007)
  [4;35;1mPhonyWithCallbacks Destroy (0.007359)[0m   [0m DELETE FROM blogs
 WHERE id = 10007
[0m
=== permission check: destroy Role test role(10057)
  [4;36;1mRole Destroy (0.001309)[0m   [0;1m DELETE FROM roles
 WHERE id = 10057
[0m
  [4;35;1mRoleAssignment Load (0.001119)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001496)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000452)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10072
[0m
  [4;36;1mRoleAssignment Load (0.001649)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000615)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.003171)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000688)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mPhonyWithCallbacks Load (0.001571)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
  [4;35;1mUser Load (0.000948)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.001503)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyWithEponymous Columns (0.001324)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mSQL (0.001326)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mUser Load (0.000826)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001448)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000644)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001388)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001104)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002846)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001383)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10058, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001530)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10058)
  [4;35;1mSQL (0.002100)[0m   [0mselect 'x' from roles where id = 10058 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001291)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10058, 10073, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001050)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002633)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10058)
  [4;35;1mSQL (0.001595)[0m   [0mselect 'x' from roles where id = 10058 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000739)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10058, 10119, NULL, 0, '2008-05-12 22:30:05', 'update', 3)[0m
  [4;35;1mPermission Load (0.002823)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: create PhonyWithEponymous phony blog()
=== permission check: destroy Role test role(10058)
  [4;36;1mRole Destroy (0.000721)[0m   [0;1m DELETE FROM roles
 WHERE id = 10058
[0m
  [4;35;1mRoleAssignment Load (0.001763)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000828)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001133)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10073
[0m
  [4;36;1mRoleAssignment Load (0.000997)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001280)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002129)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001306)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.000655)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001776)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001267)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10059, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001512)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10059)
  [4;36;1mSQL (0.002060)[0m   [0;1mselect 'x' from roles where id = 10059 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001261)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10059, 10074, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRole Load (0.000898)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002054)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001363)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000636)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 4, 10075, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001746)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002097)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10059)
  [4;36;1mRole Destroy (0.001301)[0m   [0;1m DELETE FROM roles
 WHERE id = 10059
[0m
  [4;35;1mRoleAssignment Load (0.001063)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001482)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000439)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10074
[0m
  [4;36;1mUser Load (0.001457)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000427)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10075
[0m
  [4;36;1mRoleAssignment Load (0.001653)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000604)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002629)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000741)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001749)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001246)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10060, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001419)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10060)
  [4;35;1mSQL (0.002025)[0m   [0mselect 'x' from roles where id = 10060 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001238)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10060, 10076, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001023)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002615)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000873)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: create PhonyWithEponymous phony blog()
=== permission check: edit Role test role(10060)
  [4;36;1mSQL (0.002146)[0m   [0;1mselect 'x' from roles where id = 10060 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001353)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10060, 10120, NULL, 0, '2008-05-12 22:30:05', 'create', 3)[0m
  [4;36;1mPermission Load (0.002135)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create PhonyWithEponymous phony blog()
  [4;35;1mPhonyWithEponymous Create (0.000649)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:30:05', 10008, 3, 3, '2008-05-12 22:30:05')[0m
=== permission check: destroy Role test role(10060)
  [4;36;1mRole Destroy (0.001157)[0m   [0;1m DELETE FROM roles
 WHERE id = 10060
[0m
  [4;35;1mRoleAssignment Load (0.001044)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001481)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000435)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10076
[0m
  [4;36;1mRoleAssignment Load (0.001654)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000604)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002755)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000647)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.001340)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001069)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000570)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10061, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002090)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10061)
  [4;36;1mSQL (0.001357)[0m   [0;1mselect 'x' from roles where id = 10061 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000574)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10061, 10077, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001702)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002034)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001551)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithEponymous Load (0.000877)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== FAILED permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: edit Role test role(10061)
  [4;36;1mSQL (0.002113)[0m   [0;1mselect 'x' from roles where id = 10061 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001347)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10061, 10121, NULL, 0, '2008-05-12 22:30:05', 'find', 3)[0m
  [4;36;1mPermission Load (0.002219)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithEponymous Load (0.001692)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: destroy Role test role(10061)
  [4;36;1mRole Destroy (0.000500)[0m   [0;1m DELETE FROM roles
 WHERE id = 10061
[0m
  [4;35;1mRoleAssignment Load (0.001695)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000802)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001100)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10077
[0m
  [4;36;1mRoleAssignment Load (0.000978)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001272)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002195)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001445)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001074)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000572)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10062, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002079)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10062)
  [4;35;1mSQL (0.001339)[0m   [0mselect 'x' from roles where id = 10062 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000565)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10062, 10078, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001681)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002134)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001550)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithEponymous Load (0.000862)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== FAILED permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: edit Role test role(10062)
  [4;35;1mSQL (0.002104)[0m   [0mselect 'x' from roles where id = 10062 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001338)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10062, 10122, NULL, 0, '2008-05-12 22:30:05', 'find', 3)[0m
  [4;35;1mPermission Load (0.002305)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithEponymous Load (0.001691)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: destroy Role test role(10062)
  [4;35;1mRole Destroy (0.000505)[0m   [0m DELETE FROM roles
 WHERE id = 10062
[0m
  [4;36;1mRoleAssignment Load (0.001687)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000799)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001099)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10078
[0m
  [4;35;1mRoleAssignment Load (0.000967)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001272)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002309)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001470)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001735)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001229)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:05', 10063, 2, 5, '2008-05-12 22:30:05')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001403)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10063)
  [4;36;1mSQL (0.002006)[0m   [0;1mselect 'x' from roles where id = 10063 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001270)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:05', 10063, 10079, 5, NULL, '2008-05-12 22:30:05', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001019)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002921)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10063)
  [4;36;1mSQL (0.001599)[0m   [0;1mselect 'x' from roles where id = 10063 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000672)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:05', NULL, NULL, 10063, 10123, NULL, 0, '2008-05-12 22:30:05', 'create', 3)[0m
  [4;36;1mPermission Load (0.002967)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000981)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.001409)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: update PhonyWithEponymous phony blog updated(10008)
=== permission check: destroy Role test role(10063)
  [4;35;1mRole Destroy (0.000532)[0m   [0m DELETE FROM roles
 WHERE id = 10063
[0m
  [4;36;1mRoleAssignment Load (0.001706)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000794)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001362)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10079
[0m
  [4;35;1mRoleAssignment Load (0.000989)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001273)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002304)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001458)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001067)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000592)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10064, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002073)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10064)
  [4;36;1mSQL (0.001329)[0m   [0;1mselect 'x' from roles where id = 10064 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000604)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10064, 10080, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001699)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002264)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001567)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithEponymous Load (0.000863)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== FAILED permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: edit Role test role(10064)
  [4;36;1mSQL (0.002107)[0m   [0;1mselect 'x' from roles where id = 10064 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001360)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10064, 10124, NULL, 0, '2008-05-12 22:30:06', 'find', 3)[0m
  [4;36;1mPermission Load (0.002317)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithEponymous Load (0.001698)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: destroy Role test role(10064)
  [4;36;1mRole Destroy (0.000524)[0m   [0;1m DELETE FROM roles
 WHERE id = 10064
[0m
  [4;35;1mRoleAssignment Load (0.001695)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000801)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001120)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10080
[0m
  [4;36;1mRoleAssignment Load (0.000967)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001270)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002306)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001464)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001069)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000581)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10065, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002073)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10065)
  [4;35;1mSQL (0.001332)[0m   [0mselect 'x' from roles where id = 10065 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000580)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10065, 10081, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001693)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002259)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001565)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: update PhonyWithEponymous phony blog updated(10008)
=== permission check: edit Role test role(10065)
  [4;36;1mSQL (0.001483)[0m   [0;1mselect 'x' from roles where id = 10065 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000691)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10065, 10125, NULL, 0, '2008-05-12 22:30:06', 'update', 3)[0m
  [4;36;1mPermission Load (0.002971)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: update PhonyWithEponymous phony blog updated(10008)
  [4;35;1mPhonyWithEponymous Update (0.000855)[0m   [0mUPDATE blogs SET name = 'phony blog updated', updated_at = '2008-05-12 22:30:06', owner_firm_id = 3, owner_id = 3, created_at = '2008-05-12 22:30:05' WHERE id = 10008[0m
=== permission check: destroy Role test role(10065)
  [4;36;1mRole Destroy (0.001152)[0m   [0;1m DELETE FROM roles
 WHERE id = 10065
[0m
  [4;35;1mRoleAssignment Load (0.001063)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001484)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000447)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10081
[0m
  [4;36;1mRoleAssignment Load (0.001639)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000603)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002970)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000806)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001734)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001261)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10066, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001407)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10066)
  [4;35;1mSQL (0.002005)[0m   [0mselect 'x' from roles where id = 10066 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001246)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10066, 10082, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001018)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002924)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000888)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithEponymous Load (0.001529)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== FAILED permission check: find PhonyWithEponymous phony blog updated(10008)
=== permission check: edit Role test role(10066)
  [4;35;1mSQL (0.001436)[0m   [0mselect 'x' from roles where id = 10066 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000691)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10066, 10126, NULL, 0, '2008-05-12 22:30:06', 'find', 3)[0m
  [4;35;1mPermission Load (0.002987)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithEponymous Load (0.001027)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== permission check: find PhonyWithEponymous phony blog updated(10008)
=== permission check: destroy Role test role(10066)
  [4;35;1mRole Destroy (0.001188)[0m   [0m DELETE FROM roles
 WHERE id = 10066
[0m
  [4;36;1mRoleAssignment Load (0.001026)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001476)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000454)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10082
[0m
  [4;35;1mRoleAssignment Load (0.001635)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000603)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002973)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000806)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001737)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001252)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10067, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001407)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10067)
  [4;36;1mSQL (0.002004)[0m   [0;1mselect 'x' from roles where id = 10067 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001247)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10067, 10083, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001016)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002915)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10067)
  [4;36;1mSQL (0.001602)[0m   [0;1mselect 'x' from roles where id = 10067 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000697)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10067, 10127, NULL, 0, '2008-05-12 22:30:06', 'update', 3)[0m
  [4;36;1mPermission Load (0.002972)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: destroy PhonyWithEponymous phony blog updated(10008)
=== permission check: destroy Role test role(10067)
  [4;35;1mRole Destroy (0.000678)[0m   [0m DELETE FROM roles
 WHERE id = 10067
[0m
  [4;36;1mRoleAssignment Load (0.001711)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000809)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001110)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10083
[0m
  [4;35;1mRoleAssignment Load (0.000969)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001272)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002304)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001339)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mSQL (0.000682)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001734)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001263)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10068, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001413)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10068)
  [4;35;1mSQL (0.002000)[0m   [0mselect 'x' from roles where id = 10068 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001266)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10068, 10084, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001017)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002913)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000894)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: destroy PhonyWithEponymous phony blog updated(10008)
=== permission check: edit Role test role(10068)
  [4;36;1mSQL (0.002137)[0m   [0;1mselect 'x' from roles where id = 10068 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001364)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10068, 10128, NULL, 0, '2008-05-12 22:30:06', 'destroy', 3)[0m
  [4;36;1mPermission Load (0.002663)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy PhonyWithEponymous phony blog updated(10008)
  [4;35;1mPhonyWithEponymous Destroy (0.001392)[0m   [0m DELETE FROM blogs
 WHERE id = 10008
[0m
=== permission check: destroy Role test role(10068)
  [4;36;1mRole Destroy (0.000493)[0m   [0;1m DELETE FROM roles
 WHERE id = 10068
[0m
  [4;35;1mRoleAssignment Load (0.001716)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000807)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001111)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10084
[0m
  [4;36;1mRoleAssignment Load (0.000969)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001271)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002728)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001324)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mPhonyWithEponymous Load (0.000870)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
  [4;35;1mUser Load (0.000794)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.001392)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyWithForAction Columns (0.001231)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mSQL (0.001295)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mUser Load (0.000813)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001442)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000627)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001377)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001065)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002703)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001332)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10069, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001427)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10069)
  [4;35;1mSQL (0.002026)[0m   [0mselect 'x' from roles where id = 10069 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001262)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10069, 10085, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001022)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002503)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10069)
  [4;35;1mSQL (0.001468)[0m   [0mselect 'x' from roles where id = 10069 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000688)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10069, 10129, NULL, 0, '2008-05-12 22:30:06', 'update', 3)[0m
  [4;35;1mPermission Load (0.002673)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: create PhonyWithForAction phony blog()
=== permission check: destroy Role test role(10069)
  [4;36;1mRole Destroy (0.000647)[0m   [0;1m DELETE FROM roles
 WHERE id = 10069
[0m
  [4;35;1mRoleAssignment Load (0.001734)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000806)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001119)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10085
[0m
  [4;36;1mRoleAssignment Load (0.000986)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001268)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001969)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001272)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.000628)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001728)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001230)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10070, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001386)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10070)
  [4;36;1mSQL (0.001998)[0m   [0;1mselect 'x' from roles where id = 10070 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001229)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10070, 10086, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRole Load (0.000879)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001970)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001323)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000565)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 4, 10087, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001697)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002022)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10070)
  [4;36;1mRole Destroy (0.001276)[0m   [0;1m DELETE FROM roles
 WHERE id = 10070
[0m
  [4;35;1mRoleAssignment Load (0.001055)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001478)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000436)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10086
[0m
  [4;36;1mUser Load (0.001455)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000423)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10087
[0m
  [4;36;1mRoleAssignment Load (0.001637)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000599)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002636)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000729)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001734)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001224)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10071, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001388)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10071)
  [4;35;1mSQL (0.001992)[0m   [0mselect 'x' from roles where id = 10071 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001230)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10071, 10088, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001020)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002600)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000862)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: create PhonyWithForAction phony blog()
=== permission check: edit Role test role(10071)
  [4;36;1mSQL (0.002138)[0m   [0;1mselect 'x' from roles where id = 10071 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001346)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10071, 10130, NULL, 0, '2008-05-12 22:30:06', 'create', 3)[0m
  [4;36;1mPermission Load (0.001993)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create PhonyWithForAction phony blog()
  [4;35;1mPhonyWithForAction Create (0.000691)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:30:06', 10009, 3, 3, '2008-05-12 22:30:06')[0m
=== permission check: destroy Role test role(10071)
  [4;36;1mRole Destroy (0.001165)[0m   [0;1m DELETE FROM roles
 WHERE id = 10071
[0m
  [4;35;1mRoleAssignment Load (0.001088)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001592)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000443)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10088
[0m
  [4;36;1mRoleAssignment Load (0.001648)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000615)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002656)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000629)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.001345)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001094)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000561)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10072, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002076)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10072)
  [4;36;1mSQL (0.001342)[0m   [0;1mselect 'x' from roles where id = 10072 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000563)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10072, 10089, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001699)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001938)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001515)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithForAction Load (0.000888)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== FAILED permission check: find PhonyWithForAction phony blog(10009)
=== permission check: edit Role test role(10072)
  [4;36;1mSQL (0.002122)[0m   [0;1mselect 'x' from roles where id = 10072 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001351)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10072, 10131, NULL, 0, '2008-05-12 22:30:06', 'find', 3)[0m
  [4;36;1mPermission Load (0.002128)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithForAction Load (0.001670)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== permission check: find PhonyWithForAction phony blog(10009)
=== permission check: destroy Role test role(10072)
  [4;36;1mRole Destroy (0.000510)[0m   [0;1m DELETE FROM roles
 WHERE id = 10072
[0m
  [4;35;1mRoleAssignment Load (0.001705)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000815)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001106)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10089
[0m
  [4;36;1mRoleAssignment Load (0.000974)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002100)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001443)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001089)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000572)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10073, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002085)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10073)
  [4;35;1mSQL (0.001348)[0m   [0mselect 'x' from roles where id = 10073 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000570)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10073, 10090, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001697)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002040)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001539)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithForAction Load (0.000869)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== FAILED permission check: find PhonyWithForAction phony blog(10009)
=== permission check: edit Role test role(10073)
  [4;35;1mSQL (0.002112)[0m   [0mselect 'x' from roles where id = 10073 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001340)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10073, 10132, NULL, 0, '2008-05-12 22:30:06', 'find', 3)[0m
  [4;35;1mPermission Load (0.002096)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithForAction Load (0.001663)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== permission check: find PhonyWithForAction phony blog(10009)
=== permission check: destroy Role test role(10073)
  [4;35;1mRole Destroy (0.000507)[0m   [0m DELETE FROM roles
 WHERE id = 10073
[0m
  [4;36;1mRoleAssignment Load (0.001707)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000806)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001104)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10090
[0m
  [4;35;1mRoleAssignment Load (0.000979)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001272)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002084)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001447)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001077)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000560)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10074, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002080)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10074)
  [4;36;1mSQL (0.001330)[0m   [0;1mselect 'x' from roles where id = 10074 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000565)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10074, 10091, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001693)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002033)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10074)
  [4;36;1mSQL (0.002229)[0m   [0;1mselect 'x' from roles where id = 10074 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001371)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10074, 10133, NULL, 0, '2008-05-12 22:30:06', 'create', 3)[0m
  [4;36;1mPermission Load (0.002118)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001634)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000744)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: update PhonyWithForAction phony blog updated(10009)
=== permission check: destroy Role test role(10074)
  [4;35;1mRole Destroy (0.001211)[0m   [0m DELETE FROM roles
 WHERE id = 10074
[0m
  [4;36;1mRoleAssignment Load (0.001039)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001468)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000704)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10091
[0m
  [4;35;1mRoleAssignment Load (0.001670)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000606)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002773)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000757)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001739)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001264)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10075, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001411)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10075)
  [4;36;1mSQL (0.002007)[0m   [0;1mselect 'x' from roles where id = 10075 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001246)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10075, 10092, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001019)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002706)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000863)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithForAction Load (0.001532)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== FAILED permission check: find PhonyWithForAction phony blog(10009)
=== permission check: edit Role test role(10075)
  [4;36;1mSQL (0.001437)[0m   [0;1mselect 'x' from roles where id = 10075 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000688)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10075, 10134, NULL, 0, '2008-05-12 22:30:06', 'find', 3)[0m
  [4;36;1mPermission Load (0.002870)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithForAction Load (0.001015)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== permission check: find PhonyWithForAction phony blog(10009)
=== permission check: destroy Role test role(10075)
  [4;36;1mRole Destroy (0.001191)[0m   [0;1m DELETE FROM roles
 WHERE id = 10075
[0m
  [4;35;1mRoleAssignment Load (0.001030)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001469)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000437)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10092
[0m
  [4;36;1mRoleAssignment Load (0.001643)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000606)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002863)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000778)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001736)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001261)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10076, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001412)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10076)
  [4;35;1mSQL (0.002014)[0m   [0mselect 'x' from roles where id = 10076 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001257)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10076, 10093, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001017)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002820)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000887)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: update PhonyWithForAction phony blog updated(10009)
=== permission check: edit Role test role(10076)
  [4;36;1mSQL (0.002150)[0m   [0;1mselect 'x' from roles where id = 10076 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001365)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10076, 10135, NULL, 0, '2008-05-12 22:30:06', 'update', 3)[0m
  [4;36;1mPermission Load (0.002199)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: update PhonyWithForAction phony blog updated(10009)
  [4;35;1mPhonyWithForAction Update (0.001478)[0m   [0mUPDATE blogs SET name = 'phony blog updated', updated_at = '2008-05-12 22:30:06', owner_firm_id = 3, owner_id = 3, created_at = '2008-05-12 22:30:06' WHERE id = 10009[0m
=== permission check: destroy Role test role(10076)
  [4;36;1mRole Destroy (0.000477)[0m   [0;1m DELETE FROM roles
 WHERE id = 10076
[0m
  [4;35;1mRoleAssignment Load (0.001719)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000811)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001118)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10093
[0m
  [4;36;1mRoleAssignment Load (0.000971)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001273)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002189)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001440)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001077)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000581)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10077, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002076)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10077)
  [4;35;1mSQL (0.001332)[0m   [0mselect 'x' from roles where id = 10077 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000576)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10077, 10094, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001681)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002141)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001556)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithForAction Load (0.000862)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== FAILED permission check: find PhonyWithForAction phony blog updated(10009)
=== permission check: edit Role test role(10077)
  [4;35;1mSQL (0.002104)[0m   [0mselect 'x' from roles where id = 10077 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001358)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10077, 10136, NULL, 0, '2008-05-12 22:30:06', 'find', 3)[0m
  [4;35;1mPermission Load (0.002197)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithForAction Load (0.001679)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== permission check: find PhonyWithForAction phony blog updated(10009)
=== permission check: destroy Role test role(10077)
  [4;35;1mRole Destroy (0.000519)[0m   [0m DELETE FROM roles
 WHERE id = 10077
[0m
  [4;36;1mRoleAssignment Load (0.001687)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000798)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001108)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10094
[0m
  [4;35;1mRoleAssignment Load (0.000967)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001272)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002197)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001453)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001079)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000591)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10078, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002077)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10078)
  [4;36;1mSQL (0.001334)[0m   [0;1mselect 'x' from roles where id = 10078 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000577)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10078, 10095, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001681)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002138)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10078)
  [4;36;1mSQL (0.002242)[0m   [0;1mselect 'x' from roles where id = 10078 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001363)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10078, 10137, NULL, 0, '2008-05-12 22:30:06', 'update', 3)[0m
  [4;36;1mPermission Load (0.002203)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: destroy PhonyWithForAction phony blog updated(10009)
=== permission check: destroy Role test role(10078)
  [4;35;1mRole Destroy (0.001330)[0m   [0m DELETE FROM roles
 WHERE id = 10078
[0m
  [4;36;1mRoleAssignment Load (0.001048)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001478)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000444)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10095
[0m
  [4;35;1mRoleAssignment Load (0.001629)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000605)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002871)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000657)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mSQL (0.001342)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001065)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000591)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10079, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002078)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10079)
  [4;35;1mSQL (0.001335)[0m   [0mselect 'x' from roles where id = 10079 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000579)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10079, 10096, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001688)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002138)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001549)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: destroy PhonyWithForAction phony blog updated(10009)
=== permission check: edit Role test role(10079)
  [4;36;1mSQL (0.001456)[0m   [0;1mselect 'x' from roles where id = 10079 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000689)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:30:06', NULL, NULL, 10079, 10138, NULL, 0, '2008-05-12 22:30:06', 'destroy', 3)[0m
  [4;36;1mPermission Load (0.003108)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy PhonyWithForAction phony blog updated(10009)
  [4;35;1mPhonyWithForAction Destroy (0.000696)[0m   [0m DELETE FROM blogs
 WHERE id = 10009
[0m
=== permission check: destroy Role test role(10079)
  [4;36;1mRole Destroy (0.001163)[0m   [0;1m DELETE FROM roles
 WHERE id = 10079
[0m
  [4;35;1mRoleAssignment Load (0.001056)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001479)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000448)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10096
[0m
  [4;36;1mRoleAssignment Load (0.001633)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000600)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002980)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000648)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mPhonyWithForAction Load (0.001539)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
  [4;35;1mUser Load (0.000796)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.001400)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyNeverPermits Columns (0.001237)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mPhonyNeverPermits Create (0.000639)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:30:06', 10010, 3, 3, '2008-05-12 22:30:06')[0m
  [4;35;1mUser Load (0.001473)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
=== FAILED permission check: forbidden_operation PhonyNeverPermits phony blog(10010)
  [4;36;1mUser Load (0.000792)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001436)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000637)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001379)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001069)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002689)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001316)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:06', 10080, 2, 5, '2008-05-12 22:30:06')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001435)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10080)
  [4;36;1mSQL (0.002038)[0m   [0;1mselect 'x' from roles where id = 10080 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001269)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:06', 10080, 10097, 5, NULL, '2008-05-12 22:30:06', NULL)[0m
  [4;36;1mRole Load (0.000876)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001974)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001321)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000553)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 4, 10098, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001690)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001920)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001607)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
=== FAILED permission check: change_post Blog mertz family blog(1)
=== permission check: destroy Role test role(10080)
  [4;35;1mRole Destroy (0.000547)[0m   [0m DELETE FROM roles
 WHERE id = 10080
[0m
  [4;36;1mRoleAssignment Load (0.001711)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000807)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001103)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10097
[0m
  [4;35;1mUser Load (0.000797)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001088)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10098
[0m
  [4;35;1mRoleAssignment Load (0.000971)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001267)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001849)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001367)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001065)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000556)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10081, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002037)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10081)
  [4;36;1mSQL (0.001319)[0m   [0;1mselect 'x' from roles where id = 10081 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000563)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10081, 10099, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001680)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001820)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001498)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_post Blog mertz family blog(1)
=== permission check: edit Role test role(10081)
  [4;35;1mSQL (0.001429)[0m   [0mselect 'x' from roles where id = 10081 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000693)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:30:07', 1, 'mertz family blog', 10081, 10139, NULL, 0, '2008-05-12 22:30:07', 'change_post', NULL)[0m
  [4;35;1mPermission Load (0.002670)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_post Blog mertz family blog(1)
=== permission check: change_post Blog mertz family blog(1)
=== permission check: destroy Role test role(10081)
  [4;36;1mRole Destroy (0.000613)[0m   [0;1m DELETE FROM roles
 WHERE id = 10081
[0m
  [4;35;1mRoleAssignment Load (0.001710)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000811)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001099)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10099
[0m
  [4;36;1mRoleAssignment Load (0.000966)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001960)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000825)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001441)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000636)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001392)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001070)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002682)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001327)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10082, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001396)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10082)
  [4;35;1mSQL (0.002006)[0m   [0mselect 'x' from roles where id = 10082 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001275)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10082, 10100, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001037)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002536)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000836)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithInitSet Columns (0.001900)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
=== FAILED permission check: priv PhonyWithInitSet X()
=== permission check: edit Role test role(10082)
  [4;35;1mSQL (0.002180)[0m   [0mselect 'x' from roles where id = 10082 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001365)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10082, 10140, NULL, 0, '2008-05-12 22:30:07', 'priv', NULL)[0m
  [4;35;1mPermission Load (0.002041)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet X()
=== permission check: destroy Role test role(10082)
  [4;36;1mRole Destroy (0.001291)[0m   [0;1m DELETE FROM roles
 WHERE id = 10082
[0m
  [4;35;1mRoleAssignment Load (0.001058)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001479)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000443)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10100
[0m
  [4;36;1mRoleAssignment Load (0.001643)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000608)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002639)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000726)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001741)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001226)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10083, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001389)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10083)
  [4;35;1mSQL (0.001998)[0m   [0mselect 'x' from roles where id = 10083 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001248)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10083, 10101, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001027)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002599)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000836)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet X()
=== permission check: edit Role test role(10083)
  [4;36;1mSQL (0.002091)[0m   [0;1mselect 'x' from roles where id = 10083 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001339)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10083, 10141, NULL, 0, '2008-05-12 22:30:07', 'priv', NULL)[0m
  [4;36;1mPermission Load (0.001985)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet X()
=== permission check: destroy Role test role(10083)
  [4;35;1mRole Destroy (0.001279)[0m   [0m DELETE FROM roles
 WHERE id = 10083
[0m
  [4;36;1mRoleAssignment Load (0.001049)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001476)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000436)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10101
[0m
  [4;35;1mRoleAssignment Load (0.001651)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000601)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002630)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000726)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001735)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001228)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10084, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001389)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10084)
  [4;36;1mSQL (0.002008)[0m   [0;1mselect 'x' from roles where id = 10084 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001231)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10084, 10102, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001023)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002603)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000833)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet X()
=== permission check: edit Role test role(10084)
  [4;35;1mSQL (0.002095)[0m   [0mselect 'x' from roles where id = 10084 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001337)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10084, 10142, NULL, 0, '2008-05-12 22:30:07', 'priv', NULL)[0m
  [4;35;1mPermission Load (0.002089)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet X()
=== permission check: priv PhonyWithInitSet X()
=== permission check: destroy Role test role(10084)
  [4;36;1mRole Destroy (0.001296)[0m   [0;1m DELETE FROM roles
 WHERE id = 10084
[0m
  [4;35;1mRoleAssignment Load (0.001053)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001479)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000433)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10102
[0m
  [4;36;1mRoleAssignment Load (0.001637)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000600)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002745)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000913)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.001403)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyWithInitSet Create (0.001267)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:30:07', 10011, 3, 3, '2008-05-12 22:30:07')[0m
  [4;36;1mSQL (0.000665)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001725)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001174)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10085, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001392)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10085)
  [4;36;1mSQL (0.002008)[0m   [0;1mselect 'x' from roles where id = 10085 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001240)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10085, 10103, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001031)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002695)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000864)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: edit Role test role(10085)
  [4;35;1mSQL (0.002113)[0m   [0mselect 'x' from roles where id = 10085 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001338)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10085, 10143, NULL, 0, '2008-05-12 22:30:07', 'priv', NULL)[0m
  [4;35;1mPermission Load (0.002183)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: destroy Role test role(10085)
  [4;36;1mRole Destroy (0.001340)[0m   [0;1m DELETE FROM roles
 WHERE id = 10085
[0m
  [4;35;1mRoleAssignment Load (0.001073)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001489)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000448)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10103
[0m
  [4;36;1mRoleAssignment Load (0.001660)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000608)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002752)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000753)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001754)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001250)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10086, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001417)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10086)
  [4;35;1mSQL (0.002017)[0m   [0mselect 'x' from roles where id = 10086 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001237)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10086, 10104, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001040)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002711)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000868)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: edit Role test role(10086)
  [4;36;1mSQL (0.002116)[0m   [0;1mselect 'x' from roles where id = 10086 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001341)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10086, 10144, NULL, 0, '2008-05-12 22:30:07', 'priv', NULL)[0m
  [4;36;1mPermission Load (0.002110)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: destroy Role test role(10086)
  [4;35;1mRole Destroy (0.001300)[0m   [0m DELETE FROM roles
 WHERE id = 10086
[0m
  [4;36;1mRoleAssignment Load (0.001069)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001495)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000452)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10104
[0m
  [4;35;1mRoleAssignment Load (0.001652)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000614)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002771)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000767)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001763)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001234)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10087, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001424)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10087)
  [4;36;1mSQL (0.002016)[0m   [0;1mselect 'x' from roles where id = 10087 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001235)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10087, 10105, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001040)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002709)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000870)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: edit Role test role(10087)
  [4;35;1mSQL (0.002129)[0m   [0mselect 'x' from roles where id = 10087 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001339)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10087, 10145, NULL, 0, '2008-05-12 22:30:07', 'priv', NULL)[0m
  [4;35;1mPermission Load (0.002096)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: destroy Role test role(10087)
  [4;36;1mRole Destroy (0.001326)[0m   [0;1m DELETE FROM roles
 WHERE id = 10087
[0m
  [4;35;1mRoleAssignment Load (0.001050)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001485)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000439)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10105
[0m
  [4;36;1mRoleAssignment Load (0.001654)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000604)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002750)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000894)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mPhonyWithDefaults Columns (0.001917)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;35;1mFirm Load (0.001482)[0m   [0mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;36;1mFirm Load (0.000757)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mUser Load (0.001454)[0m   [0mSELECT * FROM users WHERE (users.id = 1) [0m
  [4;36;1mFirm Load (0.000702)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mUser Load (0.001530)[0m   [0mSELECT * FROM users WHERE (users.id = 1) [0m
  [4;36;1mFirm Load (0.000711)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mUser Load (0.001465)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000773)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001306)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000713)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001791)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002060)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000641)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10088, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002074)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10088)
  [4;35;1mSQL (0.001349)[0m   [0mselect 'x' from roles where id = 10088 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000576)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10088, 10106, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001686)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001833)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRoleAssignment Load (0.006981)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.id = 2) [0m
  [4;36;1mUser Load (0.000869)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;35;1mUser Load (0.001436)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;36;1mSQL (0.001449)[0m   [0;1mselect 'x' from roles where id = 10088 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001591)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10088) [0m
  [4;36;1mPermission Create (0.001337)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('User', 0, 0, '2008-05-12 22:30:07', 4, 'ricky', 10088, 10146, NULL, 0, '2008-05-12 22:30:07', 'administer', NULL)[0m
  [4;35;1mPermission Load (0.002013)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10088)
  [4;36;1mRole Destroy (0.001267)[0m   [0;1m DELETE FROM roles
 WHERE id = 10088
[0m
  [4;35;1mRoleAssignment Load (0.001039)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001473)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000433)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10106
[0m
  [4;36;1mRoleAssignment Load (0.001645)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000603)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002635)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000882)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001447)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000626)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001385)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001070)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002675)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001322)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10089, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001398)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10089)
  [4;35;1mSQL (0.002003)[0m   [0mselect 'x' from roles where id = 10089 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001239)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10089, 10107, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRole Load (0.000867)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001967)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001317)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000556)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 4, 10108, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001692)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001924)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyReqPermEntry Columns (0.001954)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOG_ENTRIES'
 order by column_id
[0m
  [4;36;1mSQL (0.001488)[0m   [0;1mselect 'x' from roles where id = 10089 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001600)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10089) [0m
  [4;36;1mPermission Create (0.001344)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyReqPermEntry', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10089, 10147, NULL, 0, '2008-05-12 22:30:07', 'blurt', NULL)[0m
  [4;35;1mPermission Load (0.002086)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002210)[0m   [0;1mselect 'x' from roles where id = 10089 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000895)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10089) [0m
  [4;36;1mPermission Create (0.000653)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyReqPermBlog', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10089, 10148, NULL, 0, '2008-05-12 22:30:07', 'bloviate', NULL)[0m
  [4;35;1mPermission Load (0.002747)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyReqPermComment Columns (0.001317)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'ENTRY_COMMENTS'
 order by column_id
[0m
=== permission check: destroy Role test role(10089)
  [4;35;1mRole Destroy (0.000519)[0m   [0m DELETE FROM roles
 WHERE id = 10089
[0m
  [4;36;1mRoleAssignment Load (0.001735)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000804)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001106)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10107
[0m
  [4;35;1mUser Load (0.000786)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001088)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10108
[0m
  [4;35;1mRoleAssignment Load (0.000972)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001268)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001972)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001534)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mUser Load (0.000792)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001437)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000628)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001383)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001062)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002673)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001303)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10090, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001395)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10090)
  [4;35;1mSQL (0.002002)[0m   [0mselect 'x' from roles where id = 10090 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001240)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10090, 10109, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001014)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002499)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000833)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mFirm Load (0.001408)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyBlog Columns (0.001247)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
=== FAILED permission check: change_name PhonyBlog X()
=== permission check: edit Role test role(10090)
  [4;36;1mSQL (0.002168)[0m   [0;1mselect 'x' from roles where id = 10090 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001353)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10090, 10149, NULL, 0, '2008-05-12 22:30:07', 'change_name', 3)[0m
  [4;36;1mPermission Load (0.001905)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_name PhonyBlog X()
=== permission check: change_name PhonyBlog X()
  [4;35;1mPhonyBlog Create (0.000615)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony', '2008-05-12 22:30:07', 10012, 3, 3, '2008-05-12 22:30:07')[0m
=== permission check: destroy Role test role(10090)
  [4;36;1mRole Destroy (0.001150)[0m   [0;1m DELETE FROM roles
 WHERE id = 10090
[0m
  [4;35;1mRoleAssignment Load (0.001039)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001477)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000442)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10109
[0m
  [4;36;1mRoleAssignment Load (0.001642)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000616)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002542)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000692)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001750)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001236)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10091, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001397)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10091)
  [4;35;1mSQL (0.002020)[0m   [0mselect 'x' from roles where id = 10091 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001243)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10091, 10110, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001028)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002503)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001466)[0m   [0mselect 'x' from roles where id = 10091 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001577)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10091) [0m
  [4;35;1mPermission Create (0.001330)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:07', 10012, 'phony', 10091, 10150, NULL, 0, '2008-05-12 22:30:07', 'grubbitz', NULL)[0m
  [4;36;1mPermission Load (0.001908)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Load (0.002627)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 3
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10091)
  [4;36;1mRole Destroy (0.000556)[0m   [0;1m DELETE FROM roles
 WHERE id = 10091
[0m
  [4;35;1mRoleAssignment Load (0.001694)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000807)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001105)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10110
[0m
  [4;36;1mRoleAssignment Load (0.000971)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001271)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001846)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001528)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000733)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mUser Load (0.001484)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000764)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001298)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000720)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001727)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002000)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000632)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10092, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002060)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10092)
  [4;35;1mSQL (0.001329)[0m   [0mselect 'x' from roles where id = 10092 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000572)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10092, 10111, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001685)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001825)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001501)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_name PhonyBlog X()
=== permission check: edit Role test role(10092)
  [4;36;1mSQL (0.001410)[0m   [0;1mselect 'x' from roles where id = 10092 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000681)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10092, 10151, NULL, 0, '2008-05-12 22:30:07', 'change_name', 3)[0m
  [4;36;1mPermission Load (0.002570)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_name PhonyBlog X()
=== permission check: change_name PhonyBlog X()
=== permission check: destroy Role test role(10092)
  [4;35;1mRole Destroy (0.000568)[0m   [0m DELETE FROM roles
 WHERE id = 10092
[0m
  [4;36;1mRoleAssignment Load (0.001708)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000804)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001101)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10111
[0m
  [4;35;1mRoleAssignment Load (0.000971)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001267)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001840)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001531)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mUser Load (0.000792)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001434)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000630)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001396)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001069)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002661)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001324)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10093, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001388)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10093)
  [4;35;1mSQL (0.002005)[0m   [0mselect 'x' from roles where id = 10093 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001238)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10093, 10112, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001020)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002488)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000813)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mFirm Load (0.001403)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: grubbitz PhonyBlog X()
=== permission check: edit Role test role(10093)
  [4;35;1mSQL (0.001412)[0m   [0mselect 'x' from roles where id = 10093 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000669)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10093, 10152, NULL, 0, '2008-05-12 22:30:07', 'grubbitz', 3)[0m
  [4;35;1mPermission Load (0.002655)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grubbitz PhonyBlog X()
=== permission check: destroy Role test role(10093)
  [4;36;1mRole Destroy (0.000609)[0m   [0;1m DELETE FROM roles
 WHERE id = 10093
[0m
  [4;35;1mRoleAssignment Load (0.001722)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000805)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001109)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10112
[0m
  [4;36;1mRoleAssignment Load (0.000975)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001269)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001953)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001395)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001067)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000558)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10094, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002057)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10094)
  [4;35;1mSQL (0.001337)[0m   [0mselect 'x' from roles where id = 10094 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000566)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10094, 10113, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001691)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001917)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001499)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grubbitz PhonyBlog X()
=== permission check: edit Role test role(10094)
  [4;36;1mSQL (0.001423)[0m   [0;1mselect 'x' from roles where id = 10094 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000665)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10094, 10153, NULL, 0, '2008-05-12 22:30:07', 'grubbitz', 3)[0m
  [4;36;1mPermission Load (0.002758)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grubbitz PhonyBlog X()
=== permission check: destroy Role test role(10094)
  [4;35;1mRole Destroy (0.000623)[0m   [0m DELETE FROM roles
 WHERE id = 10094
[0m
  [4;36;1mRoleAssignment Load (0.001713)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000807)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001114)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10113
[0m
  [4;35;1mRoleAssignment Load (0.000977)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001264)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002079)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001427)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001069)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000561)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:07', 10095, 2, 5, '2008-05-12 22:30:07')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002074)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10095)
  [4;36;1mSQL (0.001325)[0m   [0;1mselect 'x' from roles where id = 10095 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000562)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:07', 10095, 10114, 5, NULL, '2008-05-12 22:30:07', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001689)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002018)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001528)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grabbitz PhonyBlog X()
=== permission check: edit Role test role(10095)
  [4;35;1mSQL (0.001442)[0m   [0mselect 'x' from roles where id = 10095 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000663)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:07', NULL, NULL, 10095, 10154, NULL, 0, '2008-05-12 22:30:07', 'grabbitz', 3)[0m
  [4;35;1mPermission Load (0.002765)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grabbitz PhonyBlog X()
=== permission check: grabbitz PhonyBlog X()
=== permission check: destroy Role test role(10095)
  [4;36;1mRole Destroy (0.000617)[0m   [0;1m DELETE FROM roles
 WHERE id = 10095
[0m
  [4;35;1mRoleAssignment Load (0.001706)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000808)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001110)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10114
[0m
  [4;36;1mRoleAssignment Load (0.000976)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001268)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002079)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001421)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001070)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000565)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10096, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002063)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10096)
  [4;35;1mSQL (0.001336)[0m   [0mselect 'x' from roles where id = 10096 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001230)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10096, 10115, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001024)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002698)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000860)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grabbitz PhonyBlog X()
=== permission check: edit Role test role(10096)
  [4;36;1mSQL (0.002101)[0m   [0;1mselect 'x' from roles where id = 10096 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001339)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:08', NULL, NULL, 10096, 10155, NULL, 0, '2008-05-12 22:30:08', 'grabbitz', 3)[0m
  [4;36;1mPermission Load (0.002098)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grabbitz PhonyBlog X()
=== permission check: destroy Role test role(10096)
  [4;35;1mRole Destroy (0.001283)[0m   [0m DELETE FROM roles
 WHERE id = 10096
[0m
  [4;36;1mRoleAssignment Load (0.001045)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001472)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000435)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10115
[0m
  [4;35;1mRoleAssignment Load (0.001635)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000603)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002741)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001472)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mUser Load (0.000796)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001435)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000631)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001399)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001071)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002684)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001301)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10097, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001387)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10097)
  [4;35;1mSQL (0.002005)[0m   [0mselect 'x' from roles where id = 10097 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001238)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10097, 10116, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001023)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002493)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000816)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mFirm Load (0.001400)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: change_name PhonyBlog X()
=== permission check: edit Role test role(10097)
  [4;35;1mSQL (0.001408)[0m   [0mselect 'x' from roles where id = 10097 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000675)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:08', NULL, NULL, 10097, 10156, NULL, 0, '2008-05-12 22:30:08', 'change_name', 3)[0m
  [4;35;1mPermission Load (0.002647)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_name PhonyBlog X()
=== permission check: change_name PhonyBlog X()
  [4;36;1mPhonyBlog Create (0.001299)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('FunkyBlog', '2008-05-12 22:30:08', 10013, 3, 3, '2008-05-12 22:30:08')[0m
=== permission check: destroy Role test role(10097)
  [4;35;1mRole Destroy (0.000484)[0m   [0m DELETE FROM roles
 WHERE id = 10097
[0m
  [4;36;1mRoleAssignment Load (0.001706)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.048255)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001133)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10116
[0m
  [4;35;1mRoleAssignment Load (0.001047)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001445)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002107)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001414)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001103)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000566)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10098, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002075)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10098)
  [4;36;1mSQL (0.001343)[0m   [0;1mselect 'x' from roles where id = 10098 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000565)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10098, 10117, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001697)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001940)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001511)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grubbitz PhonyBlog FunkyBlog(10013)
=== permission check: edit Role test role(10098)
  [4;35;1mSQL (0.001437)[0m   [0mselect 'x' from roles where id = 10098 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000693)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:08', 10013, 'FunkyBlog', 10098, 10157, NULL, 0, '2008-05-12 22:30:08', 'grubbitz', NULL)[0m
  [4;35;1mPermission Load (0.002692)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grubbitz PhonyBlog FunkyBlog(10013)
=== permission check: destroy Role test role(10098)
  [4;36;1mRole Destroy (0.000607)[0m   [0;1m DELETE FROM roles
 WHERE id = 10098
[0m
  [4;35;1mRoleAssignment Load (0.001718)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000821)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001110)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10117
[0m
  [4;36;1mRoleAssignment Load (0.000991)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001274)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001974)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001400)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001086)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000571)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10099, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002080)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10099)
  [4;35;1mSQL (0.001348)[0m   [0mselect 'x' from roles where id = 10099 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000566)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10099, 10118, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001701)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001942)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001511)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grabbitz PhonyBlog FunkyBlog(10013)
=== permission check: edit Role test role(10099)
  [4;36;1mSQL (0.001435)[0m   [0;1mselect 'x' from roles where id = 10099 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000676)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:08', 10013, 'FunkyBlog', 10099, 10158, NULL, 0, '2008-05-12 22:30:08', 'grabbitz', NULL)[0m
  [4;36;1mPermission Load (0.002776)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grabbitz PhonyBlog FunkyBlog(10013)
=== permission check: grabbitz PhonyBlog FunkyBlog(10013)
=== permission check: destroy Role test role(10099)
  [4;35;1mRole Destroy (0.000626)[0m   [0m DELETE FROM roles
 WHERE id = 10099
[0m
  [4;36;1mRoleAssignment Load (0.001729)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000829)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001107)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10118
[0m
  [4;35;1mRoleAssignment Load (0.000990)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001277)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002087)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001429)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001077)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000580)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10100, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002092)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10100)
  [4;36;1mSQL (0.001344)[0m   [0;1mselect 'x' from roles where id = 10100 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000569)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10100, 10119, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001690)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002037)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001534)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grubbitz PhonyBlog FunkyBlog(10013)
=== permission check: edit Role test role(10100)
  [4;35;1mSQL (0.001447)[0m   [0mselect 'x' from roles where id = 10100 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000677)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:30:08', 10013, 'FunkyBlog', 10100, 10159, NULL, 0, '2008-05-12 22:30:08', 'grubbitz', NULL)[0m
  [4;35;1mPermission Load (0.002870)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grubbitz PhonyBlog FunkyBlog(10013)
=== permission check: destroy Role test role(10100)
  [4;36;1mRole Destroy (0.000636)[0m   [0;1m DELETE FROM roles
 WHERE id = 10100
[0m
  [4;35;1mRoleAssignment Load (0.001726)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000822)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001111)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10119
[0m
  [4;36;1mRoleAssignment Load (0.000978)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001275)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002200)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyNeverPermits Load (0.008106)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.000929)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001437)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000630)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001400)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001079)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002667)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001341)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10101, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001409)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10101)
  [4;36;1mSQL (0.002019)[0m   [0;1mselect 'x' from roles where id = 10101 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001277)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10101, 10120, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001051)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002525)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10101)
  [4;36;1mSQL (0.001462)[0m   [0;1mselect 'x' from roles where id = 10101 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000703)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyNeverPermits', 0, 0, '2008-05-12 22:30:08', NULL, NULL, 10101, 10160, NULL, 0, '2008-05-12 22:30:08', 'any', NULL)[0m
  [4;36;1mPermission Load (0.002621)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyNeverPermits Load (0.006489)[0m   [0mSELECT * FROM blogs WHERE (2 + 2 = 5) [0m
=== FAILED permission check: forbidden_operation PhonyNeverPermits mertz family blog(1)
=== permission check: destroy Role test role(10101)
  [4;36;1mRole Destroy (0.001280)[0m   [0;1m DELETE FROM roles
 WHERE id = 10101
[0m
  [4;35;1mRoleAssignment Load (0.001067)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001480)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000435)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10120
[0m
  [4;36;1mRoleAssignment Load (0.001652)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000601)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002532)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000889)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mRole Load (0.001539)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mPermission Load (0.001999)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: assign Role twiddler(3)
  [4;36;1mSQL (0.002211)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mUser Load (0.000842)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
=== permission check: administer User ricky(4)
  [4;36;1mSQL (0.001947)[0m   [0;1mselect 'x' from users where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001321)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 3, 10121, 4, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;36;1mRoleAssignment Update (0.000567)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:30:08', default_firm_id = NULL, role_id = 3, user_id = 4, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:30:08' WHERE id = 10121[0m
  [4;35;1mRole Load (0.001560)[0m   [0mSELECT * FROM roles WHERE (roles.id = 2) [0m
=== permission check: assign Role admin(2)
=== FAILED permission check: forbidden_operation RoleAssignment X(10121)
  [4;36;1mUser Load (0.000828)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
=== permission check: administer User ricky(4)
=== permission check: administer User lucy(3)
=== FAILED permission check: forbidden_operation RoleAssignment X(10121)
=== FAILED permission check: forbidden_operation RoleAssignment X(10121)
=== FAILED permission check: forbidden_operation RoleAssignment X(10121)
  [4;35;1mUser Load (0.001480)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mUser Load (0.000797)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001432)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000630)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001390)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001066)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002662)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001334)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10102, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001407)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10102)
  [4;36;1mSQL (0.002008)[0m   [0;1mselect 'x' from roles where id = 10102 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001241)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10102, 10122, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001023)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002502)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000834)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: administer User lucy(3)
=== permission check: edit Role test role(10102)
  [4;35;1mSQL (0.002104)[0m   [0mselect 'x' from roles where id = 10102 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001353)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('User', 0, 0, '2008-05-12 22:30:08', 3, 'lucy', 10102, 10161, NULL, 0, '2008-05-12 22:30:08', 'administer', NULL)[0m
  [4;35;1mPermission Load (0.002009)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: administer User lucy(3)
  [4;36;1mSQL (0.011378)[0m   [0;1mselect 'x' from users where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 5)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10102)
  [4;35;1mRole Destroy (0.000633)[0m   [0m DELETE FROM roles
 WHERE id = 10102
[0m
  [4;36;1mRoleAssignment Load (0.001722)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000805)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001108)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10122
[0m
  [4;35;1mRoleAssignment Load (0.000983)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001274)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001976)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mRole Load (0.001625)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mSQL (0.000648)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001738)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001232)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10103, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001384)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10103)
  [4;35;1mSQL (0.002006)[0m   [0mselect 'x' from roles where id = 10103 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001232)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10103, 10123, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001015)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002590)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000840)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: assign Role twiddler(3)
=== permission check: edit Role test role(10103)
  [4;36;1mSQL (0.002103)[0m   [0;1mselect 'x' from roles where id = 10103 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001332)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:30:08', 3, 'twiddler', 10103, 10162, NULL, 0, '2008-05-12 22:30:08', 'assign', NULL)[0m
  [4;36;1mPermission Load (0.002089)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: assign Role twiddler(3)
  [4;35;1mSQL (0.010925)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10103)
  [4;36;1mRole Destroy (0.000628)[0m   [0;1m DELETE FROM roles
 WHERE id = 10103
[0m
  [4;35;1mRoleAssignment Load (0.001716)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000810)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001105)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10123
[0m
  [4;36;1mRoleAssignment Load (0.000969)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001268)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002082)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRoleAssignment Create (0.000626)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 3, 10124, 3, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;36;1mFirm Load (0.001452)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mRole Load (0.013519)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name IS NULL AND roles.owner_firm_id IS NULL) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.022194)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name IS NULL AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000892)[0m   [0mSELECT * FROM users WHERE (users.id = 2) [0m
  [4;36;1mRole Load (0.001667)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name IS NULL AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.000961)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name IS NULL AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.007947)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = '' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.007322)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'x' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.007994)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'ab' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.007343)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'admin' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.012264)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.007401)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'twiddler' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.008023)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.001144)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001491)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000771)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001292)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000718)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001720)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002003)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000668)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:30:08', 10104, 2, 5, '2008-05-12 22:30:08')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002095)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10104)
  [4;36;1mSQL (0.001364)[0m   [0;1mselect 'x' from roles where id = 10104 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000580)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:30:08', 10104, 10125, 5, NULL, '2008-05-12 22:30:08', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001684)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001833)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001504)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mRole Load (0.001108)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== FAILED permission check: create Role xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx()
=== permission check: edit Role test role(10104)
  [4;36;1mSQL (0.002111)[0m   [0;1mselect 'x' from roles where id = 10104 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001353)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:30:08', NULL, NULL, 10104, 10163, 4, 0, '2008-05-12 22:30:08', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002000)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRole Load (0.001860)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx()
  [4;36;1mRole Create (0.004118)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx', '2008-05-12 22:30:08', 10105, 4, 2, '2008-05-12 22:30:08')[0m
=== permission check: destroy Role test role(10104)
  [4;35;1mRole Destroy (0.000588)[0m   [0m DELETE FROM roles
 WHERE id = 10104
[0m
  [4;36;1mRoleAssignment Load (0.001752)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000807)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001110)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10125
[0m
  [4;35;1mRoleAssignment Load (0.000972)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001267)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001951)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.073608)[0m   [0;1mDROP TABLE blog_entries[0m
  [4;35;1mSQL (0.010744)[0m   [0mDROP SEQUENCE blog_entries_seq[0m
  [4;36;1mSQL (0.031974)[0m   [0;1mCREATE TABLE blog_entries (id NUMBER(38) NOT NULL PRIMARY KEY, blog_id NUMBER(38) NOT NULL, entry_txt CLOB NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;35;1mSQL (0.004230)[0m   [0mCREATE SEQUENCE blog_entries_seq START WITH 10000[0m
  [4;36;1mSQL (0.011717)[0m   [0;1mCREATE INDEX blog_entries_by_firm ON blog_entries (owner_firm_id)[0m
  [4;35;1mSQL (0.008185)[0m   [0mCREATE INDEX blog_entries_by_owner ON blog_entries (owner_id)[0m
  [4;36;1mSQL (0.083609)[0m   [0;1mDROP TABLE blogs[0m
  [4;35;1mSQL (0.012691)[0m   [0mDROP SEQUENCE blogs_seq[0m
  [4;36;1mSQL (0.025369)[0m   [0;1mCREATE TABLE blogs (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;35;1mSQL (0.004153)[0m   [0mCREATE SEQUENCE blogs_seq START WITH 10000[0m
  [4;36;1mSQL (0.016104)[0m   [0;1mCREATE INDEX blogs_by_firm ON blogs (owner_firm_id)[0m
  [4;35;1mSQL (0.018447)[0m   [0mCREATE INDEX blogs_by_owner ON blogs (owner_id)[0m
  [4;36;1mSQL (0.023768)[0m   [0;1mCREATE UNIQUE INDEX ix_blogs_by_name_owner_firm ON blogs (name, owner_firm_id)[0m
  [4;35;1mSQL (0.074879)[0m   [0mDROP TABLE entry_comments[0m
  [4;36;1mSQL (0.010562)[0m   [0;1mDROP SEQUENCE entry_comments_seq[0m
  [4;35;1mSQL (0.034239)[0m   [0mCREATE TABLE entry_comments (id NUMBER(38) NOT NULL PRIMARY KEY, blog_entry_id NUMBER(38) DEFAULT NULL, comment_txt CLOB NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;36;1mSQL (0.004850)[0m   [0;1mCREATE SEQUENCE entry_comments_seq START WITH 10000[0m
  [4;35;1mSQL (0.007066)[0m   [0mCREATE INDEX entry_comments_by_firm ON entry_comments (owner_firm_id)[0m
  [4;36;1mSQL (0.017901)[0m   [0;1mCREATE INDEX entry_comments_by_owner ON entry_comments (owner_id)[0m
  [4;35;1mSQL (0.119580)[0m   [0mDROP TABLE firms[0m
  [4;36;1mSQL (0.009909)[0m   [0;1mDROP SEQUENCE firms_seq[0m
  [4;35;1mSQL (0.021000)[0m   [0mCREATE TABLE firms (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;36;1mSQL (0.005003)[0m   [0;1mCREATE SEQUENCE firms_seq START WITH 10000[0m
  [4;35;1mSQL (0.054133)[0m   [0mDROP TABLE pcheck_log_entries[0m
  [4;36;1mSQL (0.010122)[0m   [0;1mDROP SEQUENCE pcheck_log_entries_seq[0m
  [4;35;1mSQL (0.039891)[0m   [0mCREATE TABLE pcheck_log_entries (id NUMBER(38) NOT NULL PRIMARY KEY, request_log_entry_id NUMBER(38) NOT NULL, success NUMBER(1) NOT NULL, model_class VARCHAR2(100) NOT NULL, model_id NUMBER(38) DEFAULT NULL, privilege VARCHAR2(40) NOT NULL, user_id NUMBER(38) NOT NULL, user_name VARCHAR2(100) NOT NULL, created_at DATE DEFAULT NULL, updated_at DATE DEFAULT NULL) [0m
  [4;36;1mSQL (0.005075)[0m   [0;1mCREATE SEQUENCE pcheck_log_entries_seq START WITH 10000[0m
  [4;35;1mSQL (0.069595)[0m   [0mDROP TABLE permissions[0m
  [4;36;1mSQL (0.010303)[0m   [0;1mDROP SEQUENCE permissions_seq[0m
  [4;35;1mSQL (0.031908)[0m   [0mCREATE TABLE permissions (id NUMBER(38) NOT NULL PRIMARY KEY, role_id NUMBER(38) DEFAULT NULL, is_grant NUMBER(1) NOT NULL, has_grant_option NUMBER(1) NOT NULL, class_name VARCHAR2(40) NOT NULL, privilege VARCHAR2(40) NOT NULL, target_owned_by_self NUMBER(1) NOT NULL, target_owner_id NUMBER(38) DEFAULT NULL, target_owner_firm_id NUMBER(38) DEFAULT NULL, target_id NUMBER(38) DEFAULT NULL, target_name VARCHAR2(100) DEFAULT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;36;1mSQL (0.004788)[0m   [0;1mCREATE SEQUENCE permissions_seq START WITH 10000[0m
  [4;35;1mSQL (0.012216)[0m   [0mCREATE INDEX index_permissions_on_role_id ON permissions (role_id)[0m
  [4;36;1mSQL (0.049036)[0m   [0;1mDROP TABLE request_log_entries[0m
  [4;35;1mSQL (0.009446)[0m   [0mDROP SEQUENCE request_log_entries_seq[0m
  [4;36;1mSQL (0.028965)[0m   [0;1mCREATE TABLE request_log_entries (id NUMBER(38) NOT NULL PRIMARY KEY, created_at DATE DEFAULT NULL, updated_at DATE DEFAULT NULL, acting_user_id NUMBER(38) DEFAULT NULL, user_of_record_id NUMBER(38) DEFAULT NULL, acting_user_name VARCHAR2(255) DEFAULT NULL, user_of_record_name VARCHAR2(255) DEFAULT NULL, controller VARCHAR2(100) NOT NULL, action VARCHAR2(100) NOT NULL, http_method VARCHAR2(50) NOT NULL, status VARCHAR2(100) NOT NULL, model_class VARCHAR2(100) DEFAULT NULL, model_id NUMBER(38) DEFAULT NULL, remote_ip VARCHAR2(50) DEFAULT NULL) [0m
  [4;35;1mSQL (0.012311)[0m   [0mCREATE SEQUENCE request_log_entries_seq START WITH 10000[0m
  [4;36;1mSQL (0.042933)[0m   [0;1mDROP TABLE role_assignments[0m
  [4;35;1mSQL (0.009643)[0m   [0mDROP SEQUENCE role_assignments_seq[0m
  [4;36;1mSQL (0.022595)[0m   [0;1mCREATE TABLE role_assignments (id NUMBER(38) NOT NULL PRIMARY KEY, user_id NUMBER(38) NOT NULL, role_id NUMBER(38) NOT NULL, default_user_id NUMBER(38) DEFAULT NULL, default_firm_id NUMBER(38) DEFAULT NULL, invalid_after DATE DEFAULT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;35;1mSQL (0.008161)[0m   [0mCREATE SEQUENCE role_assignments_seq START WITH 10000[0m
  [4;36;1mSQL (0.057964)[0m   [0;1mDROP TABLE roles[0m
  [4;35;1mSQL (0.009865)[0m   [0mDROP SEQUENCE roles_seq[0m
  [4;36;1mSQL (0.024546)[0m   [0;1mCREATE TABLE roles (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL, owner_id NUMBER(38) NOT NULL, owner_firm_id NUMBER(38) NOT NULL) [0m
  [4;35;1mSQL (0.004402)[0m   [0mCREATE SEQUENCE roles_seq START WITH 10000[0m
  [4;36;1mSQL (0.012040)[0m   [0;1mCREATE INDEX roles_by_firm ON roles (owner_firm_id)[0m
  [4;35;1mSQL (0.008419)[0m   [0mCREATE INDEX roles_by_owner ON roles (owner_id)[0m
  [4;36;1mSQL (0.042083)[0m   [0;1mDROP TABLE users[0m
  [4;35;1mSQL (0.009327)[0m   [0mDROP SEQUENCE users_seq[0m
  [4;36;1mSQL (0.024641)[0m   [0;1mCREATE TABLE users (id NUMBER(38) NOT NULL PRIMARY KEY, name VARCHAR2(100) NOT NULL, owner_firm_id NUMBER(38) NOT NULL, created_at DATE NOT NULL, updated_at DATE NOT NULL) [0m
  [4;35;1mSQL (0.004151)[0m   [0mCREATE SEQUENCE users_seq START WITH 10000[0m
  [4;36;1mSQL (0.000000)[0m   [0;1mOCIError: ORA-00955: name is already used by an existing object: CREATE TABLE schema_info (version NUMBER(38))[0m
  [4;35;1mSQL (0.001675)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'SCHEMA_INFO'
 order by column_id
[0m
  [4;36;1mSQL (0.001860)[0m   [0;1mUPDATE schema_info SET version = 1[0m
  [4;35;1mAcPhonyBlog Columns (0.001898)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mUser Load (0.007216)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000904)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.013035)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.006235)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.015292)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.023135)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.005361)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10000, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.017612)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10000)
  [4;36;1mSQL (0.010054)[0m   [0;1mselect 'x' from roles where id = 10000 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.005407)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10000, 10000, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;36;1mRoleAssignment Load (0.007599)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.008781)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.013699)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10000)
  [4;35;1mSQL (0.009907)[0m   [0mselect 'x' from roles where id = 10000 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.005595)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, NULL, 10000, 10000, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.004976)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10000)
  [4;36;1mRole Destroy (0.005804)[0m   [0;1m DELETE FROM roles
 WHERE id = 10000
[0m
  [4;35;1mRoleAssignment Load (0.001893)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000820)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.006124)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10000
[0m
  [4;36;1mRoleAssignment Load (0.001169)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001311)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002032)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001398)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001091)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000592)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10001, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002105)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10001)
  [4;35;1mSQL (0.001380)[0m   [0mselect 'x' from roles where id = 10001 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000590)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10001, 10001, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRole Load (0.006739)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001475)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.002017)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001278)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 4, 10002, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001040)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002707)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.010173)[0m   [0mselect 'x' from roles where id = 10001 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001687)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10001) [0m
  [4;35;1mPermission Create (0.006318)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, 'fred the blog', 10001, 10001, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002349)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10001)
  [4;35;1mRole Destroy (0.001377)[0m   [0m DELETE FROM roles
 WHERE id = 10001
[0m
  [4;36;1mRoleAssignment Load (0.001075)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001475)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000451)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10001
[0m
  [4;35;1mUser Load (0.001460)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000431)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10002
[0m
  [4;35;1mRoleAssignment Load (0.001664)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000603)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002785)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000914)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001443)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000629)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001420)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001067)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002727)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001320)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10002, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001405)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10002)
  [4;36;1mSQL (0.001998)[0m   [0;1mselect 'x' from roles where id = 10002 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001251)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10002, 10003, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001026)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002495)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000860)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10002)
  [4;35;1mSQL (0.002108)[0m   [0mselect 'x' from roles where id = 10002 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001385)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, NULL, 10002, 10002, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.001928)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10002)
  [4;36;1mRole Destroy (0.001276)[0m   [0;1m DELETE FROM roles
 WHERE id = 10002
[0m
  [4;35;1mRoleAssignment Load (0.001064)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001481)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000432)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10003
[0m
  [4;36;1mRoleAssignment Load (0.001646)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000604)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002521)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000671)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001722)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001231)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10003, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001369)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10003)
  [4;35;1mSQL (0.002001)[0m   [0mselect 'x' from roles where id = 10003 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001235)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10003, 10004, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRole Load (0.000874)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001976)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001315)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000566)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 4, 10005, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001694)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001927)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.002263)[0m   [0mselect 'x' from roles where id = 10003 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000897)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10003) [0m
  [4;35;1mPermission Create (0.000691)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, 'fred the blog', 10003, 10003, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002764)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10003)
  [4;35;1mRole Destroy (0.000631)[0m   [0m DELETE FROM roles
 WHERE id = 10003
[0m
  [4;36;1mRoleAssignment Load (0.001734)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000805)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001099)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10004
[0m
  [4;35;1mUser Load (0.000795)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001090)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10005
[0m
  [4;35;1mRoleAssignment Load (0.000982)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001270)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001973)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001569)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000780)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001296)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000731)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001745)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002022)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000637)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10004, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002066)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10004)
  [4;36;1mSQL (0.001334)[0m   [0;1mselect 'x' from roles where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000579)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10004, 10006, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001689)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001843)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001505)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10004)
  [4;35;1mSQL (0.001436)[0m   [0mselect 'x' from roles where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000687)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, NULL, 10004, 10004, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002681)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10004)
  [4;36;1mRole Destroy (0.000624)[0m   [0;1m DELETE FROM roles
 WHERE id = 10004
[0m
  [4;35;1mRoleAssignment Load (0.001815)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000813)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001103)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10006
[0m
  [4;36;1mRoleAssignment Load (0.000991)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001279)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001958)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001373)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001058)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000557)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10005, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002057)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10005)
  [4;35;1mSQL (0.001333)[0m   [0mselect 'x' from roles where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000602)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10005, 10007, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRole Load (0.001532)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001301)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.002038)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001236)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 4, 10008, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001024)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002692)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001608)[0m   [0mselect 'x' from roles where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001577)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10005) [0m
  [4;35;1mPermission Create (0.001335)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, 'fred the blog', 10005, 10005, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002193)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10005)
  [4;35;1mRole Destroy (0.001306)[0m   [0m DELETE FROM roles
 WHERE id = 10005
[0m
  [4;36;1mRoleAssignment Load (0.001061)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001480)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000438)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10007
[0m
  [4;35;1mUser Load (0.001451)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000419)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10008
[0m
  [4;35;1mRoleAssignment Load (0.001650)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000611)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002747)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000927)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001449)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000633)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001396)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001068)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002708)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001319)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10006, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001399)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10006)
  [4;36;1mSQL (0.002008)[0m   [0;1mselect 'x' from roles where id = 10006 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001251)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10006, 10009, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001027)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002524)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001643)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10006)
  [4;35;1mSQL (0.002192)[0m   [0mselect 'x' from roles where id = 10006 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001360)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, NULL, 10006, 10006, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.001925)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10006)
  [4;36;1mRole Destroy (0.001272)[0m   [0;1m DELETE FROM roles
 WHERE id = 10006
[0m
  [4;35;1mRoleAssignment Load (0.001060)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001489)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000444)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10009
[0m
  [4;36;1mRoleAssignment Load (0.001656)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000613)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002525)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000678)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001740)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001239)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10007, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001391)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10007)
  [4;35;1mSQL (0.002020)[0m   [0mselect 'x' from roles where id = 10007 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001237)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10007, 10010, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRole Load (0.000890)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001994)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001338)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000562)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 4, 10011, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001704)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001941)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.002252)[0m   [0mselect 'x' from roles where id = 10007 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000936)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10007) [0m
  [4;35;1mPermission Create (0.000667)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, 'fred the blog', 10007, 10007, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002797)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10007)
  [4;35;1mRole Destroy (0.000655)[0m   [0m DELETE FROM roles
 WHERE id = 10007
[0m
  [4;36;1mRoleAssignment Load (0.001739)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000812)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001103)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10010
[0m
  [4;35;1mUser Load (0.000789)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001085)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10011
[0m
  [4;35;1mRoleAssignment Load (0.000981)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001276)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001968)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001384)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001060)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000561)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10008, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002068)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10008)
  [4;36;1mSQL (0.001338)[0m   [0;1mselect 'x' from roles where id = 10008 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000579)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10008, 10012, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001978)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001336)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000558)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 4, 10013, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001698)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002050)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.002269)[0m   [0mselect 'x' from roles where id = 10008 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000896)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10008) [0m
  [4;35;1mPermission Create (0.000668)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, 'fred the blog', 10008, 10008, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002866)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10008)
  [4;35;1mRole Destroy (0.000665)[0m   [0m DELETE FROM roles
 WHERE id = 10008
[0m
  [4;36;1mRoleAssignment Load (0.001736)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000819)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001110)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10012
[0m
  [4;35;1mUser Load (0.000788)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001092)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10013
[0m
  [4;35;1mRoleAssignment Load (0.000979)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001278)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002078)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001574)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000776)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001303)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000731)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001736)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002025)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000646)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10009, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002057)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10009)
  [4;36;1mSQL (0.001337)[0m   [0;1mselect 'x' from roles where id = 10009 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000570)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10009, 10014, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001690)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001833)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001500)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10009)
  [4;35;1mSQL (0.001446)[0m   [0mselect 'x' from roles where id = 10009 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000680)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, NULL, 10009, 10009, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002577)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10009)
  [4;36;1mRole Destroy (0.000600)[0m   [0;1m DELETE FROM roles
 WHERE id = 10009
[0m
  [4;35;1mRoleAssignment Load (0.001714)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000808)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001103)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10014
[0m
  [4;36;1mRoleAssignment Load (0.000977)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001272)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001855)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001343)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001055)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000556)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10010, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002034)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10010)
  [4;35;1mSQL (0.001332)[0m   [0mselect 'x' from roles where id = 10010 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000561)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10010, 10015, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRole Load (0.001540)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001308)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001982)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001225)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 4, 10016, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001027)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002609)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001552)[0m   [0mselect 'x' from roles where id = 10010 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001568)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10010) [0m
  [4;35;1mPermission Create (0.001333)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, 'fred the blog', 10010, 10010, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002094)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10010)
  [4;35;1mRole Destroy (0.001301)[0m   [0m DELETE FROM roles
 WHERE id = 10010
[0m
  [4;36;1mRoleAssignment Load (0.001064)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001471)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000428)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10015
[0m
  [4;35;1mUser Load (0.001453)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000414)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10016
[0m
  [4;35;1mRoleAssignment Load (0.001644)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000606)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002626)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000902)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001448)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000632)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001394)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001059)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002679)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001307)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:15', 10011, 2, 5, '2008-05-12 22:31:15')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001383)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10011)
  [4;36;1mSQL (0.001994)[0m   [0;1mselect 'x' from roles where id = 10011 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001241)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:15', 10011, 10017, 5, NULL, '2008-05-12 22:31:15', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001017)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002502)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000830)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10011)
  [4;35;1mSQL (0.002092)[0m   [0mselect 'x' from roles where id = 10011 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001350)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:15', NULL, NULL, 10011, 10011, NULL, 0, '2008-05-12 22:31:15', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002003)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10011)
  [4;36;1mRole Destroy (0.001292)[0m   [0;1m DELETE FROM roles
 WHERE id = 10011
[0m
  [4;35;1mRoleAssignment Load (0.001051)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001480)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000442)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10017
[0m
  [4;36;1mRoleAssignment Load (0.001646)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000606)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002630)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000704)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001722)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001224)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:16', 10012, 2, 5, '2008-05-12 22:31:16')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001382)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10012)
  [4;35;1mSQL (0.001996)[0m   [0mselect 'x' from roles where id = 10012 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001235)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:16', 10012, 10018, 5, NULL, '2008-05-12 22:31:16', NULL)[0m
  [4;35;1mRole Load (0.000883)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001973)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001315)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000569)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:16', 4, 10019, 5, NULL, '2008-05-12 22:31:16', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001690)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002040)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.002274)[0m   [0mselect 'x' from roles where id = 10012 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000909)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10012) [0m
  [4;35;1mPermission Create (0.000672)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:16', NULL, 'fred the blog', 10012, 10012, NULL, 0, '2008-05-12 22:31:16', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002772)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10012)
  [4;35;1mRole Destroy (0.000621)[0m   [0m DELETE FROM roles
 WHERE id = 10012
[0m
  [4;36;1mRoleAssignment Load (0.001725)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000802)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001110)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10018
[0m
  [4;35;1mUser Load (0.000789)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001082)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10019
[0m
  [4;35;1mRoleAssignment Load (0.000972)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001273)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001954)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000822)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001438)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000630)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001385)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001053)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002675)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001304)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:16', 10013, 2, 5, '2008-05-12 22:31:16')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001383)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10013)
  [4;36;1mSQL (0.001999)[0m   [0;1mselect 'x' from roles where id = 10013 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001281)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:16', 10013, 10020, 5, NULL, '2008-05-12 22:31:16', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001049)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002531)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000833)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10013)
  [4;35;1mSQL (0.002102)[0m   [0mselect 'x' from roles where id = 10013 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001360)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:16', NULL, NULL, 10013, 10013, NULL, 0, '2008-05-12 22:31:16', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002011)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10013)
  [4;36;1mRole Destroy (0.001300)[0m   [0;1m DELETE FROM roles
 WHERE id = 10013
[0m
  [4;35;1mRoleAssignment Load (0.001067)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001474)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000436)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10020
[0m
  [4;36;1mRoleAssignment Load (0.001652)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000612)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002627)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000703)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001718)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001228)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:16', 10014, 2, 5, '2008-05-12 22:31:16')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001389)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10014)
  [4;35;1mSQL (0.002004)[0m   [0mselect 'x' from roles where id = 10014 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001239)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:16', 10014, 10021, 5, NULL, '2008-05-12 22:31:16', NULL)[0m
  [4;35;1mRole Load (0.000877)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001977)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001371)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000563)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:16', 4, 10022, 5, NULL, '2008-05-12 22:31:16', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001692)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002024)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.002280)[0m   [0mselect 'x' from roles where id = 10014 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000911)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10014) [0m
  [4;35;1mPermission Create (0.000671)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:16', NULL, 'fred the blog', 10014, 10014, NULL, 0, '2008-05-12 22:31:16', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.002761)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10014)
  [4;35;1mRole Destroy (0.000636)[0m   [0m DELETE FROM roles
 WHERE id = 10014
[0m
  [4;36;1mRoleAssignment Load (0.001731)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000804)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001098)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10021
[0m
  [4;35;1mUser Load (0.000781)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001083)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10022
[0m
  [4;35;1mRoleAssignment Load (0.000974)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001274)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001965)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001566)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000783)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001301)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000728)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001729)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002019)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000639)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:16', 10015, 2, 5, '2008-05-12 22:31:16')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002060)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10015)
  [4;36;1mSQL (0.001325)[0m   [0;1mselect 'x' from roles where id = 10015 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000569)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:16', 10015, 10023, 5, NULL, '2008-05-12 22:31:16', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001688)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001831)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001499)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_guarded AcPhonyBlog X()
=== permission check: edit Role test role(10015)
  [4;35;1mSQL (0.001425)[0m   [0mselect 'x' from roles where id = 10015 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000683)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:16', NULL, NULL, 10015, 10015, NULL, 0, '2008-05-12 22:31:16', 'change_guarded', NULL)[0m
  [4;35;1mPermission Load (0.002583)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog X()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: change_guarded AcPhonyBlog fred the blog()
=== permission check: destroy Role test role(10015)
  [4;36;1mRole Destroy (0.000590)[0m   [0;1m DELETE FROM roles
 WHERE id = 10015
[0m
  [4;35;1mRoleAssignment Load (0.001730)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000810)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001098)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10023
[0m
  [4;36;1mRoleAssignment Load (0.000976)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001276)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001848)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001338)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001051)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000560)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:16', 10016, 2, 5, '2008-05-12 22:31:16')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002046)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10016)
  [4;35;1mSQL (0.001327)[0m   [0mselect 'x' from roles where id = 10016 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000574)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:16', 10016, 10024, 5, NULL, '2008-05-12 22:31:16', NULL)[0m
  [4;35;1mRole Load (0.001546)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001314)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001986)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001225)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:16', 4, 10025, 5, NULL, '2008-05-12 22:31:16', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001022)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002593)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001553)[0m   [0mselect 'x' from roles where id = 10016 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001569)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10016) [0m
  [4;35;1mPermission Create (0.001345)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('AcPhonyBlog', 0, 0, '2008-05-12 22:31:16', NULL, 'fred the blog', 10016, 10016, NULL, 0, '2008-05-12 22:31:16', 'change_guarded', NULL)[0m
  [4;36;1mPermission Load (0.001996)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10016)
  [4;35;1mRole Destroy (0.001292)[0m   [0m DELETE FROM roles
 WHERE id = 10016
[0m
  [4;36;1mRoleAssignment Load (0.001068)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001484)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000434)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10024
[0m
  [4;35;1mUser Load (0.000850)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001089)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10025
[0m
  [4;35;1mRoleAssignment Load (0.000986)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001283)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001867)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.000862)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mBlog Load (0.013568)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id IS NULL) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.020580)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001571)[0m   [0mSELECT * FROM users WHERE (users.id = 2) [0m
  [4;36;1mBlog Load (0.001153)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001794)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.000973)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name IS NULL AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.007411)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = '' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.001098)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'x' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001642)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'ab' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.001009)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'mertz family blog' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.005429)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.001103)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'ricardo family blog' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001677)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Load (0.001010)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Load (0.001692)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND blogs.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Create (0.006073)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx', '2008-05-12 22:31:16', 10000, 4, 2, '2008-05-12 22:31:16')[0m
  [4;35;1mUser Load (0.000914)[0m   [0mSELECT * FROM users WHERE (users.id = 2) [0m
  [4;36;1mFirm Load (0.001433)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mUser Load (0.000802)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;36;1mRole Load (0.001509)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;35;1mSQL (0.010630)[0m   [0mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 4
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 4)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001670)[0m   [0;1mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 4
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 4)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001608)[0m   [0mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;36;1mPermission Load (0.008852)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 4
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: assign Role admin(1)
  [4;35;1mUser Load (0.001585)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;36;1mRole Load (0.000842)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;35;1mPermission Load (0.002701)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 4
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role admin(2)
  [4;36;1mRole Load (0.000972)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 1) [0m
=== FAILED permission check: edit Role admin(1)
  [4;35;1mUser Load (0.001480)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mRole Load (0.000853)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;35;1mPermission Load (0.002650)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role admin(2)
  [4;36;1mSQL (0.001570)[0m   [0;1mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000741)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:17', NULL, NULL, 2, 10017, NULL, 0, '2008-05-12 22:31:17', 'post', NULL)[0m
  [4;36;1mUser Load (0.001494)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;35;1mPermission Load (0.002025)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 4
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role admin(2)
  [4;36;1mSQL (0.010803)[0m   [0;1mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 4
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 4)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mBlog Load (0.006157)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mBlog Load (0.001637)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mRole Load (0.001548)[0m   [0mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;36;1mUser Load (0.000808)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001443)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000668)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001387)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001069)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002676)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001351)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:17', 10017, 2, 5, '2008-05-12 22:31:17')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001424)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10017)
  [4;36;1mSQL (0.002034)[0m   [0;1mselect 'x' from roles where id = 10017 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001254)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:17', 10017, 10026, 5, NULL, '2008-05-12 22:31:17', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001045)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002536)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000838)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: edit Role admin(1)
=== permission check: edit Role test role(10017)
  [4;35;1mSQL (0.002098)[0m   [0mselect 'x' from roles where id = 10017 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.006418)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:31:17', 1, 'admin', 10017, 10018, NULL, 0, '2008-05-12 22:31:17', 'edit', NULL)[0m
  [4;35;1mPermission Load (0.002159)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role admin(1)
  [4;36;1mSQL (0.002332)[0m   [0;1mselect 'x' from roles where id = 1 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10017)
  [4;35;1mRole Destroy (0.000581)[0m   [0m DELETE FROM roles
 WHERE id = 10017
[0m
  [4;36;1mRoleAssignment Load (0.001729)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000814)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001108)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10026
[0m
  [4;35;1mRoleAssignment Load (0.000994)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001278)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001953)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Create (0.000708)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:17', NULL, NULL, 1, 10019, NULL, 0, '2008-05-12 22:31:17', 'any', NULL)[0m
  [4;35;1mFirm Load (0.001431)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mUser Load (0.000813)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001442)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000642)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001720)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002011)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000629)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:17', 10018, 2, 5, '2008-05-12 22:31:17')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002067)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10018)
  [4;35;1mSQL (0.001346)[0m   [0mselect 'x' from roles where id = 10018 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000576)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:17', 10018, 10027, 5, NULL, '2008-05-12 22:31:17', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001692)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001834)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10018)
  [4;35;1mSQL (0.002120)[0m   [0mselect 'x' from roles where id = 10018 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.006346)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:17', NULL, NULL, 10018, 10020, 2, 0, '2008-05-12 22:31:17', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002152)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.007569)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.owner_firm_id = 2) [0m
  [4;35;1mBlog Load (0.017154)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.014332)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.owner_firm_id = 2) AND (name like 'ric%') [0m
  [4;35;1mBlog Load (0.024465)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
 and name like 'ric%') [0m
  [4;36;1mBlog Load (0.007481)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.owner_firm_id = 2) AND (name like 'ricky%') [0m
  [4;35;1mBlog Load (0.010946)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
 and name like 'ricky%') [0m
=== permission check: destroy Role test role(10018)
  [4;36;1mRole Destroy (0.001297)[0m   [0;1m DELETE FROM roles
 WHERE id = 10018
[0m
  [4;35;1mRoleAssignment Load (0.001054)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001479)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000440)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10027
[0m
  [4;36;1mRoleAssignment Load (0.001653)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000617)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002644)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000877)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mUser Load (0.001444)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mUser Load (0.000768)[0m   [0mSELECT * FROM users WHERE (users.id = 1) [0m
  [4;36;1mRole Load (0.001515)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mPermission Load (0.002034)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.002215)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.006420)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:17', NULL, NULL, 3, 10021, NULL, 0, '2008-05-12 22:31:17', 'any', 3)[0m
  [4;36;1mPermission Update (0.006257)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10021[0m
  [4;35;1mPermission Update (0.001387)[0m   [0mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10021[0m
  [4;36;1mPermission Update (0.000596)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10021[0m
  [4;35;1mPermission Update (0.001246)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'blurfl', created_at = '2008-05-12 22:31:17' WHERE id = 10021[0m
  [4;36;1mPermission Update (0.000584)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10021[0m
  [4;35;1mPermission Update (0.001232)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10021[0m
  [4;36;1mPermission Update (0.000583)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10021[0m
  [4;35;1mFirm Load (0.001473)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mFirm Load (0.000719)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
=== permission check: edit Role twiddler(3)
  [4;35;1mSQL (0.002170)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001366)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:17', NULL, NULL, 3, 10022, 2, 0, '2008-05-12 22:31:17', 'any', NULL)[0m
  [4;35;1mPermission Update (0.006291)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10022[0m
  [4;36;1mPermission Update (0.001381)[0m   [0;1mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10022[0m
  [4;35;1mPermission Update (0.000597)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10022[0m
  [4;36;1mPermission Update (0.001243)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:31:17' WHERE id = 10022[0m
  [4;35;1mPermission Update (0.000583)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10022[0m
  [4;36;1mPermission Update (0.001234)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10022[0m
  [4;35;1mPermission Update (0.000576)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = 2, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10022[0m
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.002215)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001382)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:17', NULL, NULL, 3, 10023, NULL, 0, '2008-05-12 22:31:17', 'any', NULL)[0m
  [4;36;1mPermission Update (0.006298)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10023[0m
  [4;35;1mPermission Update (0.001382)[0m   [0mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10023[0m
  [4;36;1mPermission Update (0.000593)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10023[0m
  [4;35;1mPermission Update (0.001244)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:31:17' WHERE id = 10023[0m
  [4;36;1mPermission Update (0.000582)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10023[0m
  [4;35;1mPermission Update (0.001246)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10023[0m
  [4;36;1mPermission Update (0.000579)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10023[0m
  [4;35;1mBlog Load (0.001594)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.001508)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000707)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:17', 1, 'mertz family blog', 3, 10024, NULL, 0, '2008-05-12 22:31:17', 'any', NULL)[0m
  [4;36;1mPermission Update (0.006972)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10024[0m
  [4;35;1mPermission Update (0.000727)[0m   [0mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10024[0m
  [4;36;1mPermission Update (0.001280)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10024[0m
  [4;35;1mPermission Update (0.000585)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:31:17' WHERE id = 10024[0m
  [4;36;1mPermission Update (0.001264)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10024[0m
  [4;35;1mPermission Update (0.000572)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10024[0m
  [4;36;1mPermission Update (0.001257)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:17', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:17' WHERE id = 10024[0m
  [4;35;1mBlog Load (0.020619)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'Ricardo blog' AND blogs.owner_firm_id IS NULL) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.000810)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001444)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000658)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001383)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001054)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002669)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001316)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:18', 10019, 2, 5, '2008-05-12 22:31:18')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001404)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10019)
  [4;36;1mSQL (0.002033)[0m   [0;1mselect 'x' from roles where id = 10019 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001255)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:18', 10019, 10028, 5, NULL, '2008-05-12 22:31:18', NULL)[0m
  [4;36;1mRole Load (0.000868)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001979)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001320)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000558)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:18', 4, 10029, 5, NULL, '2008-05-12 22:31:18', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001704)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001949)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001622)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
=== FAILED permission check: grok Blog mertz family blog(1)
=== FAILED permission check: grok Blog mertz family blog(1)
  [4;35;1mSQL (0.001427)[0m   [0mselect 'x' from roles where id = 10019 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001578)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10019) [0m
  [4;35;1mPermission Create (0.001336)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:18', 1, 'mertz family blog', 10019, 10025, NULL, 0, '2008-05-12 22:31:18', 'grok', NULL)[0m
  [4;36;1mPermission Load (0.002094)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grok Blog mertz family blog(1)
=== permission check: destroy Role test role(10019)
  [4;35;1mRole Destroy (0.001281)[0m   [0m DELETE FROM roles
 WHERE id = 10019
[0m
  [4;36;1mRoleAssignment Load (0.001059)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001474)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000439)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10028
[0m
  [4;35;1mUser Load (0.001459)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000458)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10029
[0m
  [4;35;1mRoleAssignment Load (0.001646)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000611)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002630)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000877)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001449)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000630)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001380)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001047)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002671)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001296)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:18', 10020, 2, 5, '2008-05-12 22:31:18')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001426)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10020)
  [4;36;1mSQL (0.002042)[0m   [0;1mselect 'x' from roles where id = 10020 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001259)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:18', 10020, 10030, 5, NULL, '2008-05-12 22:31:18', NULL)[0m
  [4;36;1mRole Load (0.000880)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001977)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001323)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000564)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:18', 4, 10031, 5, NULL, '2008-05-12 22:31:18', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001694)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001932)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002156)[0m   [0;1mselect 'x' from roles where id = 10020 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000885)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10020) [0m
  [4;36;1mPermission Create (0.000668)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:18', NULL, NULL, 10020, 10026, NULL, 0, '2008-05-12 22:31:18', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002755)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001529)[0m   [0;1mselect 'x' from roles where id = 10020 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001553)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10020) [0m
  [4;36;1mPermission Create (0.001320)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:18', NULL, NULL, 10020, 10027, NULL, 0, '2008-05-12 22:31:18', 'any', NULL)[0m
  [4;35;1mSQL (0.018915)[0m   [0mSELECT count(*) AS count_all FROM permissions WHERE (permissions.role_id = 10020) [0m
  [4;36;1mPermission Load (0.002868)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10020)
  [4;35;1mRole Destroy (0.000617)[0m   [0m DELETE FROM roles
 WHERE id = 10020
[0m
  [4;36;1mRoleAssignment Load (0.001726)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000806)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001136)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10030
[0m
  [4;35;1mUser Load (0.000790)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001083)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10031
[0m
  [4;35;1mRoleAssignment Load (0.000980)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001275)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001966)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001541)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;35;1mPermission Load (0.002008)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 4
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001562)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mPermission Load (0.001929)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001464)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mUser Load (0.000788)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001433)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000618)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001737)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.001982)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000637)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:18', 10021, 2, 5, '2008-05-12 22:31:18')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002060)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10021)
  [4;36;1mSQL (0.001336)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000574)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:18', 10021, 10032, 5, NULL, '2008-05-12 22:31:18', NULL)[0m
  [4;36;1mRole Load (0.001538)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001290)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001992)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001225)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:18', 4, 10033, 5, NULL, '2008-05-12 22:31:18', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001024)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002593)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000873)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mUser Load (0.001431)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;36;1mFirm Load (0.000707)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mSQL (0.004612)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mBlog Load (0.001122)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 5' AND blogs.owner_firm_id = 3) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Create (0.000600)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 5', '2008-05-12 22:31:18', 10001, 3, 5, '2008-05-12 22:31:18')[0m
  [4;36;1mSQL (0.001223)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mBlog Load (0.001005)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 6' AND blogs.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Create (0.000507)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 6', '2008-05-12 22:31:18', 10002, 2, 5, '2008-05-12 22:31:18')[0m
  [4;35;1mSQL (0.001209)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mBlog Load (0.001003)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 7' AND blogs.owner_firm_id = 3) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Create (0.000483)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 7', '2008-05-12 22:31:18', 10003, 3, 3, '2008-05-12 22:31:18')[0m
  [4;36;1mSQL (0.001190)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mBlog Load (0.000979)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 8' AND blogs.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Create (0.000480)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 8', '2008-05-12 22:31:18', 10004, 2, 3, '2008-05-12 22:31:18')[0m
  [4;35;1mSQL (0.001190)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mBlog Load (0.000986)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 9' AND blogs.owner_firm_id = 3) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mBlog Create (0.000509)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 9', '2008-05-12 22:31:18', 10005, 3, 4, '2008-05-12 22:31:18')[0m
  [4;36;1mSQL (0.001190)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mBlog Load (0.000987)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs WHERE (blogs.name = 'blog 10' AND blogs.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mBlog Create (0.000487)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('blog 10', '2008-05-12 22:31:18', 10006, 2, 4, '2008-05-12 22:31:18')[0m
  [4;35;1mBlog Load (0.001578)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mRole Load (0.000853)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mSQL (0.002164)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000928)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mPermission Create (0.000680)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:18', NULL, NULL, 3, 10028, NULL, 0, '2008-05-12 22:31:18', 'post', 3)[0m
  [4;36;1mSQL (0.002127)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000922)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;36;1mPermission Create (0.000647)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:18', NULL, NULL, 3, 10029, 3, 0, '2008-05-12 22:31:18', 'post', NULL)[0m
  [4;35;1mSQL (0.002230)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.000936)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mPermission Create (0.000645)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:18', NULL, NULL, 3, 10030, NULL, 0, '2008-05-12 22:31:18', 'post', NULL)[0m
  [4;36;1mSQL (0.002143)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000922)[0m   [0mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;36;1mPermission Create (0.000652)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:18', 1, 'mertz family blog', 3, 10031, NULL, 0, '2008-05-12 22:31:18', 'post', NULL)[0m
  [4;35;1mSQL (0.007020)[0m   [0mSELECT count(*) AS count_all FROM permissions WHERE (permissions.role_id = 10021) [0m
  [4;36;1mPermission Load (0.007209)[0m   [0;1mSELECT * FROM permissions WHERE (permissions.role_id = 4) [0m
  [4;35;1mSQL (0.010556)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001501)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000689)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:18', NULL, NULL, 10021, 10032, NULL, 0, '2008-05-12 22:31:18', 'post', 3)[0m
  [4;36;1mPermission Load (0.002783)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000836)[0m   [0mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002474)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002095)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.001472)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mPermission Update (0.000592)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'blurfl', created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002430)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002087)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.001477)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mPermission Update (0.000588)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002402)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002085)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.001464)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mPermission Update (0.000590)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'any', created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.014715)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000956)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001530)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.005891)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002640)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.000607)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002370)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.005909)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.002031)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000837)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001512)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.000558)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002422)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003672)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002852)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.004374)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001413)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mSQL (0.001767)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004311)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002117)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001700)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000708)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002416)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003631)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002762)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.000998)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001357)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mPermission Update (0.000629)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = 3, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.001876)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000827)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001515)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.000539)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002419)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.000550)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002346)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.000538)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.001822)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000805)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001502)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.000535)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002342)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003625)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002768)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.000981)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001356)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mSQL (0.001744)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004284)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002085)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001655)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000664)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002409)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003611)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002759)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.000978)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001334)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.005634)[0m   [0m DELETE FROM permissions
 WHERE id = 10032
[0m
  [4;36;1mPermission Load (0.002919)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001830)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002046)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001357)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:18', NULL, NULL, 10021, 10033, 3, 0, '2008-05-12 22:31:18', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002087)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.001456)[0m   [0mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10033[0m
  [4;36;1mSQL (0.001739)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002736)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000792)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10033[0m
  [4;35;1mPermission Update (0.001251)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:31:18' WHERE id = 10033[0m
  [4;36;1mSQL (0.001726)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002736)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000787)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10033[0m
  [4;35;1mPermission Update (0.001239)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10033[0m
  [4;36;1mSQL (0.001726)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002729)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000781)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10033[0m
  [4;35;1mPermission Update (0.001248)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'any', created_at = '2008-05-12 22:31:18' WHERE id = 10033[0m
  [4;36;1mRoleAssignment Load (0.001193)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001494)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000835)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.001211)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001789)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.001219)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001711)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.001215)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.001147)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001473)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000829)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.001196)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001684)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004357)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002099)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001648)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000685)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mSQL (0.002422)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.003689)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002754)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.000978)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.001334)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001752)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004351)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002086)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001652)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000682)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mPermission Update (0.001574)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 0, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = 3, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10033[0m
  [4;36;1mRoleAssignment Load (0.001206)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001489)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000842)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.001241)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001788)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.001227)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001715)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.001212)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.001161)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001477)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000835)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.001201)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001689)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004370)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002103)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001652)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000695)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mSQL (0.002427)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.003685)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002758)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.000978)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.001353)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001752)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004359)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002093)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001652)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000688)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:18', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001186)[0m   [0m DELETE FROM permissions
 WHERE id = 10033
[0m
  [4;36;1mPermission Load (0.002138)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.002518)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.001372)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000697)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:18', NULL, NULL, 10021, 10034, NULL, 0, '2008-05-12 22:31:18', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002759)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.000802)[0m   [0mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10034[0m
  [4;36;1mSQL (0.002407)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002069)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.001466)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10034[0m
  [4;35;1mPermission Update (0.000586)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:18', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:31:18' WHERE id = 10034[0m
  [4;36;1mSQL (0.002397)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002071)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000820)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10034[0m
  [4;35;1mPermission Update (0.000641)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10034[0m
  [4;36;1mSQL (0.002407)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002075)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.001463)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10034[0m
  [4;35;1mPermission Update (0.000601)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'any', created_at = '2008-05-12 22:31:18' WHERE id = 10034[0m
  [4;36;1mRoleAssignment Load (0.001870)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000845)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001515)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.000553)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002441)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.000573)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002368)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.000559)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.001827)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000822)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001508)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.000541)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002367)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003636)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002787)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.000998)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001383)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mSQL (0.001752)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004312)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002103)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001664)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000697)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002421)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003620)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002760)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001003)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001343)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mPermission Update (0.000625)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 1, target_id = NULL, target_name = NULL, role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:18' WHERE id = 10034[0m
  [4;36;1mRoleAssignment Load (0.001863)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000826)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001511)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.000543)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002416)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.000573)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002841)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.000662)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.001856)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000837)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001519)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.000549)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002380)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003736)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002916)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001013)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001404)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mSQL (0.001783)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.004403)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002217)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001670)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.000730)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002450)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.003724)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002893)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001000)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.001384)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.000511)[0m   [0m DELETE FROM permissions
 WHERE id = 10034
[0m
  [4;36;1mPermission Load (0.002974)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001888)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: edit Role test role(10021)
  [4;36;1mSQL (0.002112)[0m   [0;1mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001424)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', 1, 'mertz family blog', 10021, 10035, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
  [4;36;1mPermission Load (0.002244)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Update (0.001550)[0m   [0mUPDATE permissions SET is_grant = 1, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:19' WHERE id = 10035[0m
  [4;36;1mSQL (0.001793)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002893)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000860)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:19' WHERE id = 10035[0m
  [4;35;1mPermission Update (0.001265)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'blurfl', created_at = '2008-05-12 22:31:19' WHERE id = 10035[0m
  [4;36;1mSQL (0.001783)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002891)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000858)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:19' WHERE id = 10035[0m
  [4;35;1mPermission Update (0.001265)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Role', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:19' WHERE id = 10035[0m
  [4;36;1mSQL (0.001770)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002882)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Update (0.000846)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:19' WHERE id = 10035[0m
  [4;35;1mPermission Update (0.001263)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'any', created_at = '2008-05-12 22:31:19' WHERE id = 10035[0m
  [4;36;1mRoleAssignment Load (0.001215)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001497)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000838)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.001215)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001771)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.001236)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001661)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.001223)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.001155)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001478)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000828)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.001203)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001670)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004332)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002223)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001675)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000743)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mSQL (0.002441)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.003659)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002892)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001012)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.001405)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001759)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004330)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002212)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001676)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000727)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mPermission Update (0.001297)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'Blog', updated_at = '2008-05-12 22:31:19', target_owned_by_self = 0, target_id = 1, target_name = 'mertz family blog', role_id = 10021, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'post', created_at = '2008-05-12 22:31:19' WHERE id = 10035[0m
  [4;36;1mRoleAssignment Load (0.001192)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001489)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000839)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.000754)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.002434)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.001232)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001653)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mRoleAssignment Update (0.001211)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mRoleAssignment Load (0.001152)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 10021)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001471)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000831)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10021) [0m
  [4;35;1mRoleAssignment Update (0.001244)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001686)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004334)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002241)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001676)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000731)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;35;1mSQL (0.002436)[0m   [0mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mBlog Load (0.003661)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mPermission Load (0.002890)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001005)[0m   [0;1mSELECT * FROM blogs [0m
  [4;35;1mRoleAssignment Update (0.001399)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
  [4;36;1mSQL (0.001770)[0m   [0;1mSELECT count(*) AS count_all FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.004333)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mPermission Load (0.002227)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001672)[0m   [0mSELECT * FROM blogs [0m
  [4;36;1mRoleAssignment Update (0.000725)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:19', default_firm_id = NULL, role_id = 10021, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:18' WHERE id = 10032[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001150)[0m   [0m DELETE FROM permissions
 WHERE id = 10035
[0m
  [4;36;1mPermission Load (0.002272)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002304)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001424)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10036, NULL, 0, '2008-05-12 22:31:19', 'post', 3)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001437)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000672)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10037, 3, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002885)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004093)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001639)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000637)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10036
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001095)[0m   [0m DELETE FROM permissions
 WHERE id = 10037
[0m
  [4;36;1mPermission Load (0.002226)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002316)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001391)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10038, NULL, 0, '2008-05-12 22:31:19', 'post', 3)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001409)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000678)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:19', NULL, NULL, 10021, 10039, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002882)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004091)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001634)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000625)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10038
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001093)[0m   [0m DELETE FROM permissions
 WHERE id = 10039
[0m
  [4;36;1mPermission Load (0.002217)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001762)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001409)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10040, NULL, 0, '2008-05-12 22:31:19', 'post', 3)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001517)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000700)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', 1, 'mertz family blog', 10021, 10041, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002910)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004047)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001640)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000658)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10040
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001102)[0m   [0m DELETE FROM permissions
 WHERE id = 10041
[0m
  [4;36;1mPermission Load (0.002228)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002340)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001404)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10042, 3, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001420)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000674)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10043, NULL, 0, '2008-05-12 22:31:19', 'post', 3)[0m
  [4;35;1mPermission Load (0.002895)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004097)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001645)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000644)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10042
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001103)[0m   [0m DELETE FROM permissions
 WHERE id = 10043
[0m
  [4;36;1mPermission Load (0.002232)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002348)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001402)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10044, 3, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001414)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000671)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:19', NULL, NULL, 10021, 10045, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002887)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004080)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001639)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000651)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10044
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001092)[0m   [0m DELETE FROM permissions
 WHERE id = 10045
[0m
  [4;36;1mPermission Load (0.002244)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002313)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001404)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10046, 3, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001418)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000677)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', 1, 'mertz family blog', 10021, 10047, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002889)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004102)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001634)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000628)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10046
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001096)[0m   [0m DELETE FROM permissions
 WHERE id = 10047
[0m
  [4;36;1mPermission Load (0.002221)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002315)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001450)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:19', NULL, NULL, 10021, 10048, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001437)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000683)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10049, NULL, 0, '2008-05-12 22:31:19', 'post', 3)[0m
  [4;35;1mPermission Load (0.002886)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004083)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001636)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000619)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10048
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001093)[0m   [0m DELETE FROM permissions
 WHERE id = 10049
[0m
  [4;36;1mPermission Load (0.002201)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002307)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001391)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:19', NULL, NULL, 10021, 10050, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001409)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000667)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', NULL, NULL, 10021, 10051, 3, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002879)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004081)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001635)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000625)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10050
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001104)[0m   [0m DELETE FROM permissions
 WHERE id = 10051
[0m
  [4;36;1mPermission Load (0.002225)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002315)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001393)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:19', NULL, NULL, 10021, 10052, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001403)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000675)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:19', 1, 'mertz family blog', 10021, 10053, NULL, 0, '2008-05-12 22:31:19', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002875)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004024)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001631)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000612)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10052
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001092)[0m   [0m DELETE FROM permissions
 WHERE id = 10053
[0m
  [4;36;1mPermission Load (0.002208)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002309)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001408)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:20', 1, 'mertz family blog', 10021, 10054, NULL, 0, '2008-05-12 22:31:20', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001410)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000668)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:20', NULL, NULL, 10021, 10055, NULL, 0, '2008-05-12 22:31:20', 'post', 3)[0m
  [4;35;1mPermission Load (0.002892)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004030)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001640)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000637)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10054
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001094)[0m   [0m DELETE FROM permissions
 WHERE id = 10055
[0m
  [4;36;1mPermission Load (0.002222)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002311)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001397)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:20', 1, 'mertz family blog', 10021, 10056, NULL, 0, '2008-05-12 22:31:20', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001402)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000674)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:20', NULL, NULL, 10021, 10057, 3, 0, '2008-05-12 22:31:20', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002898)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004093)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001633)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000634)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10056
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001099)[0m   [0m DELETE FROM permissions
 WHERE id = 10057
[0m
  [4;36;1mPermission Load (0.002225)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.002318)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001399)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:20', 1, 'mertz family blog', 10021, 10058, NULL, 0, '2008-05-12 22:31:20', 'post', NULL)[0m
=== permission check: edit Role test role(10021)
  [4;35;1mSQL (0.001414)[0m   [0mselect 'x' from roles where id = 10021 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000673)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 1, '2008-05-12 22:31:20', NULL, NULL, 10021, 10059, NULL, 0, '2008-05-12 22:31:20', 'post', NULL)[0m
  [4;35;1mPermission Load (0.002881)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.004018)[0m   [0;1mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'post' or p.privilege = 'any')
 and (p.class_name = 'Blog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mBlog Load (0.001637)[0m   [0mSELECT * FROM blogs [0m
=== permission check: edit Role test role(10021)
  [4;36;1mPermission Destroy (0.000631)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10058
[0m
=== permission check: edit Role test role(10021)
  [4;35;1mPermission Destroy (0.001093)[0m   [0m DELETE FROM permissions
 WHERE id = 10059
[0m
  [4;36;1mPermission Load (0.002219)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10021)
  [4;35;1mRole Destroy (0.001346)[0m   [0m DELETE FROM roles
 WHERE id = 10021
[0m
  [4;36;1mRoleAssignment Load (0.001084)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001486)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000447)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10032
[0m
  [4;35;1mUser Load (0.001460)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000425)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10033
[0m
  [4;35;1mRoleAssignment Load (0.001650)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000622)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002793)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001506)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000782)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001344)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000728)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001817)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002181)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000738)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:20', 10022, 2, 5, '2008-05-12 22:31:20')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002204)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10022)
  [4;36;1mSQL (0.001426)[0m   [0;1mselect 'x' from roles where id = 10022 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000622)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 10022, 10034, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001706)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001954)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.018525)[0m   [0;1mSELECT count(*) AS count_all FROM users WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'frammis' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 5)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;35;1mSQL (0.001634)[0m   [0mselect 'x' from roles where id = 10022 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001609)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10022) [0m
  [4;35;1mPermission Create (0.001383)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('User', 0, 1, '2008-05-12 22:31:20', NULL, NULL, 10022, 10060, NULL, 0, '2008-05-12 22:31:20', 'any', NULL)[0m
  [4;36;1mPermission Load (0.002228)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.002257)[0m   [0mSELECT count(*) AS count_all FROM users WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'frammis' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 5)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
  [4;36;1mUser Load (0.012971)[0m   [0;1mSELECT * FROM users WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'frammis' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 5)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: destroy Role test role(10022)
  [4;35;1mRole Destroy (0.001361)[0m   [0m DELETE FROM roles
 WHERE id = 10022
[0m
  [4;36;1mRoleAssignment Load (0.001072)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001493)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000450)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10034
[0m
  [4;35;1mRoleAssignment Load (0.001652)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000623)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002793)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.001009)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mUser Load (0.001448)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mRole Load (0.000866)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mUser Load (0.001455)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000765)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001325)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000724)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001757)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002172)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000719)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:20', 10023, 2, 5, '2008-05-12 22:31:20')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002207)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10023)
  [4;35;1mSQL (0.001426)[0m   [0mselect 'x' from roles where id = 10023 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000631)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 10023, 10035, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001719)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001958)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001552)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10023)
  [4;36;1mSQL (0.001506)[0m   [0;1mselect 'x' from roles where id = 10023 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000729)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:31:20', 3, 'twiddler', 10023, 10061, NULL, 0, '2008-05-12 22:31:20', 'edit', NULL)[0m
  [4;36;1mPermission Load (0.002823)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role twiddler(3)
  [4;35;1mSQL (0.001907)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10023)
  [4;36;1mRole Destroy (0.001319)[0m   [0;1m DELETE FROM roles
 WHERE id = 10023
[0m
  [4;35;1mRoleAssignment Load (0.001071)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001479)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000438)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10035
[0m
  [4;36;1mRoleAssignment Load (0.001654)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000617)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002770)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000762)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001744)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001263)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:20', 10024, 2, 5, '2008-05-12 22:31:20')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001491)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10024)
  [4;35;1mSQL (0.002058)[0m   [0mselect 'x' from roles where id = 10024 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001264)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 10024, 10036, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001028)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002741)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000889)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mRole Load (0.001569)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
=== permission check: edit Role test role(10024)
  [4;35;1mSQL (0.001540)[0m   [0mselect 'x' from roles where id = 10024 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000720)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 1, 0, '2008-05-12 22:31:20', NULL, NULL, 10024, 10062, NULL, 0, '2008-05-12 22:31:20', 'post', 3)[0m
  [4;35;1mPermission Load (0.002945)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPermission Create (0.001411)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:20', NULL, NULL, 3, 10063, NULL, 0, '2008-05-12 22:31:20', 'post', 3)[0m
=== permission check: destroy Role test role(10024)
  [4;35;1mRole Destroy (0.000502)[0m   [0m DELETE FROM roles
 WHERE id = 10024
[0m
  [4;36;1mRoleAssignment Load (0.001723)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000817)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001098)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10036
[0m
  [4;35;1mRoleAssignment Load (0.000979)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001283)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002263)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001465)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001068)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000601)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:20', 10025, 2, 5, '2008-05-12 22:31:20')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002166)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10025)
  [4;36;1mSQL (0.001391)[0m   [0;1mselect 'x' from roles where id = 10025 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000593)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 10025, 10037, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001695)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002184)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001573)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10025)
  [4;35;1mSQL (0.001523)[0m   [0mselect 'x' from roles where id = 10025 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000708)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:31:20', 3, 'twiddler', 10025, 10064, NULL, 0, '2008-05-12 22:31:20', 'edit', NULL)[0m
  [4;35;1mPermission Load (0.002929)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role twiddler(3)
  [4;36;1mPermission Destroy (0.000684)[0m   [0;1m DELETE FROM permissions
 WHERE id = 10063
[0m
=== permission check: destroy Role test role(10025)
  [4;35;1mRole Destroy (0.001125)[0m   [0m DELETE FROM roles
 WHERE id = 10025
[0m
  [4;36;1mRoleAssignment Load (0.001063)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001481)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000436)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10037
[0m
  [4;35;1mRoleAssignment Load (0.001644)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000613)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002919)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mRole Load (0.001042)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mPermission Load (0.011585)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 3
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000999)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.001507)[0m   [0mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;36;1mPermission Load (0.008814)[0m   [0;1mSELECT * FROM permissions WHERE (permissions.role_id = 1) [0m
  [4;35;1mRole Load (0.001645)[0m   [0mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;36;1mPermission Load (0.008644)[0m   [0;1mSELECT * FROM permissions WHERE (permissions.role_id = 2) [0m
  [4;35;1mPermission Load (0.002770)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000830)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mUser Load (0.001473)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001444)[0m   [0;1mselect 'x' from roles where id = 1 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001980)[0m   [0mselect 'x' from roles where id = 1 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001272)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001913)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mUser Load (0.000814)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.001499)[0m   [0mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;36;1mRoleAssignment Create (0.001358)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 1, 10038, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;35;1mPermission Load (0.002056)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001541)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mSQL (0.001544)[0m   [0mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.002157)[0m   [0;1mselect 'x' from roles where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001352)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001918)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mUser Load (0.000825)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.001503)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 2) [0m
  [4;35;1mRoleAssignment Create (0.001270)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 2, 10039, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;36;1mPermission Load (0.002079)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001546)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mRoleAssignment Load (0.009259)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 1)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.001622)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mRole Load (0.000843)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;35;1mRoleAssignment Update (0.001300)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:20', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = '2008-05-13 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:20' WHERE id = 10038[0m
  [4;36;1mPermission Load (0.002162)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001538)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mRoleAssignment Update (0.000612)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:20', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = '2008-05-14 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:20' WHERE id = 10038[0m
  [4;35;1mPermission Load (0.002782)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000859)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mRoleAssignment Update (0.001293)[0m   [0mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:20', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:20' WHERE id = 10038[0m
  [4;36;1mPermission Load (0.002126)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001526)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mRoleAssignment Update (0.000596)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:20', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:20' WHERE id = 10038[0m
  [4;35;1mRoleAssignment Load (0.001891)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM role_assignments WHERE (role_assignments.user_id = 5 AND (role_id = 1)) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.000825)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mRole Load (0.001503)[0m   [0mSELECT * FROM roles WHERE (roles.id = 1) [0m
  [4;36;1mRoleAssignment Update (0.000542)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:20', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = '2008-05-12 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:20' WHERE id = 10038[0m
  [4;35;1mSQL (0.001396)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mSQL (0.000596)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002741)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mRoleAssignment Update (0.000716)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:20', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = '2008-05-11 22:31:14', default_user_id = NULL, created_at = '2008-05-12 22:31:20' WHERE id = 10038[0m
  [4;35;1mSQL (0.001445)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mSQL (0.000595)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002700)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mRoleAssignment Update (0.000704)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:20', default_firm_id = NULL, role_id = 1, user_id = 5, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:20' WHERE id = 10038[0m
  [4;35;1mBlog Load (0.001598)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mPhonyPatBlog Columns (0.001251)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;35;1mPhonyPatBlog Load (0.001543)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mBlog Load (0.000834)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;35;1mPhonyPatBlog Load (0.001488)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;36;1mBlog Load (0.000820)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;35;1mPhonyPatBlog Load (0.001486)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;36;1mBlog Load (0.000827)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;35;1mPhonyPatBlog Load (0.001480)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;36;1mFirm Load (0.000716)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mUser Load (0.001526)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000767)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001330)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001062)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002818)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001398)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:20', 10026, 2, 5, '2008-05-12 22:31:20')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001512)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10026)
  [4;36;1mSQL (0.002055)[0m   [0;1mselect 'x' from roles where id = 10026 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001314)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 10026, 10040, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001059)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002681)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10026)
  [4;36;1mSQL (0.001595)[0m   [0;1mselect 'x' from roles where id = 10026 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000737)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:20', 2, 'Dubuque', 10026, 10065, NULL, 0, '2008-05-12 22:31:20', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10026)
  [4;36;1mSQL (0.002098)[0m   [0;1mselect 'x' from roles where id = 10026 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001331)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:31:20', 3, 'ricky''s dubuque blog', 10026, 10066, NULL, 0, '2008-05-12 22:31:20', 'add_post', NULL)[0m
=== permission check: edit Role test role(10026)
  [4;36;1mSQL (0.001386)[0m   [0;1mselect 'x' from roles where id = 10026 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000669)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:20', NULL, NULL, 10026, 10067, NULL, 0, '2008-05-12 22:31:20', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002846)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000947)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;36;1mPhonyPatEntry Columns (0.001906)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOG_ENTRIES'
 order by column_id
[0m
=== permission check: blog_within_firm Firm Dubuque(2)
  [4;35;1mSQL (0.020548)[0m   [0mselect 'x' from firms where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
[0m
=== permission check: add_post PhonyPatBlog ricky's dubuque blog(3)
  [4;36;1mSQL (0.012695)[0m   [0;1mselect 'x' from blogs where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: create PhonyPatEntry X()
  [4;35;1mPhonyPatEntry Create (0.007797)[0m   [0mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:31:20', 10000, 2, 3, empty_clob(), 4, '2008-05-12 22:31:20')[0m
  [4;36;1mWritable Large Object (0.007442)[0m   [0;1mSELECT entry_txt FROM blog_entries WHERE id = 10000[0m
=== permission check: destroy Role test role(10026)
  [4;35;1mRole Destroy (0.000691)[0m   [0m DELETE FROM roles
 WHERE id = 10026
[0m
  [4;36;1mRoleAssignment Load (0.001852)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000851)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001114)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10040
[0m
  [4;35;1mRoleAssignment Load (0.000987)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001298)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002117)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001451)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001087)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000611)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:20', 10027, 2, 5, '2008-05-12 22:31:20')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002178)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10027)
  [4;36;1mSQL (0.001422)[0m   [0;1mselect 'x' from roles where id = 10027 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000614)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 10027, 10041, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001700)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002076)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10027)
  [4;36;1mSQL (0.002308)[0m   [0;1mselect 'x' from roles where id = 10027 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001393)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:31:20', NULL, NULL, 10027, 10068, 2, 0, '2008-05-12 22:31:20', 'add_post', NULL)[0m
  [4;36;1mPermission Load (0.002146)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyPatBlog Load (0.013192)[0m   [0mSELECT * FROM blogs WHERE (id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: destroy Role test role(10027)
  [4;36;1mRole Destroy (0.000661)[0m   [0;1m DELETE FROM roles
 WHERE id = 10027
[0m
  [4;35;1mRoleAssignment Load (0.001720)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000804)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001104)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10041
[0m
  [4;36;1mRoleAssignment Load (0.000976)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001277)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002118)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001417)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001063)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000605)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:20', 10028, 2, 5, '2008-05-12 22:31:20')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002156)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10028)
  [4;35;1mSQL (0.001385)[0m   [0mselect 'x' from roles where id = 10028 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000599)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 10028, 10042, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001704)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002068)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10028)
  [4;35;1mSQL (0.002289)[0m   [0mselect 'x' from roles where id = 10028 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001374)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:31:20', NULL, NULL, 10028, 10069, 2, 0, '2008-05-12 22:31:20', 'add_post', NULL)[0m
=== permission check: edit Role test role(10028)
  [4;35;1mSQL (0.001401)[0m   [0mselect 'x' from roles where id = 10028 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000688)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:31:20', 3, 'ricky''s dubuque blog', 10028, 10070, NULL, 0, '2008-05-12 22:31:20', 'kill_post', NULL)[0m
  [4;35;1mPermission Load (0.002955)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyPatBlog Load (0.001183)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.owner_firm_id = 2) [0m
  [4;35;1mPhonyPatBlog Load (0.014523)[0m   [0mSELECT * FROM blogs WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
) [0m
=== permission check: destroy Role test role(10028)
  [4;36;1mRole Destroy (0.000694)[0m   [0;1m DELETE FROM roles
 WHERE id = 10028
[0m
  [4;35;1mRoleAssignment Load (0.001742)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000820)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001101)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10042
[0m
  [4;36;1mRoleAssignment Load (0.000977)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001280)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002257)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001694)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mPhonyPatBlog Load (0.000842)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mBlog Load (0.001490)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;36;1mPhonyPatBlog Load (0.000814)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;35;1mBlog Load (0.001487)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;36;1mPhonyPatBlog Load (0.000812)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;35;1mBlog Load (0.001489)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;36;1mPhonyPatBlog Load (0.000812)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;35;1mFirm Load (0.001385)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mUser Load (0.000816)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001436)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000659)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001738)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002168)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000740)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:20', 10029, 2, 5, '2008-05-12 22:31:20')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002187)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10029)
  [4;35;1mSQL (0.001413)[0m   [0mselect 'x' from roles where id = 10029 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000619)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:20', 10029, 10043, 5, NULL, '2008-05-12 22:31:20', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001705)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001953)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10029)
  [4;35;1mSQL (0.002246)[0m   [0mselect 'x' from roles where id = 10029 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001399)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10029, 10071, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10029)
  [4;35;1mSQL (0.001438)[0m   [0mselect 'x' from roles where id = 10029 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000665)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:31:21', 3, 'ricky''s dubuque blog', 10029, 10072, NULL, 0, '2008-05-12 22:31:21', 'add_post', NULL)[0m
=== permission check: edit Role test role(10029)
  [4;35;1mSQL (0.002048)[0m   [0mselect 'x' from roles where id = 10029 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001340)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10029, 10073, NULL, 0, '2008-05-12 22:31:21', 'create', NULL)[0m
  [4;35;1mPermission Load (0.002050)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001582)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
=== permission check: blog_within_firm Firm Dubuque(2)
  [4;35;1mSQL (0.001448)[0m   [0mselect 'x' from firms where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
[0m
=== permission check: add_post PhonyPatBlog ricky's dubuque blog(3)
  [4;36;1mSQL (0.002117)[0m   [0;1mselect 'x' from blogs where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: create PhonyPatEntry X()
  [4;35;1mPhonyPatEntry Create (0.001366)[0m   [0mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:31:21', 10001, 2, 3, empty_clob(), 4, '2008-05-12 22:31:21')[0m
  [4;36;1mWritable Large Object (0.000559)[0m   [0;1mSELECT entry_txt FROM blog_entries WHERE id = 10001[0m
=== permission check: destroy Role test role(10029)
  [4;35;1mRole Destroy (0.000472)[0m   [0m DELETE FROM roles
 WHERE id = 10029
[0m
  [4;36;1mRoleAssignment Load (0.001728)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000806)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001110)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10043
[0m
  [4;35;1mRoleAssignment Load (0.000981)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001284)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001984)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001518)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 1) [0m
  [4;35;1mSQL (0.000668)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001732)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001259)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10030, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001459)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10030)
  [4;35;1mSQL (0.002053)[0m   [0mselect 'x' from roles where id = 10030 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001259)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10030, 10044, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001022)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002606)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10030)
  [4;35;1mSQL (0.001548)[0m   [0mselect 'x' from roles where id = 10030 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000705)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10030, 10074, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
  [4;35;1mPermission Load (0.002802)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.019018)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and 2 + 2 = 5) [0m
=== permission check: destroy Role test role(10030)
  [4;35;1mRole Destroy (0.001320)[0m   [0m DELETE FROM roles
 WHERE id = 10030
[0m
  [4;36;1mRoleAssignment Load (0.001083)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001479)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000432)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10044
[0m
  [4;35;1mRoleAssignment Load (0.001645)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000618)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002788)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000768)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001745)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001270)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10031, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001489)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10031)
  [4;36;1mSQL (0.002046)[0m   [0;1mselect 'x' from roles where id = 10031 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001261)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10031, 10045, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001033)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002942)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10031)
  [4;36;1mSQL (0.001642)[0m   [0;1mselect 'x' from roles where id = 10031 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000734)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10031, 10075, 2, 0, '2008-05-12 22:31:21', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002825)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.011953)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10031)
  [4;36;1mRole Destroy (0.001326)[0m   [0;1m DELETE FROM roles
 WHERE id = 10031
[0m
  [4;35;1mRoleAssignment Load (0.001056)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001487)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000434)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10045
[0m
  [4;36;1mRoleAssignment Load (0.001641)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000611)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002818)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000762)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001740)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001270)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10032, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001505)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10032)
  [4;35;1mSQL (0.002058)[0m   [0mselect 'x' from roles where id = 10032 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001268)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10032, 10046, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001033)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002752)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10032)
  [4;35;1mSQL (0.001626)[0m   [0mselect 'x' from roles where id = 10032 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001501)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10032, 10076, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10032)
  [4;35;1mSQL (0.002223)[0m   [0mselect 'x' from roles where id = 10032 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001325)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10032, 10077, 2, 0, '2008-05-12 22:31:21', 'update', NULL)[0m
  [4;35;1mPermission Load (0.002156)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001979)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and 2 + 2 = 5) [0m
=== permission check: destroy Role test role(10032)
  [4;35;1mRole Destroy (0.000545)[0m   [0m DELETE FROM roles
 WHERE id = 10032
[0m
  [4;36;1mRoleAssignment Load (0.001712)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000818)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001112)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10046
[0m
  [4;35;1mRoleAssignment Load (0.000984)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001286)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002133)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001451)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001088)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000598)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10033, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002174)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10033)
  [4;36;1mSQL (0.001396)[0m   [0;1mselect 'x' from roles where id = 10033 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000598)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10033, 10047, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001700)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002086)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10033)
  [4;36;1mSQL (0.002302)[0m   [0;1mselect 'x' from roles where id = 10033 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001387)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10033, 10078, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10033)
  [4;36;1mSQL (0.001416)[0m   [0;1mselect 'x' from roles where id = 10033 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000655)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10033, 10079, 2, 0, '2008-05-12 22:31:21', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002959)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.002187)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10033)
  [4;36;1mRole Destroy (0.001405)[0m   [0;1m DELETE FROM roles
 WHERE id = 10033
[0m
  [4;35;1mRoleAssignment Load (0.001080)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001496)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000444)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10047
[0m
  [4;36;1mRoleAssignment Load (0.001658)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000623)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002933)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000800)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001762)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001579)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10034, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001551)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10034)
  [4;35;1mSQL (0.002065)[0m   [0mselect 'x' from roles where id = 10034 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001291)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10034, 10048, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001034)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002888)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10034)
  [4;35;1mSQL (0.001684)[0m   [0mselect 'x' from roles where id = 10034 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000748)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10034, 10080, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10034)
  [4;35;1mSQL (0.002187)[0m   [0mselect 'x' from roles where id = 10034 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001360)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10034, 10081, 2, 0, '2008-05-12 22:31:21', 'create', NULL)[0m
=== permission check: edit Role test role(10034)
  [4;35;1mSQL (0.001414)[0m   [0mselect 'x' from roles where id = 10034 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000674)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 1, 'Shire', 10034, 10082, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
  [4;35;1mPermission Load (0.002972)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.002256)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10034)
  [4;35;1mRole Destroy (0.001387)[0m   [0m DELETE FROM roles
 WHERE id = 10034
[0m
  [4;36;1mRoleAssignment Load (0.001070)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001479)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000443)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10048
[0m
  [4;35;1mRoleAssignment Load (0.001643)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000614)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002937)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000794)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001742)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001298)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10035, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001522)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10035)
  [4;36;1mSQL (0.002056)[0m   [0;1mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001279)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10035, 10049, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001026)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002876)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10035)
  [4;36;1mSQL (0.001676)[0m   [0;1mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000739)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10035, 10083, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10035)
  [4;36;1mSQL (0.002093)[0m   [0;1mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001354)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10035, 10084, 2, 0, '2008-05-12 22:31:21', 'create', NULL)[0m
=== permission check: edit Role test role(10035)
  [4;36;1mSQL (0.001406)[0m   [0;1mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001336)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 1, 'Shire', 10035, 10085, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10035)
  [4;36;1mSQL (0.001396)[0m   [0;1mselect 'x' from roles where id = 10035 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000681)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10035, 10086, 1, 0, '2008-05-12 22:31:21', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002987)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.021634)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (1,2)) [0m
=== permission check: destroy Role test role(10035)
  [4;36;1mRole Destroy (0.001448)[0m   [0;1m DELETE FROM roles
 WHERE id = 10035
[0m
  [4;35;1mRoleAssignment Load (0.001076)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001482)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000443)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10049
[0m
  [4;36;1mRoleAssignment Load (0.001648)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000615)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002963)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001550)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mPhonyPatBlog Load (0.000831)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mBlog Load (0.001488)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;36;1mPhonyPatBlog Load (0.000814)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;35;1mBlog Load (0.001483)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;36;1mPhonyPatBlog Load (0.000817)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;35;1mBlog Load (0.001484)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;36;1mPhonyPatBlog Load (0.000809)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;35;1mFirm Load (0.001384)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mUser Load (0.000814)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001439)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000651)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001737)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002172)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000712)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10036, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002175)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10036)
  [4;35;1mSQL (0.001422)[0m   [0mselect 'x' from roles where id = 10036 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000624)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10036, 10050, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001707)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001949)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10036)
  [4;35;1mSQL (0.002243)[0m   [0mselect 'x' from roles where id = 10036 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001396)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10036, 10087, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10036)
  [4;35;1mSQL (0.001432)[0m   [0mselect 'x' from roles where id = 10036 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000694)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:31:21', 3, 'ricky''s dubuque blog', 10036, 10088, NULL, 0, '2008-05-12 22:31:21', 'add_post', NULL)[0m
=== permission check: edit Role test role(10036)
  [4;35;1mSQL (0.002067)[0m   [0mselect 'x' from roles where id = 10036 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001343)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10036, 10089, NULL, 0, '2008-05-12 22:31:21', 'create', NULL)[0m
  [4;35;1mPermission Load (0.002058)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001579)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
=== permission check: blog_within_firm Firm Dubuque(2)
  [4;35;1mSQL (0.001392)[0m   [0mselect 'x' from firms where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
[0m
=== permission check: add_post PhonyPatBlog ricky's dubuque blog(3)
  [4;36;1mSQL (0.002069)[0m   [0;1mselect 'x' from blogs where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: create PhonyPatEntry X()
  [4;35;1mPhonyPatEntry Create (0.001357)[0m   [0mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:31:21', 10002, 2, 3, empty_clob(), 4, '2008-05-12 22:31:21')[0m
  [4;36;1mWritable Large Object (0.000588)[0m   [0;1mSELECT entry_txt FROM blog_entries WHERE id = 10002[0m
=== permission check: destroy Role test role(10036)
  [4;35;1mRole Destroy (0.000479)[0m   [0m DELETE FROM roles
 WHERE id = 10036
[0m
  [4;36;1mRoleAssignment Load (0.001732)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000802)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001105)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10050
[0m
  [4;35;1mRoleAssignment Load (0.000984)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001285)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001990)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001531)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 1) [0m
  [4;35;1mSQL (0.000669)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001747)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001273)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10037, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001477)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10037)
  [4;35;1mSQL (0.002079)[0m   [0mselect 'x' from roles where id = 10037 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001285)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10037, 10051, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001032)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002621)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10037)
  [4;35;1mSQL (0.001569)[0m   [0mselect 'x' from roles where id = 10037 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000718)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10037, 10090, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
  [4;35;1mPermission Load (0.002811)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001242)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and 2 + 2 = 5) [0m
=== permission check: destroy Role test role(10037)
  [4;35;1mRole Destroy (0.001207)[0m   [0m DELETE FROM roles
 WHERE id = 10037
[0m
  [4;36;1mRoleAssignment Load (0.001036)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001474)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000438)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10051
[0m
  [4;35;1mRoleAssignment Load (0.001642)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000611)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002784)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000752)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001731)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001262)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10038, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001479)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10038)
  [4;36;1mSQL (0.002038)[0m   [0;1mselect 'x' from roles where id = 10038 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001259)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10038, 10052, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001028)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002735)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10038)
  [4;36;1mSQL (0.001624)[0m   [0;1mselect 'x' from roles where id = 10038 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000727)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10038, 10091, 2, 0, '2008-05-12 22:31:21', 'update', NULL)[0m
  [4;36;1mPermission Load (0.002817)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001817)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10038)
  [4;36;1mRole Destroy (0.001255)[0m   [0;1m DELETE FROM roles
 WHERE id = 10038
[0m
  [4;35;1mRoleAssignment Load (0.001043)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001483)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000431)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10052
[0m
  [4;36;1mRoleAssignment Load (0.001639)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000611)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002741)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000760)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001735)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001265)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10039, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001480)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10039)
  [4;35;1mSQL (0.002045)[0m   [0mselect 'x' from roles where id = 10039 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001260)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10039, 10053, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001023)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002728)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10039)
  [4;35;1mSQL (0.001636)[0m   [0mselect 'x' from roles where id = 10039 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000715)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10039, 10092, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10039)
  [4;35;1mSQL (0.002071)[0m   [0mselect 'x' from roles where id = 10039 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001321)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10039, 10093, 2, 0, '2008-05-12 22:31:21', 'create', NULL)[0m
  [4;35;1mPermission Load (0.002262)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001920)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and 2 + 2 = 5) [0m
=== permission check: destroy Role test role(10039)
  [4;35;1mRole Destroy (0.000535)[0m   [0m DELETE FROM roles
 WHERE id = 10039
[0m
  [4;36;1mRoleAssignment Load (0.001687)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000805)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001102)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10053
[0m
  [4;35;1mRoleAssignment Load (0.000978)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001279)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002255)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001461)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001064)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000612)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10040, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002177)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10040)
  [4;36;1mSQL (0.001384)[0m   [0;1mselect 'x' from roles where id = 10040 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000600)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10040, 10054, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001695)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002192)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10040)
  [4;36;1mSQL (0.002330)[0m   [0;1mselect 'x' from roles where id = 10040 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001384)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10040, 10094, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10040)
  [4;36;1mSQL (0.001395)[0m   [0;1mselect 'x' from roles where id = 10040 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000650)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10040, 10095, 2, 0, '2008-05-12 22:31:21', 'update', NULL)[0m
  [4;36;1mPermission Load (0.002939)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.001971)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10040)
  [4;36;1mRole Destroy (0.001287)[0m   [0;1m DELETE FROM roles
 WHERE id = 10040
[0m
  [4;35;1mRoleAssignment Load (0.001059)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001467)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000432)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10054
[0m
  [4;36;1mRoleAssignment Load (0.001637)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000607)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002885)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000781)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001742)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001575)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10041, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001529)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10041)
  [4;35;1mSQL (0.002050)[0m   [0mselect 'x' from roles where id = 10041 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001293)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10041, 10055, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001025)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002871)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10041)
  [4;35;1mSQL (0.001679)[0m   [0mselect 'x' from roles where id = 10041 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000785)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10041, 10096, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10041)
  [4;35;1mSQL (0.002088)[0m   [0mselect 'x' from roles where id = 10041 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001346)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10041, 10097, 2, 0, '2008-05-12 22:31:21', 'update', NULL)[0m
=== permission check: edit Role test role(10041)
  [4;35;1mSQL (0.001397)[0m   [0mselect 'x' from roles where id = 10041 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000668)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 1, 'Shire', 10041, 10098, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
  [4;35;1mPermission Load (0.002975)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.001982)[0m   [0;1mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (2)) [0m
=== permission check: destroy Role test role(10041)
  [4;35;1mRole Destroy (0.001319)[0m   [0m DELETE FROM roles
 WHERE id = 10041
[0m
  [4;36;1mRoleAssignment Load (0.001058)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001478)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000439)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10055
[0m
  [4;35;1mRoleAssignment Load (0.001639)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000612)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002899)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000798)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001736)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001294)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:21', 10042, 2, 5, '2008-05-12 22:31:21')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001498)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10042)
  [4;36;1mSQL (0.002064)[0m   [0;1mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000612)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:21', 10042, 10056, 5, NULL, '2008-05-12 22:31:21', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001695)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002197)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10042)
  [4;36;1mSQL (0.002340)[0m   [0;1mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001401)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 2, 'Dubuque', 10042, 10099, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10042)
  [4;36;1mSQL (0.001406)[0m   [0;1mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000724)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10042, 10100, 2, 0, '2008-05-12 22:31:21', 'update', NULL)[0m
=== permission check: edit Role test role(10042)
  [4;36;1mSQL (0.002156)[0m   [0;1mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001360)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:21', 1, 'Shire', 10042, 10101, NULL, 0, '2008-05-12 22:31:21', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10042)
  [4;36;1mSQL (0.001403)[0m   [0;1mselect 'x' from roles where id = 10042 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000667)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:21', NULL, NULL, 10042, 10102, 1, 0, '2008-05-12 22:31:21', 'update', NULL)[0m
  [4;36;1mPermission Load (0.002988)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mFirm Load (0.002441)[0m   [0mSELECT * FROM firms WHERE ( exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
 and firms.id in (1,2)) [0m
=== permission check: destroy Role test role(10042)
  [4;36;1mRole Destroy (0.001340)[0m   [0;1m DELETE FROM roles
 WHERE id = 10042
[0m
  [4;35;1mRoleAssignment Load (0.001066)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001473)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000443)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10056
[0m
  [4;36;1mRoleAssignment Load (0.001646)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000614)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002912)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mBlog Load (0.001014)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;36;1mPhonyPatBlog Load (0.001518)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mBlog Load (0.000819)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;36;1mPhonyPatBlog Load (0.001480)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 3) [0m
  [4;35;1mBlog Load (0.000815)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;36;1mPhonyPatBlog Load (0.001478)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 4) [0m
  [4;35;1mBlog Load (0.000820)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;36;1mPhonyPatBlog Load (0.001481)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 5) [0m
  [4;35;1mFirm Load (0.000717)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mUser Load (0.001489)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000762)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001315)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001059)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002822)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001387)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10043, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001508)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10043)
  [4;35;1mSQL (0.002077)[0m   [0mselect 'x' from roles where id = 10043 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001290)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10043, 10057, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001032)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002614)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10043)
  [4;35;1mSQL (0.001552)[0m   [0mselect 'x' from roles where id = 10043 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000716)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Firm', 0, 0, '2008-05-12 22:31:22', 2, 'Dubuque', 10043, 10103, NULL, 0, '2008-05-12 22:31:22', 'blog_within_firm', NULL)[0m
=== permission check: edit Role test role(10043)
  [4;35;1mSQL (0.002074)[0m   [0mselect 'x' from roles where id = 10043 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001320)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatBlog', 0, 0, '2008-05-12 22:31:22', 3, 'ricky''s dubuque blog', 10043, 10104, NULL, 0, '2008-05-12 22:31:22', 'add_post', NULL)[0m
=== permission check: edit Role test role(10043)
  [4;35;1mSQL (0.001387)[0m   [0mselect 'x' from roles where id = 10043 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000673)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyPatEntry', 0, 0, '2008-05-12 22:31:22', NULL, NULL, 10043, 10105, NULL, 0, '2008-05-12 22:31:22', 'create', NULL)[0m
  [4;35;1mPermission Load (0.002719)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000903)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
=== permission check: blog_within_firm Firm Dubuque(2)
  [4;35;1mSQL (0.002056)[0m   [0mselect 'x' from firms where id = 2 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'blog_within_firm' or p.privilege = 'any')
 and (p.class_name = 'Firm')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or 2 + 2 = 5)
 and (p.target_id is null or firms.id = p.target_id)
 )
[0m
=== permission check: add_post PhonyPatBlog ricky's dubuque blog(3)
  [4;36;1mSQL (0.001401)[0m   [0;1mselect 'x' from blogs where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_post' or p.privilege = 'any')
 and (p.class_name = 'PhonyPatBlog')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blogs.owner_id = 5)
 and (p.target_id is null or blogs.id = p.target_id) and (p.target_owner_id is null or blogs.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blogs.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: create PhonyPatEntry X()
  [4;35;1mPhonyPatEntry Create (0.000683)[0m   [0mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:31:22', 10003, 2, 3, empty_clob(), 4, '2008-05-12 22:31:22')[0m
  [4;36;1mWritable Large Object (0.001222)[0m   [0;1mSELECT entry_txt FROM blog_entries WHERE id = 10003[0m
=== permission check: destroy Role test role(10043)
  [4;35;1mRole Destroy (0.001143)[0m   [0m DELETE FROM roles
 WHERE id = 10043
[0m
  [4;36;1mRoleAssignment Load (0.001066)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001468)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000438)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10057
[0m
  [4;35;1mRoleAssignment Load (0.001655)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000618)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002660)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mFirm Load (0.011510)[0m   [0;1mSELECT * FROM firms [0m
  [4;35;1mFirm Load (0.001477)[0m   [0mSELECT * FROM firms [0m
  [4;36;1mBlog Load (0.001567)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
  [4;35;1mUser Load (0.000811)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001435)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000650)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001397)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001071)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002847)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001441)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10044, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001653)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10044)
  [4;35;1mSQL (0.002104)[0m   [0mselect 'x' from roles where id = 10044 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001303)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10044, 10058, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001048)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002627)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000892)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mUser Load (0.001488)[0m   [0;1mSELECT * FROM users WHERE (users.id = 2) [0m
  [4;35;1mFirm Load (0.000726)[0m   [0mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;36;1mBlogEntry Columns (0.001932)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOG_ENTRIES'
 order by column_id
[0m
=== FAILED permission check: change_post Blog mertz family blog(1)
=== permission check: edit Role test role(10044)
  [4;35;1mSQL (0.001619)[0m   [0mselect 'x' from roles where id = 10044 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000744)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:22', 1, 'mertz family blog', 10044, 10106, NULL, 0, '2008-05-12 22:31:22', 'change_post', NULL)[0m
  [4;35;1mPermission Load (0.002848)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_post Blog mertz family blog(1)
=== permission check: change_post Blog mertz family blog(1)
  [4;36;1mBlogEntry Create (0.001388)[0m   [0;1mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:31:22', 10004, 4, 1, empty_clob(), 2, '2008-05-12 22:31:22')[0m
  [4;35;1mWritable Large Object (0.000567)[0m   [0mSELECT entry_txt FROM blog_entries WHERE id = 10004[0m
=== permission check: change_post Blog mertz family blog(1)
=== permission check: change_post Blog mertz family blog(1)
  [4;36;1mBlogEntry Create (0.001202)[0m   [0;1mINSERT INTO blog_entries (updated_at, id, owner_firm_id, blog_id, entry_txt, owner_id, created_at) VALUES('2008-05-12 22:31:22', 10005, 4, 1, empty_clob(), 2, '2008-05-12 22:31:22')[0m
  [4;35;1mWritable Large Object (0.000542)[0m   [0mSELECT entry_txt FROM blog_entries WHERE id = 10005[0m
=== permission check: destroy Role test role(10044)
  [4;36;1mRole Destroy (0.000481)[0m   [0;1m DELETE FROM roles
 WHERE id = 10044
[0m
  [4;35;1mRoleAssignment Load (0.001736)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000813)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001112)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10058
[0m
  [4;36;1mRoleAssignment Load (0.000989)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001293)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002143)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001466)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001119)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000613)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10045, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002197)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10045)
  [4;35;1mSQL (0.001427)[0m   [0mselect 'x' from roles where id = 10045 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000616)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10045, 10059, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001709)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002079)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001588)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mEntryComment Columns (0.001284)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'ENTRY_COMMENTS'
 order by column_id
[0m
=== FAILED permission check: add_comment BlogEntry X(10004)
=== permission check: edit Role test role(10045)
  [4;35;1mSQL (0.001628)[0m   [0mselect 'x' from roles where id = 10045 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.007162)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10004, NULL, 10045, 10107, NULL, 0, '2008-05-12 22:31:22', 'add_comment', NULL)[0m
  [4;35;1mPermission Load (0.003060)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: add_comment BlogEntry X(10004)
  [4;36;1mSQL (0.012247)[0m   [0;1mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mEntryComment Create (0.007033)[0m   [0mINSERT INTO entry_comments (updated_at, comment_txt, id, owner_firm_id, owner_id, blog_entry_id, created_at) VALUES('2008-05-12 22:31:22', empty_clob(), 10000, 4, 2, 10004, '2008-05-12 22:31:22')[0m
  [4;36;1mWritable Large Object (0.008787)[0m   [0;1mSELECT comment_txt FROM entry_comments WHERE id = 10000[0m
=== permission check: destroy Role test role(10045)
  [4;35;1mRole Destroy (0.001311)[0m   [0m DELETE FROM roles
 WHERE id = 10045
[0m
  [4;36;1mRoleAssignment Load (0.001140)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001502)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000446)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10059
[0m
  [4;35;1mRoleAssignment Load (0.001653)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000622)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002786)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000742)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001763)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001284)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10046, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001516)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10046)
  [4;36;1mSQL (0.002095)[0m   [0;1mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001316)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10046, 10060, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001054)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002789)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000913)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10004)
=== permission check: edit Role test role(10046)
  [4;35;1mSQL (0.002204)[0m   [0mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001429)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10004, NULL, 10046, 10108, NULL, 0, '2008-05-12 22:31:22', 'kill_comment', NULL)[0m
  [4;35;1mPermission Load (0.002277)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10004)
=== FAILED permission check: add_comment BlogEntry X(10005)
  [4;36;1mRole Load (0.001753)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
=== permission check: edit Role test role(10046)
=== permission check: edit Role twiddler(3)
  [4;35;1mSQL (0.001521)[0m   [0mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.002120)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Update (0.008045)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10004, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'kill_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10108[0m
=== permission check: edit Role test role(10046)
  [4;36;1mSQL (0.002369)[0m   [0;1mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001381)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10005, NULL, 10046, 10109, NULL, 0, '2008-05-12 22:31:22', 'add_comment', NULL)[0m
  [4;36;1mPermission Load (0.002411)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10004)
=== permission check: edit Role test role(10046)
=== permission check: edit Role twiddler(3)
  [4;35;1mSQL (0.002399)[0m   [0mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001455)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Update (0.001544)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10005, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'add_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10109[0m
=== permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10046)
  [4;36;1mSQL (0.001597)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002085)[0m   [0mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.000764)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10004, target_name = NULL, role_id = 10046, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'kill_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10108[0m
=== permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10046)
  [4;35;1mSQL (0.002227)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001408)[0m   [0;1mselect 'x' from roles where id = 10046 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Update (0.001406)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10005, target_name = NULL, role_id = 10046, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'add_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10109[0m
  [4;36;1mPermission Load (0.002281)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10004)
=== permission check: add_comment BlogEntry X(10005)
  [4;35;1mSQL (0.014114)[0m   [0mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'kill_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001633)[0m   [0;1mselect 'x' from blog_entries where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10046)
  [4;35;1mRole Destroy (0.001249)[0m   [0m DELETE FROM roles
 WHERE id = 10046
[0m
  [4;36;1mRoleAssignment Load (0.001063)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001485)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000441)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10060
[0m
  [4;35;1mRoleAssignment Load (0.001646)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000613)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002882)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000775)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001762)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001284)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10047, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001511)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10047)
  [4;36;1mSQL (0.002075)[0m   [0;1mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001593)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10047, 10061, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001064)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002917)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000944)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10005)
=== permission check: edit Role test role(10047)
  [4;35;1mSQL (0.002209)[0m   [0mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001406)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10005, NULL, 10047, 10110, NULL, 0, '2008-05-12 22:31:22', 'kill_comment', NULL)[0m
  [4;35;1mPermission Load (0.002391)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10005)
=== FAILED permission check: add_comment BlogEntry X(10004)
=== permission check: edit Role test role(10047)
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.002411)[0m   [0;1mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001449)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.001561)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10005, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'kill_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10110[0m
=== permission check: edit Role test role(10047)
  [4;35;1mSQL (0.001479)[0m   [0mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000704)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10004, NULL, 10047, 10111, NULL, 0, '2008-05-12 22:31:22', 'add_comment', NULL)[0m
  [4;35;1mPermission Load (0.003363)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10005)
=== permission check: edit Role test role(10047)
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.001751)[0m   [0;1mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002131)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.000850)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10004, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'add_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10111[0m
=== permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10047)
  [4;35;1mSQL (0.002249)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.001407)[0m   [0;1mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Update (0.001431)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10005, target_name = NULL, role_id = 10047, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'kill_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10110[0m
=== permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10047)
  [4;36;1mSQL (0.001521)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002071)[0m   [0mselect 'x' from roles where id = 10047 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.000752)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10004, target_name = NULL, role_id = 10047, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'add_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10111[0m
  [4;35;1mPermission Load (0.003080)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10005)
=== permission check: add_comment BlogEntry X(10004)
  [4;36;1mSQL (0.001809)[0m   [0;1mselect 'x' from blog_entries where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'kill_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002206)[0m   [0mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mEntryComment Update (0.008214)[0m   [0;1mUPDATE entry_comments SET updated_at = '2008-05-12 22:31:22', owner_firm_id = 4, comment_txt = empty_clob(), owner_id = 2, blog_entry_id = 10004, created_at = '2008-05-12 22:31:22' WHERE id = 10000[0m
  [4;35;1mWritable Large Object (0.001404)[0m   [0mSELECT comment_txt FROM entry_comments WHERE id = 10000[0m
=== permission check: destroy Role test role(10047)
  [4;36;1mRole Destroy (0.001161)[0m   [0;1m DELETE FROM roles
 WHERE id = 10047
[0m
  [4;35;1mRoleAssignment Load (0.001084)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001470)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000438)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10061
[0m
  [4;36;1mRoleAssignment Load (0.001675)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000619)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.003020)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000805)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001741)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001292)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10048, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001500)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10048)
  [4;35;1mSQL (0.002041)[0m   [0mselect 'x' from roles where id = 10048 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001285)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10048, 10062, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001024)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002992)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000947)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mSQL (0.002203)[0m   [0;1mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'kill_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: edit Role test role(10048)
  [4;35;1mSQL (0.001408)[0m   [0mselect 'x' from roles where id = 10048 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000752)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10004, NULL, 10048, 10112, NULL, 0, '2008-05-12 22:31:22', 'kill_comment', NULL)[0m
  [4;35;1mPermission Load (0.003091)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001851)[0m   [0;1mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'kill_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002113)[0m   [0mselect 'x' from blog_entries where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: edit Role test role(10048)
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.001381)[0m   [0;1mselect 'x' from roles where id = 10048 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002076)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.000857)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10004, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'kill_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10112[0m
=== permission check: edit Role test role(10048)
  [4;35;1mSQL (0.002164)[0m   [0mselect 'x' from roles where id = 10048 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001378)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10005, NULL, 10048, 10113, NULL, 0, '2008-05-12 22:31:22', 'add_comment', NULL)[0m
  [4;35;1mPermission Load (0.002523)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002543)[0m   [0;1mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'kill_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: edit Role test role(10048)
=== permission check: edit Role twiddler(3)
  [4;35;1mSQL (0.001465)[0m   [0mselect 'x' from roles where id = 10048 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.002083)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Update (0.000836)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10005, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'add_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10113[0m
=== permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10048)
  [4;36;1mSQL (0.002241)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001407)[0m   [0mselect 'x' from roles where id = 10048 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.001423)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10004, target_name = NULL, role_id = 10048, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'kill_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10112[0m
=== permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10048)
  [4;35;1mSQL (0.001511)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.002064)[0m   [0;1mselect 'x' from roles where id = 10048 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Update (0.000752)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10005, target_name = NULL, role_id = 10048, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'add_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10113[0m
  [4;36;1mPermission Load (0.003084)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001835)[0m   [0mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'kill_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.002203)[0m   [0;1mselect 'x' from blog_entries where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10048)
  [4;35;1mRole Destroy (0.000605)[0m   [0m DELETE FROM roles
 WHERE id = 10048
[0m
  [4;36;1mRoleAssignment Load (0.001714)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000806)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001110)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10062
[0m
  [4;35;1mRoleAssignment Load (0.000972)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001277)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002331)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001473)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001063)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000621)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10049, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002166)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10049)
  [4;36;1mSQL (0.001377)[0m   [0;1mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000614)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10049, 10063, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001689)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002324)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001604)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10004)
=== permission check: edit Role test role(10049)
  [4;35;1mSQL (0.001534)[0m   [0mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000733)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10004, NULL, 10049, 10114, NULL, 0, '2008-05-12 22:31:22', 'kill_comment', NULL)[0m
  [4;35;1mPermission Load (0.003061)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10004)
=== FAILED permission check: add_comment BlogEntry X(10005)
=== permission check: edit Role test role(10049)
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.001733)[0m   [0;1mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.002114)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.000838)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10004, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'kill_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10114[0m
=== permission check: edit Role test role(10049)
  [4;35;1mSQL (0.002124)[0m   [0mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001378)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10005, NULL, 10049, 10115, NULL, 0, '2008-05-12 22:31:22', 'add_comment', NULL)[0m
  [4;35;1mPermission Load (0.002515)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10004)
=== permission check: edit Role test role(10049)
=== permission check: edit Role twiddler(3)
  [4;36;1mSQL (0.002419)[0m   [0;1mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001438)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.001513)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10005, target_name = NULL, role_id = 3, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'add_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10115[0m
=== permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10049)
  [4;35;1mSQL (0.001580)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mSQL (0.002076)[0m   [0;1mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Update (0.000758)[0m   [0mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10004, target_name = NULL, role_id = 10049, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'kill_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10114[0m
=== permission check: edit Role twiddler(3)
=== permission check: edit Role test role(10049)
  [4;36;1mSQL (0.002180)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mSQL (0.001399)[0m   [0mselect 'x' from roles where id = 10049 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Update (0.001473)[0m   [0;1mUPDATE permissions SET is_grant = 0, class_name = 'BlogEntry', updated_at = '2008-05-12 22:31:22', target_owned_by_self = 0, target_id = 10005, target_name = NULL, role_id = 10049, target_owner_firm_id = NULL, has_grant_option = 0, target_owner_id = NULL, privilege = 'add_comment', created_at = '2008-05-12 22:31:22' WHERE id = 10115[0m
  [4;35;1mPermission Load (0.002427)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10004)
=== permission check: add_comment BlogEntry X(10005)
=== permission check: destroy Role test role(10049)
  [4;36;1mRole Destroy (0.001394)[0m   [0;1m DELETE FROM roles
 WHERE id = 10049
[0m
  [4;35;1mRoleAssignment Load (0.001062)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001480)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000443)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10063
[0m
  [4;36;1mRoleAssignment Load (0.001642)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000614)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.003066)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000875)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001735)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001293)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10050, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001507)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10050)
  [4;35;1mSQL (0.002043)[0m   [0mselect 'x' from roles where id = 10050 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001274)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10050, 10064, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001025)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002996)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000938)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10005)
=== permission check: edit Role test role(10050)
  [4;36;1mSQL (0.002194)[0m   [0;1mselect 'x' from roles where id = 10050 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001406)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10005, NULL, 10050, 10116, NULL, 0, '2008-05-12 22:31:22', 'kill_comment', NULL)[0m
  [4;36;1mPermission Load (0.002540)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10005)
  [4;35;1mSQL (0.002552)[0m   [0mselect 'x' from blog_entries where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'kill_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10050)
  [4;36;1mRole Destroy (0.000601)[0m   [0;1m DELETE FROM roles
 WHERE id = 10050
[0m
  [4;35;1mRoleAssignment Load (0.001717)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000804)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001116)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10064
[0m
  [4;36;1mRoleAssignment Load (0.000971)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001280)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002461)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001497)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001066)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000627)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10051, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002175)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10051)
  [4;35;1mSQL (0.001383)[0m   [0mselect 'x' from roles where id = 10051 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000609)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10051, 10065, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001696)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002457)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001624)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mSQL (0.001693)[0m   [0;1mselect 'x' from blog_entries where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: edit Role test role(10051)
  [4;35;1mSQL (0.002371)[0m   [0mselect 'x' from roles where id = 10051 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001362)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10005, NULL, 10051, 10117, NULL, 0, '2008-05-12 22:31:22', 'add_comment', NULL)[0m
  [4;35;1mPermission Load (0.002323)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002379)[0m   [0;1mselect 'x' from blog_entries where id = 10005 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mEntryComment Update (0.000740)[0m   [0mUPDATE entry_comments SET updated_at = '2008-05-12 22:31:22', owner_firm_id = 4, comment_txt = empty_clob(), owner_id = 2, blog_entry_id = 10005, created_at = '2008-05-12 22:31:22' WHERE id = 10000[0m
  [4;36;1mWritable Large Object (0.001238)[0m   [0;1mSELECT comment_txt FROM entry_comments WHERE id = 10000[0m
=== permission check: destroy Role test role(10051)
  [4;35;1mRole Destroy (0.001153)[0m   [0m DELETE FROM roles
 WHERE id = 10051
[0m
  [4;36;1mRoleAssignment Load (0.001048)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001469)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000433)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10065
[0m
  [4;35;1mRoleAssignment Load (0.001643)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000610)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002940)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000769)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001727)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001254)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10052, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001411)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10052)
  [4;36;1mSQL (0.002009)[0m   [0;1mselect 'x' from roles where id = 10052 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001247)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:22', 10052, 10066, 5, NULL, '2008-05-12 22:31:22', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001027)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002920)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000894)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mBlogEntry Load (0.007959)[0m   [0mSELECT * FROM blog_entries WHERE (blog_entries.id = 10005) [0m
=== FAILED permission check: kill_comment BlogEntry X(10005)
=== permission check: edit Role test role(10052)
  [4;36;1mSQL (0.001515)[0m   [0;1mselect 'x' from roles where id = 10052 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000692)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:22', 10005, NULL, 10052, 10118, NULL, 0, '2008-05-12 22:31:22', 'kill_comment', NULL)[0m
  [4;36;1mPermission Load (0.002989)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10005)
  [4;35;1mEntryComment Destroy (0.005926)[0m   [0m DELETE FROM entry_comments
 WHERE id = 10000
[0m
=== permission check: destroy Role test role(10052)
  [4;36;1mRole Destroy (0.001221)[0m   [0;1m DELETE FROM roles
 WHERE id = 10052
[0m
  [4;35;1mRoleAssignment Load (0.001097)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001479)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000441)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10066
[0m
  [4;36;1mRoleAssignment Load (0.001645)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000613)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002931)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mEntryComment Create (0.007115)[0m   [0mINSERT INTO entry_comments (updated_at, comment_txt, id, owner_firm_id, owner_id, blog_entry_id, created_at) VALUES('2008-05-12 22:31:22', empty_clob(), 10001, 4, 2, NULL, '2008-05-12 22:31:22')[0m
  [4;36;1mWritable Large Object (0.000652)[0m   [0;1mSELECT comment_txt FROM entry_comments WHERE id = 10001[0m
  [4;35;1mSQL (0.000669)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001730)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001198)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:22', 10053, 2, 5, '2008-05-12 22:31:22')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001361)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10053)
  [4;35;1mSQL (0.002003)[0m   [0mselect 'x' from roles where id = 10053 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001260)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10053, 10067, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001019)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002930)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000897)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: add_comment BlogEntry X(10004)
=== permission check: edit Role test role(10053)
  [4;36;1mSQL (0.002117)[0m   [0;1mselect 'x' from roles where id = 10053 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001371)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:23', 10004, NULL, 10053, 10119, NULL, 0, '2008-05-12 22:31:23', 'add_comment', NULL)[0m
  [4;36;1mPermission Load (0.002331)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: add_comment BlogEntry X(10004)
  [4;35;1mSQL (0.001964)[0m   [0mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'add_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10053)
  [4;36;1mRole Destroy (0.000592)[0m   [0;1m DELETE FROM roles
 WHERE id = 10053
[0m
  [4;35;1mRoleAssignment Load (0.001721)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000819)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001114)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10067
[0m
  [4;36;1mRoleAssignment Load (0.000995)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001282)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002281)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001440)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001073)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000588)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10054, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001425)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10054)
  [4;35;1mSQL (0.002020)[0m   [0mselect 'x' from roles where id = 10054 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001259)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10054, 10068, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001034)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002939)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000901)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: kill_comment BlogEntry X(10004)
=== permission check: edit Role test role(10054)
  [4;36;1mSQL (0.002116)[0m   [0;1mselect 'x' from roles where id = 10054 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001426)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('BlogEntry', 0, 0, '2008-05-12 22:31:23', 10004, NULL, 10054, 10120, NULL, 0, '2008-05-12 22:31:23', 'kill_comment', NULL)[0m
  [4;36;1mPermission Load (0.002373)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: kill_comment BlogEntry X(10004)
  [4;35;1mSQL (0.002527)[0m   [0mselect 'x' from blog_entries where id = 10004 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'kill_comment' or p.privilege = 'any')
 and (p.class_name = 'BlogEntry')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or blog_entries.owner_id = 5)
 and (p.target_id is null or blog_entries.id = p.target_id) and (p.target_owner_id is null or blog_entries.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or blog_entries.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10054)
  [4;36;1mRole Destroy (0.000606)[0m   [0;1m DELETE FROM roles
 WHERE id = 10054
[0m
  [4;35;1mRoleAssignment Load (0.001730)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000815)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001112)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10068
[0m
  [4;36;1mRoleAssignment Load (0.000981)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002275)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000811)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.001396)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyWithCallbacks Columns (0.001237)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mSQL (0.001319)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mUser Load (0.000834)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001439)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000647)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001379)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001076)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002707)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001340)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10055, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001427)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10055)
  [4;35;1mSQL (0.002038)[0m   [0mselect 'x' from roles where id = 10055 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001266)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10055, 10069, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001037)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002518)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10055)
  [4;35;1mSQL (0.001480)[0m   [0mselect 'x' from roles where id = 10055 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000686)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10055, 10121, NULL, 0, '2008-05-12 22:31:23', 'update', 3)[0m
  [4;35;1mPermission Load (0.002683)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: create PhonyWithCallbacks phony blog()
=== permission check: destroy Role test role(10055)
  [4;36;1mRole Destroy (0.000655)[0m   [0;1m DELETE FROM roles
 WHERE id = 10055
[0m
  [4;35;1mRoleAssignment Load (0.001732)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000810)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001107)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10069
[0m
  [4;36;1mRoleAssignment Load (0.000987)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001277)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001960)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001268)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.000632)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001725)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001230)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10056, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001396)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10056)
  [4;36;1mSQL (0.002007)[0m   [0;1mselect 'x' from roles where id = 10056 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001230)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10056, 10070, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;36;1mRole Load (0.000878)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001977)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001325)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000557)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 4, 10071, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001695)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002025)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10056)
  [4;36;1mRole Destroy (0.001278)[0m   [0;1m DELETE FROM roles
 WHERE id = 10056
[0m
  [4;35;1mRoleAssignment Load (0.001053)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001480)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000431)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10070
[0m
  [4;36;1mUser Load (0.001456)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000418)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10071
[0m
  [4;36;1mRoleAssignment Load (0.001643)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000605)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002631)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000728)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001729)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001226)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10057, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001389)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10057)
  [4;35;1mSQL (0.002000)[0m   [0mselect 'x' from roles where id = 10057 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001230)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10057, 10072, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001025)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002598)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000864)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: create PhonyWithCallbacks phony blog()
=== permission check: edit Role test role(10057)
  [4;36;1mSQL (0.002133)[0m   [0;1mselect 'x' from roles where id = 10057 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001332)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10057, 10122, NULL, 0, '2008-05-12 22:31:23', 'create', 3)[0m
  [4;36;1mPermission Load (0.002003)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create PhonyWithCallbacks phony blog()
  [4;35;1mPhonyWithCallbacks Create (0.000621)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:31:23', 10007, 3, 3, '2008-05-12 22:31:23')[0m
=== permission check: destroy Role test role(10057)
  [4;36;1mRole Destroy (0.001152)[0m   [0;1m DELETE FROM roles
 WHERE id = 10057
[0m
  [4;35;1mRoleAssignment Load (0.001039)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001472)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000430)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10072
[0m
  [4;36;1mRoleAssignment Load (0.001648)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000607)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002632)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000620)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.001332)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001055)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000555)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10058, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002056)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10058)
  [4;36;1mSQL (0.001330)[0m   [0;1mselect 'x' from roles where id = 10058 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000563)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10058, 10073, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001692)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001938)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001506)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithCallbacks Load (0.000869)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== FAILED permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: edit Role test role(10058)
  [4;36;1mSQL (0.002083)[0m   [0;1mselect 'x' from roles where id = 10058 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001341)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10058, 10123, NULL, 0, '2008-05-12 22:31:23', 'find', 3)[0m
  [4;36;1mPermission Load (0.002111)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithCallbacks Load (0.001659)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: destroy Role test role(10058)
  [4;36;1mRole Destroy (0.000510)[0m   [0;1m DELETE FROM roles
 WHERE id = 10058
[0m
  [4;35;1mRoleAssignment Load (0.001691)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000796)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001096)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10073
[0m
  [4;36;1mRoleAssignment Load (0.000972)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001275)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002078)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001423)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001051)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000561)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10059, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002055)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10059)
  [4;35;1mSQL (0.001339)[0m   [0mselect 'x' from roles where id = 10059 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000566)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10059, 10074, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001681)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002028)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001533)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithCallbacks Load (0.000854)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== FAILED permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: edit Role test role(10059)
  [4;35;1mSQL (0.002082)[0m   [0mselect 'x' from roles where id = 10059 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001336)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10059, 10124, NULL, 0, '2008-05-12 22:31:23', 'find', 3)[0m
  [4;35;1mPermission Load (0.002091)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithCallbacks Load (0.001657)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: destroy Role test role(10059)
  [4;35;1mRole Destroy (0.000499)[0m   [0m DELETE FROM roles
 WHERE id = 10059
[0m
  [4;36;1mRoleAssignment Load (0.001694)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000801)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001096)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10074
[0m
  [4;35;1mRoleAssignment Load (0.000973)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001274)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002071)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001430)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001054)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000575)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10060, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002071)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10060)
  [4;36;1mSQL (0.001332)[0m   [0;1mselect 'x' from roles where id = 10060 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000563)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10060, 10075, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001686)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002029)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10060)
  [4;36;1mSQL (0.002204)[0m   [0;1mselect 'x' from roles where id = 10060 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001374)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10060, 10125, NULL, 0, '2008-05-12 22:31:23', 'create', 3)[0m
  [4;36;1mPermission Load (0.002106)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001626)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000733)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: update PhonyWithCallbacks phony blog updated(10007)
=== permission check: destroy Role test role(10060)
  [4;35;1mRole Destroy (0.001199)[0m   [0m DELETE FROM roles
 WHERE id = 10060
[0m
  [4;36;1mRoleAssignment Load (0.001031)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001458)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000692)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10075
[0m
  [4;35;1mRoleAssignment Load (0.001659)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001277)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002087)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001428)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001054)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000582)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10061, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002070)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10061)
  [4;36;1mSQL (0.001332)[0m   [0;1mselect 'x' from roles where id = 10061 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000579)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10061, 10076, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001687)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002039)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001531)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithCallbacks Load (0.000849)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== FAILED permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: edit Role test role(10061)
  [4;36;1mSQL (0.002090)[0m   [0;1mselect 'x' from roles where id = 10061 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001353)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10061, 10126, NULL, 0, '2008-05-12 22:31:23', 'find', 3)[0m
  [4;36;1mPermission Load (0.002205)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithCallbacks Load (0.001669)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== permission check: find PhonyWithCallbacks phony blog(10007)
=== permission check: destroy Role test role(10061)
  [4;36;1mRole Destroy (0.000519)[0m   [0;1m DELETE FROM roles
 WHERE id = 10061
[0m
  [4;35;1mRoleAssignment Load (0.001685)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000797)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001113)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10076
[0m
  [4;36;1mRoleAssignment Load (0.000978)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002192)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001441)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001052)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000582)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10062, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002075)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10062)
  [4;35;1mSQL (0.001330)[0m   [0mselect 'x' from roles where id = 10062 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000587)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10062, 10077, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001683)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002137)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001548)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: update PhonyWithCallbacks phony blog updated(10007)
=== permission check: edit Role test role(10062)
  [4;36;1mSQL (0.001473)[0m   [0;1mselect 'x' from roles where id = 10062 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000685)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10062, 10127, NULL, 0, '2008-05-12 22:31:23', 'update', 3)[0m
  [4;36;1mPermission Load (0.002979)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: update PhonyWithCallbacks phony blog updated(10007)
  [4;35;1mPhonyWithCallbacks Update (0.006196)[0m   [0mUPDATE blogs SET name = 'phony blog updated', updated_at = '2008-05-12 22:31:23', owner_firm_id = 3, owner_id = 3, created_at = '2008-05-12 22:31:23' WHERE id = 10007[0m
=== permission check: destroy Role test role(10062)
  [4;36;1mRole Destroy (0.001248)[0m   [0;1m DELETE FROM roles
 WHERE id = 10062
[0m
  [4;35;1mRoleAssignment Load (0.001092)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001480)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000434)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10077
[0m
  [4;36;1mRoleAssignment Load (0.001641)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000609)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002940)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000788)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001728)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001255)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10063, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001399)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10063)
  [4;35;1mSQL (0.001998)[0m   [0mselect 'x' from roles where id = 10063 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001244)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10063, 10078, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001018)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002915)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000893)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithCallbacks Load (0.001523)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== FAILED permission check: find PhonyWithCallbacks phony blog updated(10007)
=== permission check: edit Role test role(10063)
  [4;35;1mSQL (0.001430)[0m   [0mselect 'x' from roles where id = 10063 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000685)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10063, 10128, NULL, 0, '2008-05-12 22:31:23', 'find', 3)[0m
  [4;35;1mPermission Load (0.003000)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithCallbacks Load (0.001019)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
=== permission check: find PhonyWithCallbacks phony blog updated(10007)
=== permission check: destroy Role test role(10063)
  [4;35;1mRole Destroy (0.001186)[0m   [0m DELETE FROM roles
 WHERE id = 10063
[0m
  [4;36;1mRoleAssignment Load (0.001017)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001467)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000445)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10078
[0m
  [4;35;1mRoleAssignment Load (0.001642)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000607)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002968)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000795)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001724)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001255)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10064, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001403)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10064)
  [4;36;1mSQL (0.002008)[0m   [0;1mselect 'x' from roles where id = 10064 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001245)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10064, 10079, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001023)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002920)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10064)
  [4;36;1mSQL (0.001588)[0m   [0;1mselect 'x' from roles where id = 10064 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000690)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10064, 10129, NULL, 0, '2008-05-12 22:31:23', 'update', 3)[0m
  [4;36;1mPermission Load (0.002985)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: destroy PhonyWithCallbacks phony blog updated(10007)
=== permission check: destroy Role test role(10064)
  [4;35;1mRole Destroy (0.000675)[0m   [0m DELETE FROM roles
 WHERE id = 10064
[0m
  [4;36;1mRoleAssignment Load (0.001714)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000811)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001116)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10079
[0m
  [4;35;1mRoleAssignment Load (0.000975)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001280)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002306)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001340)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mSQL (0.000675)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001729)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001258)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10065, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001396)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10065)
  [4;35;1mSQL (0.001996)[0m   [0mselect 'x' from roles where id = 10065 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001272)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10065, 10080, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001036)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002938)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000891)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: destroy PhonyWithCallbacks phony blog updated(10007)
=== permission check: edit Role test role(10065)
  [4;36;1mSQL (0.002117)[0m   [0;1mselect 'x' from roles where id = 10065 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001358)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithCallbacks', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10065, 10130, NULL, 0, '2008-05-12 22:31:23', 'destroy', 3)[0m
  [4;36;1mPermission Load (0.002328)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy PhonyWithCallbacks phony blog updated(10007)
  [4;35;1mPhonyWithCallbacks Destroy (0.006525)[0m   [0m DELETE FROM blogs
 WHERE id = 10007
[0m
=== permission check: destroy Role test role(10065)
  [4;36;1mRole Destroy (0.000594)[0m   [0;1m DELETE FROM roles
 WHERE id = 10065
[0m
  [4;35;1mRoleAssignment Load (0.001756)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000809)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001107)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10080
[0m
  [4;36;1mRoleAssignment Load (0.000974)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001279)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002253)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001314)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mPhonyWithCallbacks Load (0.000861)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10007) [0m
  [4;35;1mUser Load (0.001475)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000731)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyWithEponymous Columns (0.001892)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mSQL (0.001295)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mUser Load (0.000817)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001443)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000637)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001375)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001054)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002695)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001319)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10066, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001408)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10066)
  [4;35;1mSQL (0.002028)[0m   [0mselect 'x' from roles where id = 10066 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001255)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10066, 10081, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001032)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002522)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10066)
  [4;35;1mSQL (0.001464)[0m   [0mselect 'x' from roles where id = 10066 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000681)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10066, 10131, NULL, 0, '2008-05-12 22:31:23', 'update', 3)[0m
  [4;35;1mPermission Load (0.002581)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: create PhonyWithEponymous phony blog()
=== permission check: destroy Role test role(10066)
  [4;36;1mRole Destroy (0.000623)[0m   [0;1m DELETE FROM roles
 WHERE id = 10066
[0m
  [4;35;1mRoleAssignment Load (0.001737)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000814)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001104)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10081
[0m
  [4;36;1mRoleAssignment Load (0.000987)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001273)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001848)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001245)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.000628)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001717)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001225)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10067, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001368)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10067)
  [4;36;1mSQL (0.001997)[0m   [0;1mselect 'x' from roles where id = 10067 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001236)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10067, 10082, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;36;1mRole Load (0.000877)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001998)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001321)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000566)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 4, 10083, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001696)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001950)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10067)
  [4;36;1mRole Destroy (0.000639)[0m   [0;1m DELETE FROM roles
 WHERE id = 10067
[0m
  [4;35;1mRoleAssignment Load (0.001083)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001588)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000440)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10082
[0m
  [4;36;1mUser Load (0.001466)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000423)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10083
[0m
  [4;36;1mRoleAssignment Load (0.001650)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000766)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002571)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000710)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001741)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001226)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:23', 10068, 2, 5, '2008-05-12 22:31:23')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001388)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10068)
  [4;35;1mSQL (0.002017)[0m   [0mselect 'x' from roles where id = 10068 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001234)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:23', 10068, 10084, 5, NULL, '2008-05-12 22:31:23', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001024)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002519)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000849)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: create PhonyWithEponymous phony blog()
=== permission check: edit Role test role(10068)
  [4;36;1mSQL (0.002128)[0m   [0;1mselect 'x' from roles where id = 10068 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001331)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:23', NULL, NULL, 10068, 10132, NULL, 0, '2008-05-12 22:31:23', 'create', 3)[0m
  [4;36;1mPermission Load (0.002009)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create PhonyWithEponymous phony blog()
  [4;35;1mPhonyWithEponymous Create (0.000627)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:31:23', 10008, 3, 3, '2008-05-12 22:31:23')[0m
=== permission check: destroy Role test role(10068)
  [4;36;1mRole Destroy (0.001161)[0m   [0;1m DELETE FROM roles
 WHERE id = 10068
[0m
  [4;35;1mRoleAssignment Load (0.001044)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001486)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000468)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10084
[0m
  [4;36;1mRoleAssignment Load (0.001659)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000616)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002645)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000630)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.001343)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001085)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000564)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10069, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002072)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10069)
  [4;36;1mSQL (0.001348)[0m   [0;1mselect 'x' from roles where id = 10069 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000566)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10069, 10085, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001697)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001935)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001515)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithEponymous Load (0.000875)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== FAILED permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: edit Role test role(10069)
  [4;36;1mSQL (0.002103)[0m   [0;1mselect 'x' from roles where id = 10069 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001345)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10069, 10133, NULL, 0, '2008-05-12 22:31:24', 'find', 3)[0m
  [4;36;1mPermission Load (0.002121)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithEponymous Load (0.001662)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: destroy Role test role(10069)
  [4;36;1mRole Destroy (0.000501)[0m   [0;1m DELETE FROM roles
 WHERE id = 10069
[0m
  [4;35;1mRoleAssignment Load (0.001686)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000808)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001102)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10085
[0m
  [4;36;1mRoleAssignment Load (0.000983)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001277)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002093)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001426)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001062)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000565)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10070, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002071)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10070)
  [4;35;1mSQL (0.001337)[0m   [0mselect 'x' from roles where id = 10070 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000565)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10070, 10086, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001691)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002045)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001534)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithEponymous Load (0.000855)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== FAILED permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: edit Role test role(10070)
  [4;35;1mSQL (0.002098)[0m   [0mselect 'x' from roles where id = 10070 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001349)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10070, 10134, NULL, 0, '2008-05-12 22:31:24', 'find', 3)[0m
  [4;35;1mPermission Load (0.002113)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithEponymous Load (0.001662)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: destroy Role test role(10070)
  [4;35;1mRole Destroy (0.000504)[0m   [0m DELETE FROM roles
 WHERE id = 10070
[0m
  [4;36;1mRoleAssignment Load (0.001664)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001470)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001097)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10086
[0m
  [4;35;1mRoleAssignment Load (0.000975)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001278)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002084)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001433)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001056)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000558)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10071, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002071)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10071)
  [4;36;1mSQL (0.001338)[0m   [0;1mselect 'x' from roles where id = 10071 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000563)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10071, 10087, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001686)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002032)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10071)
  [4;36;1mSQL (0.002202)[0m   [0;1mselect 'x' from roles where id = 10071 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001338)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10071, 10135, NULL, 0, '2008-05-12 22:31:24', 'create', 3)[0m
  [4;36;1mPermission Load (0.002099)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001619)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000737)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: update PhonyWithEponymous phony blog updated(10008)
=== permission check: destroy Role test role(10071)
  [4;35;1mRole Destroy (0.001202)[0m   [0m DELETE FROM roles
 WHERE id = 10071
[0m
  [4;36;1mRoleAssignment Load (0.001032)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001457)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000690)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10087
[0m
  [4;35;1mRoleAssignment Load (0.001661)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000614)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002750)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000758)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001721)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001250)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10072, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001402)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10072)
  [4;36;1mSQL (0.002002)[0m   [0;1mselect 'x' from roles where id = 10072 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001244)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10072, 10088, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001019)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002702)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000857)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithEponymous Load (0.001520)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== FAILED permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: edit Role test role(10072)
  [4;36;1mSQL (0.001425)[0m   [0;1mselect 'x' from roles where id = 10072 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000683)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10072, 10136, NULL, 0, '2008-05-12 22:31:24', 'find', 3)[0m
  [4;36;1mPermission Load (0.002865)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithEponymous Load (0.001001)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== permission check: find PhonyWithEponymous phony blog(10008)
=== permission check: destroy Role test role(10072)
  [4;36;1mRole Destroy (0.001188)[0m   [0;1m DELETE FROM roles
 WHERE id = 10072
[0m
  [4;35;1mRoleAssignment Load (0.001019)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001461)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000448)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10088
[0m
  [4;36;1mRoleAssignment Load (0.001645)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000606)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002859)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000773)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001720)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001252)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10073, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001399)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10073)
  [4;35;1mSQL (0.002006)[0m   [0mselect 'x' from roles where id = 10073 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001249)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10073, 10089, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001017)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002809)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000883)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: update PhonyWithEponymous phony blog updated(10008)
=== permission check: edit Role test role(10073)
  [4;36;1mSQL (0.002139)[0m   [0;1mselect 'x' from roles where id = 10073 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001353)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10073, 10137, NULL, 0, '2008-05-12 22:31:24', 'update', 3)[0m
  [4;36;1mPermission Load (0.002211)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: update PhonyWithEponymous phony blog updated(10008)
  [4;35;1mPhonyWithEponymous Update (0.001498)[0m   [0mUPDATE blogs SET name = 'phony blog updated', updated_at = '2008-05-12 22:31:24', owner_firm_id = 3, owner_id = 3, created_at = '2008-05-12 22:31:23' WHERE id = 10008[0m
=== permission check: destroy Role test role(10073)
  [4;36;1mRole Destroy (0.000487)[0m   [0;1m DELETE FROM roles
 WHERE id = 10073
[0m
  [4;35;1mRoleAssignment Load (0.001728)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000805)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001110)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10089
[0m
  [4;36;1mRoleAssignment Load (0.000978)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002184)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001441)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001050)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000584)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10074, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002066)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10074)
  [4;35;1mSQL (0.001336)[0m   [0mselect 'x' from roles where id = 10074 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000581)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10074, 10090, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001683)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002133)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001543)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithEponymous Load (0.000853)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== FAILED permission check: find PhonyWithEponymous phony blog updated(10008)
=== permission check: edit Role test role(10074)
  [4;35;1mSQL (0.002089)[0m   [0mselect 'x' from roles where id = 10074 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001351)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10074, 10138, NULL, 0, '2008-05-12 22:31:24', 'find', 3)[0m
  [4;35;1mPermission Load (0.002208)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithEponymous Load (0.001675)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
=== permission check: find PhonyWithEponymous phony blog updated(10008)
=== permission check: destroy Role test role(10074)
  [4;35;1mRole Destroy (0.000564)[0m   [0m DELETE FROM roles
 WHERE id = 10074
[0m
  [4;36;1mRoleAssignment Load (0.001695)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000794)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001105)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10090
[0m
  [4;35;1mRoleAssignment Load (0.000976)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001277)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002185)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001460)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001055)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000586)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10075, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002061)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10075)
  [4;36;1mSQL (0.001340)[0m   [0;1mselect 'x' from roles where id = 10075 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000579)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10075, 10091, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001685)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002139)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10075)
  [4;36;1mSQL (0.002235)[0m   [0;1mselect 'x' from roles where id = 10075 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001359)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10075, 10139, NULL, 0, '2008-05-12 22:31:24', 'update', 3)[0m
  [4;36;1mPermission Load (0.002312)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: destroy PhonyWithEponymous phony blog updated(10008)
=== permission check: destroy Role test role(10075)
  [4;35;1mRole Destroy (0.001346)[0m   [0m DELETE FROM roles
 WHERE id = 10075
[0m
  [4;36;1mRoleAssignment Load (0.001047)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001476)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000449)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10091
[0m
  [4;35;1mRoleAssignment Load (0.001647)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000606)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002977)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000642)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mSQL (0.001339)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001056)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000583)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10076, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002063)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10076)
  [4;35;1mSQL (0.001325)[0m   [0mselect 'x' from roles where id = 10076 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000577)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10076, 10092, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001686)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002246)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001558)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: destroy PhonyWithEponymous phony blog updated(10008)
=== permission check: edit Role test role(10076)
  [4;36;1mSQL (0.001450)[0m   [0;1mselect 'x' from roles where id = 10076 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000696)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithEponymous', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10076, 10140, NULL, 0, '2008-05-12 22:31:24', 'destroy', 3)[0m
  [4;36;1mPermission Load (0.003027)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy PhonyWithEponymous phony blog updated(10008)
  [4;35;1mPhonyWithEponymous Destroy (0.000715)[0m   [0m DELETE FROM blogs
 WHERE id = 10008
[0m
=== permission check: destroy Role test role(10076)
  [4;36;1mRole Destroy (0.001128)[0m   [0;1m DELETE FROM roles
 WHERE id = 10076
[0m
  [4;35;1mRoleAssignment Load (0.001038)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001471)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000436)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10092
[0m
  [4;36;1mRoleAssignment Load (0.001642)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000607)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002966)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000647)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mPhonyWithEponymous Load (0.001526)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10008) [0m
  [4;35;1mUser Load (0.001456)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000720)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyWithForAction Columns (0.001886)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mSQL (0.001290)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mUser Load (0.000809)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001437)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000635)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001376)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001055)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002701)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001325)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10077, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001406)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10077)
  [4;35;1mSQL (0.002028)[0m   [0mselect 'x' from roles where id = 10077 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001256)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10077, 10093, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001026)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002508)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10077)
  [4;35;1mSQL (0.001471)[0m   [0mselect 'x' from roles where id = 10077 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000683)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10077, 10141, NULL, 0, '2008-05-12 22:31:24', 'update', 3)[0m
  [4;35;1mPermission Load (0.002684)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: create PhonyWithForAction phony blog()
=== permission check: destroy Role test role(10077)
  [4;36;1mRole Destroy (0.000651)[0m   [0;1m DELETE FROM roles
 WHERE id = 10077
[0m
  [4;35;1mRoleAssignment Load (0.001730)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000810)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001105)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10093
[0m
  [4;36;1mRoleAssignment Load (0.000981)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001281)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001963)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001269)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.000632)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001719)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001226)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10078, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001382)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10078)
  [4;36;1mSQL (0.001994)[0m   [0;1mselect 'x' from roles where id = 10078 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001231)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10078, 10094, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRole Load (0.000883)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001975)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001311)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000556)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 4, 10095, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001692)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002023)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10078)
  [4;36;1mRole Destroy (0.001276)[0m   [0;1m DELETE FROM roles
 WHERE id = 10078
[0m
  [4;35;1mRoleAssignment Load (0.001056)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001472)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000433)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10094
[0m
  [4;36;1mUser Load (0.001452)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000414)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10095
[0m
  [4;36;1mRoleAssignment Load (0.001643)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000606)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002623)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000723)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001725)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001229)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10079, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001385)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10079)
  [4;35;1mSQL (0.002004)[0m   [0mselect 'x' from roles where id = 10079 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001230)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10079, 10096, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001019)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002602)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000864)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: create PhonyWithForAction phony blog()
=== permission check: edit Role test role(10079)
  [4;36;1mSQL (0.002127)[0m   [0;1mselect 'x' from roles where id = 10079 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001336)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10079, 10142, NULL, 0, '2008-05-12 22:31:24', 'create', 3)[0m
  [4;36;1mPermission Load (0.002103)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create PhonyWithForAction phony blog()
  [4;35;1mPhonyWithForAction Create (0.000643)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:31:24', 10009, 3, 3, '2008-05-12 22:31:24')[0m
=== permission check: destroy Role test role(10079)
  [4;36;1mRole Destroy (0.001156)[0m   [0;1m DELETE FROM roles
 WHERE id = 10079
[0m
  [4;35;1mRoleAssignment Load (0.001039)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001474)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000429)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10096
[0m
  [4;36;1mRoleAssignment Load (0.001646)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000610)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002740)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000640)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mSQL (0.001334)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001054)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000578)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10080, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002083)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10080)
  [4;36;1mSQL (0.001357)[0m   [0;1mselect 'x' from roles where id = 10080 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000580)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10080, 10097, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001697)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002037)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001548)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithForAction Load (0.000874)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== FAILED permission check: find PhonyWithForAction phony blog(10009)
=== permission check: edit Role test role(10080)
  [4;36;1mSQL (0.002104)[0m   [0;1mselect 'x' from roles where id = 10080 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001348)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10080, 10143, NULL, 0, '2008-05-12 22:31:24', 'find', 3)[0m
  [4;36;1mPermission Load (0.002113)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithForAction Load (0.001652)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== permission check: find PhonyWithForAction phony blog(10009)
=== permission check: destroy Role test role(10080)
  [4;36;1mRole Destroy (0.000503)[0m   [0;1m DELETE FROM roles
 WHERE id = 10080
[0m
  [4;35;1mRoleAssignment Load (0.001689)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000802)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001099)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10097
[0m
  [4;36;1mRoleAssignment Load (0.000978)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001275)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002093)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001418)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001049)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000561)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10081, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002063)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10081)
  [4;35;1mSQL (0.001326)[0m   [0mselect 'x' from roles where id = 10081 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000563)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10081, 10098, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001687)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002036)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001531)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithForAction Load (0.000854)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== FAILED permission check: find PhonyWithForAction phony blog(10009)
=== permission check: edit Role test role(10081)
  [4;35;1mSQL (0.002086)[0m   [0mselect 'x' from roles where id = 10081 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001339)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10081, 10144, NULL, 0, '2008-05-12 22:31:24', 'find', 3)[0m
  [4;35;1mPermission Load (0.002212)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithForAction Load (0.001677)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== permission check: find PhonyWithForAction phony blog(10009)
=== permission check: destroy Role test role(10081)
  [4;35;1mRole Destroy (0.001253)[0m   [0m DELETE FROM roles
 WHERE id = 10081
[0m
  [4;36;1mRoleAssignment Load (0.001716)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000820)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001107)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10098
[0m
  [4;35;1mRoleAssignment Load (0.000990)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001478)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002349)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001473)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001081)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000606)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10082, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002086)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10082)
  [4;36;1mSQL (0.001346)[0m   [0;1mselect 'x' from roles where id = 10082 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000572)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10082, 10099, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001699)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002152)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10082)
  [4;36;1mSQL (0.002244)[0m   [0;1mselect 'x' from roles where id = 10082 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001341)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10082, 10145, NULL, 0, '2008-05-12 22:31:24', 'create', 3)[0m
  [4;36;1mPermission Load (0.002334)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001658)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000748)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: update PhonyWithForAction phony blog updated(10009)
=== permission check: destroy Role test role(10082)
  [4;35;1mRole Destroy (0.001214)[0m   [0m DELETE FROM roles
 WHERE id = 10082
[0m
  [4;36;1mRoleAssignment Load (0.001047)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001475)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000701)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10099
[0m
  [4;35;1mRoleAssignment Load (0.001673)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000614)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002981)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000807)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001759)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001257)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10083, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001427)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10083)
  [4;36;1mSQL (0.002019)[0m   [0;1mselect 'x' from roles where id = 10083 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001268)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10083, 10100, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001046)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002950)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000905)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mPhonyWithForAction Load (0.001528)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== FAILED permission check: find PhonyWithForAction phony blog(10009)
=== permission check: edit Role test role(10083)
  [4;36;1mSQL (0.001452)[0m   [0;1mselect 'x' from roles where id = 10083 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000696)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10083, 10146, NULL, 0, '2008-05-12 22:31:24', 'find', 3)[0m
  [4;36;1mPermission Load (0.003003)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyWithForAction Load (0.001027)[0m   [0mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== permission check: find PhonyWithForAction phony blog(10009)
=== permission check: destroy Role test role(10083)
  [4;36;1mRole Destroy (0.001194)[0m   [0;1m DELETE FROM roles
 WHERE id = 10083
[0m
  [4;35;1mRoleAssignment Load (0.001031)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001472)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000440)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10100
[0m
  [4;36;1mRoleAssignment Load (0.001651)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000610)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002988)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000795)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001742)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001255)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10084, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001411)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10084)
  [4;35;1mSQL (0.002006)[0m   [0mselect 'x' from roles where id = 10084 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001247)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10084, 10101, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001030)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002923)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000903)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: update PhonyWithForAction phony blog updated(10009)
=== permission check: edit Role test role(10084)
  [4;36;1mSQL (0.002153)[0m   [0;1mselect 'x' from roles where id = 10084 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001366)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10084, 10147, NULL, 0, '2008-05-12 22:31:24', 'update', 3)[0m
  [4;36;1mPermission Load (0.002343)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: update PhonyWithForAction phony blog updated(10009)
  [4;35;1mPhonyWithForAction Update (0.001489)[0m   [0mUPDATE blogs SET name = 'phony blog updated', updated_at = '2008-05-12 22:31:24', owner_firm_id = 3, owner_id = 3, created_at = '2008-05-12 22:31:24' WHERE id = 10009[0m
=== permission check: destroy Role test role(10084)
  [4;36;1mRole Destroy (0.000485)[0m   [0;1m DELETE FROM roles
 WHERE id = 10084
[0m
  [4;35;1mRoleAssignment Load (0.001729)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000812)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001105)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10101
[0m
  [4;36;1mRoleAssignment Load (0.000991)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001279)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002307)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001464)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001058)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000587)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10085, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002084)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10085)
  [4;35;1mSQL (0.001332)[0m   [0mselect 'x' from roles where id = 10085 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000577)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10085, 10102, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001691)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002253)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001561)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithForAction Load (0.000854)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== FAILED permission check: find PhonyWithForAction phony blog updated(10009)
=== permission check: edit Role test role(10085)
  [4;35;1mSQL (0.002105)[0m   [0mselect 'x' from roles where id = 10085 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001361)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:24', NULL, NULL, 10085, 10148, NULL, 0, '2008-05-12 22:31:24', 'find', 3)[0m
  [4;35;1mPermission Load (0.002326)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyWithForAction Load (0.001696)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
=== permission check: find PhonyWithForAction phony blog updated(10009)
=== permission check: destroy Role test role(10085)
  [4;35;1mRole Destroy (0.000520)[0m   [0m DELETE FROM roles
 WHERE id = 10085
[0m
  [4;36;1mRoleAssignment Load (0.001695)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000801)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001107)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10102
[0m
  [4;35;1mRoleAssignment Load (0.000979)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001275)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002303)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001466)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001059)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000582)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:24', 10086, 2, 5, '2008-05-12 22:31:24')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002072)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10086)
  [4;36;1mSQL (0.001335)[0m   [0;1mselect 'x' from roles where id = 10086 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000581)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:24', 10086, 10103, 5, NULL, '2008-05-12 22:31:24', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001687)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002260)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10086)
  [4;36;1mSQL (0.002249)[0m   [0;1mselect 'x' from roles where id = 10086 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001373)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10086, 10149, NULL, 0, '2008-05-12 22:31:25', 'update', 3)[0m
  [4;36;1mPermission Load (0.002325)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== FAILED permission check: destroy PhonyWithForAction phony blog updated(10009)
=== permission check: destroy Role test role(10086)
  [4;35;1mRole Destroy (0.001344)[0m   [0m DELETE FROM roles
 WHERE id = 10086
[0m
  [4;36;1mRoleAssignment Load (0.001045)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001475)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000437)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10103
[0m
  [4;35;1mRoleAssignment Load (0.001648)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000609)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002998)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000664)[0m   [0;1mSELECT count(*) AS count_all FROM blogs [0m
  [4;35;1mSQL (0.001342)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001051)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000579)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10087, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002066)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10087)
  [4;35;1mSQL (0.001353)[0m   [0mselect 'x' from roles where id = 10087 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000576)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10087, 10104, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001690)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002250)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001561)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: destroy PhonyWithForAction phony blog updated(10009)
=== permission check: edit Role test role(10087)
  [4;36;1mSQL (0.001454)[0m   [0;1mselect 'x' from roles where id = 10087 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000700)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithForAction', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10087, 10150, NULL, 0, '2008-05-12 22:31:25', 'destroy', 3)[0m
  [4;36;1mPermission Load (0.003005)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy PhonyWithForAction phony blog updated(10009)
  [4;35;1mPhonyWithForAction Destroy (0.000728)[0m   [0m DELETE FROM blogs
 WHERE id = 10009
[0m
=== permission check: destroy Role test role(10087)
  [4;36;1mRole Destroy (0.001129)[0m   [0;1m DELETE FROM roles
 WHERE id = 10087
[0m
  [4;35;1mRoleAssignment Load (0.001053)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001473)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000437)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10104
[0m
  [4;36;1mRoleAssignment Load (0.001652)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000608)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002982)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000643)[0m   [0mSELECT count(*) AS count_all FROM blogs [0m
  [4;36;1mPhonyWithForAction Load (0.001531)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 10009) [0m
  [4;35;1mUser Load (0.001462)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000723)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyNeverPermits Columns (0.001888)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;36;1mPhonyNeverPermits Create (0.000639)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:31:25', 10010, 3, 3, '2008-05-12 22:31:25')[0m
  [4;35;1mUser Load (0.001485)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
=== FAILED permission check: forbidden_operation PhonyNeverPermits phony blog(10010)
  [4;36;1mUser Load (0.000796)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001438)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001319)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000718)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001725)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002028)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000649)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10088, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002074)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10088)
  [4;36;1mSQL (0.001354)[0m   [0;1mselect 'x' from roles where id = 10088 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000589)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10088, 10105, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;36;1mRole Load (0.001541)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001312)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;36;1mSQL (0.001981)[0m   [0;1mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001224)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 4, 10106, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001021)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002594)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mBlog Load (0.000942)[0m   [0;1mSELECT * FROM blogs WHERE (blogs.id = 1) [0m
=== FAILED permission check: change_post Blog mertz family blog(1)
=== permission check: destroy Role test role(10088)
  [4;35;1mRole Destroy (0.001201)[0m   [0m DELETE FROM roles
 WHERE id = 10088
[0m
  [4;36;1mRoleAssignment Load (0.001051)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001467)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000436)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10105
[0m
  [4;35;1mUser Load (0.001459)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000415)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10106
[0m
  [4;35;1mRoleAssignment Load (0.001642)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000605)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002515)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000694)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001721)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001231)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10089, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001373)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10089)
  [4;36;1mSQL (0.001994)[0m   [0;1mselect 'x' from roles where id = 10089 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001239)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10089, 10107, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001014)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002504)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000836)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_post Blog mertz family blog(1)
=== permission check: edit Role test role(10089)
  [4;35;1mSQL (0.002091)[0m   [0mselect 'x' from roles where id = 10089 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001357)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Blog', 0, 0, '2008-05-12 22:31:25', 1, 'mertz family blog', 10089, 10151, NULL, 0, '2008-05-12 22:31:25', 'change_post', NULL)[0m
  [4;35;1mPermission Load (0.002016)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_post Blog mertz family blog(1)
=== permission check: change_post Blog mertz family blog(1)
=== permission check: destroy Role test role(10089)
  [4;36;1mRole Destroy (0.001284)[0m   [0;1m DELETE FROM roles
 WHERE id = 10089
[0m
  [4;35;1mRoleAssignment Load (0.001056)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001472)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000431)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10107
[0m
  [4;36;1mRoleAssignment Load (0.001652)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000609)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002626)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000892)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001441)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000629)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001392)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001053)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002689)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001322)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10090, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001391)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10090)
  [4;35;1mSQL (0.001993)[0m   [0mselect 'x' from roles where id = 10090 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001239)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10090, 10108, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001022)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002511)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000815)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mPhonyWithInitSet Columns (0.001918)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
=== FAILED permission check: priv PhonyWithInitSet X()
=== permission check: edit Role test role(10090)
  [4;35;1mSQL (0.002154)[0m   [0mselect 'x' from roles where id = 10090 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001356)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10090, 10152, NULL, 0, '2008-05-12 22:31:25', 'priv', NULL)[0m
  [4;35;1mPermission Load (0.001915)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet X()
=== permission check: destroy Role test role(10090)
  [4;36;1mRole Destroy (0.001246)[0m   [0;1m DELETE FROM roles
 WHERE id = 10090
[0m
  [4;35;1mRoleAssignment Load (0.001045)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001478)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000432)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10108
[0m
  [4;36;1mRoleAssignment Load (0.001650)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000605)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002521)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000686)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001726)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001221)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10091, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001366)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10091)
  [4;35;1mSQL (0.002000)[0m   [0mselect 'x' from roles where id = 10091 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001235)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10091, 10109, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001026)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002499)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000816)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet X()
=== permission check: edit Role test role(10091)
  [4;36;1mSQL (0.002059)[0m   [0;1mselect 'x' from roles where id = 10091 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001326)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10091, 10153, NULL, 0, '2008-05-12 22:31:25', 'priv', NULL)[0m
  [4;36;1mPermission Load (0.001902)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet X()
=== permission check: destroy Role test role(10091)
  [4;35;1mRole Destroy (0.001236)[0m   [0m DELETE FROM roles
 WHERE id = 10091
[0m
  [4;36;1mRoleAssignment Load (0.001040)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001476)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000432)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10109
[0m
  [4;35;1mRoleAssignment Load (0.001645)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000607)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002522)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000692)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001730)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001225)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10092, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001368)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10092)
  [4;36;1mSQL (0.002000)[0m   [0;1mselect 'x' from roles where id = 10092 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001231)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10092, 10110, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001024)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002504)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000806)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet X()
=== permission check: edit Role test role(10092)
  [4;35;1mSQL (0.002063)[0m   [0mselect 'x' from roles where id = 10092 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001328)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10092, 10154, NULL, 0, '2008-05-12 22:31:25', 'priv', NULL)[0m
  [4;35;1mPermission Load (0.001900)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet X()
=== permission check: priv PhonyWithInitSet X()
=== permission check: destroy Role test role(10092)
  [4;36;1mRole Destroy (0.001240)[0m   [0;1m DELETE FROM roles
 WHERE id = 10092
[0m
  [4;35;1mRoleAssignment Load (0.001037)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001471)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000429)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10110
[0m
  [4;36;1mRoleAssignment Load (0.001652)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000605)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002519)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000857)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.001385)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyWithInitSet Create (0.001258)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony blog', '2008-05-12 22:31:25', 10011, 3, 3, '2008-05-12 22:31:25')[0m
  [4;36;1mSQL (0.000660)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001721)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001172)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10093, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001361)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10093)
  [4;36;1mSQL (0.001995)[0m   [0;1mselect 'x' from roles where id = 10093 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001230)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10093, 10111, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001022)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002509)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000807)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: edit Role test role(10093)
  [4;35;1mSQL (0.002058)[0m   [0mselect 'x' from roles where id = 10093 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001327)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10093, 10155, NULL, 0, '2008-05-12 22:31:25', 'priv', NULL)[0m
  [4;35;1mPermission Load (0.002000)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: destroy Role test role(10093)
  [4;36;1mRole Destroy (0.001271)[0m   [0;1m DELETE FROM roles
 WHERE id = 10093
[0m
  [4;35;1mRoleAssignment Load (0.001047)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001477)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000429)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10111
[0m
  [4;36;1mRoleAssignment Load (0.001644)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000614)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002637)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000722)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001732)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001228)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10094, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001381)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10094)
  [4;35;1mSQL (0.002003)[0m   [0mselect 'x' from roles where id = 10094 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001234)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10094, 10112, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001025)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002600)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000835)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: edit Role test role(10094)
  [4;36;1mSQL (0.002081)[0m   [0;1mselect 'x' from roles where id = 10094 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001332)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10094, 10156, NULL, 0, '2008-05-12 22:31:25', 'priv', NULL)[0m
  [4;36;1mPermission Load (0.002101)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: destroy Role test role(10094)
  [4;35;1mRole Destroy (0.001304)[0m   [0m DELETE FROM roles
 WHERE id = 10094
[0m
  [4;36;1mRoleAssignment Load (0.001054)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001478)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000438)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10112
[0m
  [4;35;1mRoleAssignment Load (0.001649)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000605)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002751)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000744)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001725)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001231)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10095, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001389)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10095)
  [4;36;1mSQL (0.001997)[0m   [0;1mselect 'x' from roles where id = 10095 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001241)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10095, 10113, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001025)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002705)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000862)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: edit Role test role(10095)
  [4;35;1mSQL (0.002114)[0m   [0mselect 'x' from roles where id = 10095 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001339)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyWithInitSet', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10095, 10157, NULL, 0, '2008-05-12 22:31:25', 'priv', NULL)[0m
  [4;35;1mPermission Load (0.002115)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: priv PhonyWithInitSet phony blog(10011)
=== permission check: destroy Role test role(10095)
  [4;36;1mRole Destroy (0.001324)[0m   [0;1m DELETE FROM roles
 WHERE id = 10095
[0m
  [4;35;1mRoleAssignment Load (0.001053)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001480)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000534)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10113
[0m
  [4;36;1mRoleAssignment Load (0.001016)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001433)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002849)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000906)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mPhonyWithDefaults Columns (0.001940)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
  [4;35;1mFirm Load (0.001481)[0m   [0mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;36;1mFirm Load (0.000751)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mUser Load (0.001446)[0m   [0mSELECT * FROM users WHERE (users.id = 1) [0m
  [4;36;1mFirm Load (0.000706)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mUser Load (0.001535)[0m   [0mSELECT * FROM users WHERE (users.id = 1) [0m
  [4;36;1mFirm Load (0.000713)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mUser Load (0.001464)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000772)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001324)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000713)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001727)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002030)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000640)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10096, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002083)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10096)
  [4;35;1mSQL (0.001340)[0m   [0mselect 'x' from roles where id = 10096 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000575)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10096, 10114, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001696)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001846)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRoleAssignment Load (0.007010)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.id = 2) [0m
  [4;36;1mUser Load (0.000876)[0m   [0;1mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;35;1mUser Load (0.001441)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
  [4;36;1mSQL (0.001451)[0m   [0;1mselect 'x' from roles where id = 10096 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001599)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10096) [0m
  [4;36;1mPermission Create (0.001335)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('User', 0, 0, '2008-05-12 22:31:25', 4, 'ricky', 10096, 10158, NULL, 0, '2008-05-12 22:31:25', 'administer', NULL)[0m
  [4;35;1mPermission Load (0.002038)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10096)
  [4;36;1mRole Destroy (0.001284)[0m   [0;1m DELETE FROM roles
 WHERE id = 10096
[0m
  [4;35;1mRoleAssignment Load (0.001052)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001488)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000445)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10114
[0m
  [4;36;1mRoleAssignment Load (0.001653)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000615)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002636)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.000882)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001445)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000635)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001388)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001071)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002690)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001301)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10097, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001401)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10097)
  [4;35;1mSQL (0.002003)[0m   [0mselect 'x' from roles where id = 10097 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001245)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10097, 10115, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRole Load (0.000871)[0m   [0mSELECT * FROM roles WHERE (roles.id = 4) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001977)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role universal_grant(4)
  [4;35;1mSQL (0.001322)[0m   [0mselect 'x' from roles where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000555)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 4, 10116, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001701)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001934)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyReqPermEntry Columns (0.001972)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOG_ENTRIES'
 order by column_id
[0m
  [4;36;1mSQL (0.001493)[0m   [0;1mselect 'x' from roles where id = 10097 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.001585)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10097) [0m
  [4;36;1mPermission Create (0.001341)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyReqPermEntry', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10097, 10159, NULL, 0, '2008-05-12 22:31:25', 'blurt', NULL)[0m
  [4;35;1mPermission Load (0.002104)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.002234)[0m   [0;1mselect 'x' from roles where id = 10097 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRole Load (0.000898)[0m   [0mSELECT * FROM roles WHERE (roles.id = 10097) [0m
  [4;36;1mPermission Create (0.000676)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyReqPermBlog', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10097, 10160, NULL, 0, '2008-05-12 22:31:25', 'bloviate', NULL)[0m
  [4;35;1mPermission Load (0.002810)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mPhonyReqPermComment Columns (0.001320)[0m   [0;1m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'ENTRY_COMMENTS'
 order by column_id
[0m
=== permission check: destroy Role test role(10097)
  [4;35;1mRole Destroy (0.000534)[0m   [0m DELETE FROM roles
 WHERE id = 10097
[0m
  [4;36;1mRoleAssignment Load (0.001740)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000805)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001106)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10115
[0m
  [4;35;1mUser Load (0.000794)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001085)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10116
[0m
  [4;35;1mRoleAssignment Load (0.000981)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001280)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001976)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001542)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mUser Load (0.000800)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001437)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000631)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001397)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001074)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002694)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001333)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10098, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001411)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10098)
  [4;35;1mSQL (0.002025)[0m   [0mselect 'x' from roles where id = 10098 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001255)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10098, 10117, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001027)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002509)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000833)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mFirm Load (0.001408)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mPhonyBlog Columns (0.001244)[0m   [0m select column_name as name, data_type as sql_type, data_default, nullable,
 decode(data_type, 'NUMBER', data_precision,
 'FLOAT', data_precision,
 'VARCHAR2', data_length,
 'CHAR', data_length,
 null) as limit,
 decode(data_type, 'NUMBER', data_scale, null) as scale
 from all_tab_columns
 where owner = 'RAILS_RST_TEST'
 and table_name = 'BLOGS'
 order by column_id
[0m
=== FAILED permission check: change_name PhonyBlog X()
=== permission check: edit Role test role(10098)
  [4;36;1mSQL (0.002168)[0m   [0;1mselect 'x' from roles where id = 10098 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001360)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10098, 10161, NULL, 0, '2008-05-12 22:31:25', 'change_name', 3)[0m
  [4;36;1mPermission Load (0.001927)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_name PhonyBlog X()
=== permission check: change_name PhonyBlog X()
  [4;35;1mPhonyBlog Create (0.000609)[0m   [0mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('phony', '2008-05-12 22:31:25', 10012, 3, 3, '2008-05-12 22:31:25')[0m
=== permission check: destroy Role test role(10098)
  [4;36;1mRole Destroy (0.001151)[0m   [0;1m DELETE FROM roles
 WHERE id = 10098
[0m
  [4;35;1mRoleAssignment Load (0.001041)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001482)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000442)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10117
[0m
  [4;36;1mRoleAssignment Load (0.001656)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000613)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002541)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000676)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001741)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001233)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10099, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001388)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10099)
  [4;35;1mSQL (0.002030)[0m   [0mselect 'x' from roles where id = 10099 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001246)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10099, 10118, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001028)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002504)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001461)[0m   [0mselect 'x' from roles where id = 10099 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRole Load (0.001573)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 10099) [0m
  [4;35;1mPermission Create (0.001324)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:25', 10012, 'phony', 10099, 10162, NULL, 0, '2008-05-12 22:31:25', 'grubbitz', NULL)[0m
  [4;36;1mPermission Load (0.002014)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPermission Load (0.002813)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 3
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: destroy Role test role(10099)
  [4;36;1mRole Destroy (0.000588)[0m   [0;1m DELETE FROM roles
 WHERE id = 10099
[0m
  [4;35;1mRoleAssignment Load (0.001701)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000802)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001096)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10118
[0m
  [4;36;1mRoleAssignment Load (0.000974)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001276)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001958)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001541)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mFirm Load (0.000734)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
  [4;35;1mUser Load (0.001477)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000769)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001299)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000703)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001717)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002040)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000645)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:25', 10100, 2, 5, '2008-05-12 22:31:25')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002075)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10100)
  [4;35;1mSQL (0.001332)[0m   [0mselect 'x' from roles where id = 10100 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000579)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:25', 10100, 10119, 5, NULL, '2008-05-12 22:31:25', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001691)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001840)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001505)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: change_name PhonyBlog X()
=== permission check: edit Role test role(10100)
  [4;36;1mSQL (0.001398)[0m   [0;1mselect 'x' from roles where id = 10100 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000677)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:25', NULL, NULL, 10100, 10163, NULL, 0, '2008-05-12 22:31:25', 'change_name', 3)[0m
  [4;36;1mPermission Load (0.002679)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_name PhonyBlog X()
=== permission check: change_name PhonyBlog X()
=== permission check: destroy Role test role(10100)
  [4;35;1mRole Destroy (0.000604)[0m   [0m DELETE FROM roles
 WHERE id = 10100
[0m
  [4;36;1mRoleAssignment Load (0.001709)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000804)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001100)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10119
[0m
  [4;35;1mRoleAssignment Load (0.000978)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001278)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001964)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.001539)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mUser Load (0.000799)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.001442)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.000628)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.001381)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001054)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002681)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001316)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10101, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001389)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10101)
  [4;35;1mSQL (0.002002)[0m   [0mselect 'x' from roles where id = 10101 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001262)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10101, 10120, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001034)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002534)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000819)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mFirm Load (0.001399)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: grubbitz PhonyBlog X()
=== permission check: edit Role test role(10101)
  [4;35;1mSQL (0.001404)[0m   [0mselect 'x' from roles where id = 10101 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000672)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:26', NULL, NULL, 10101, 10164, NULL, 0, '2008-05-12 22:31:26', 'grubbitz', 3)[0m
  [4;35;1mPermission Load (0.002569)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grubbitz PhonyBlog X()
=== permission check: destroy Role test role(10101)
  [4;36;1mRole Destroy (0.000582)[0m   [0;1m DELETE FROM roles
 WHERE id = 10101
[0m
  [4;35;1mRoleAssignment Load (0.001719)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000810)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001099)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10120
[0m
  [4;36;1mRoleAssignment Load (0.000977)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001272)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001841)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001361)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001054)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000557)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10102, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002035)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10102)
  [4;35;1mSQL (0.001326)[0m   [0mselect 'x' from roles where id = 10102 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000561)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10102, 10121, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001686)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001833)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001480)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grubbitz PhonyBlog X()
=== permission check: edit Role test role(10102)
  [4;36;1mSQL (0.001387)[0m   [0;1mselect 'x' from roles where id = 10102 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000657)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:26', NULL, NULL, 10102, 10165, NULL, 0, '2008-05-12 22:31:26', 'grubbitz', 3)[0m
  [4;36;1mPermission Load (0.002661)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grubbitz PhonyBlog X()
=== permission check: destroy Role test role(10102)
  [4;35;1mRole Destroy (0.000597)[0m   [0m DELETE FROM roles
 WHERE id = 10102
[0m
  [4;36;1mRoleAssignment Load (0.001706)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000807)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001095)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10121
[0m
  [4;35;1mRoleAssignment Load (0.000984)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001275)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001957)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001399)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001054)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000560)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10103, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002045)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10103)
  [4;36;1mSQL (0.001325)[0m   [0;1mselect 'x' from roles where id = 10103 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000562)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10103, 10122, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001680)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001932)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001508)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grabbitz PhonyBlog X()
=== permission check: edit Role test role(10103)
  [4;35;1mSQL (0.001405)[0m   [0mselect 'x' from roles where id = 10103 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.000673)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:26', NULL, NULL, 10103, 10166, NULL, 0, '2008-05-12 22:31:26', 'grabbitz', 3)[0m
  [4;35;1mPermission Load (0.002760)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grabbitz PhonyBlog X()
=== permission check: grabbitz PhonyBlog X()
=== permission check: destroy Role test role(10103)
  [4;36;1mRole Destroy (0.000614)[0m   [0;1m DELETE FROM roles
 WHERE id = 10103
[0m
  [4;35;1mRoleAssignment Load (0.001709)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000806)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001107)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10122
[0m
  [4;36;1mRoleAssignment Load (0.000974)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001275)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002076)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001420)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001055)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000560)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10104, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002060)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10104)
  [4;35;1mSQL (0.001322)[0m   [0mselect 'x' from roles where id = 10104 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000568)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10104, 10123, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001691)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002042)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001530)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grabbitz PhonyBlog X()
=== permission check: edit Role test role(10104)
  [4;36;1mSQL (0.001429)[0m   [0;1mselect 'x' from roles where id = 10104 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.000664)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:26', NULL, NULL, 10104, 10167, NULL, 0, '2008-05-12 22:31:26', 'grabbitz', 3)[0m
  [4;36;1mPermission Load (0.002772)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grabbitz PhonyBlog X()
=== permission check: destroy Role test role(10104)
  [4;35;1mRole Destroy (0.000616)[0m   [0m DELETE FROM roles
 WHERE id = 10104
[0m
  [4;36;1mRoleAssignment Load (0.001712)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000812)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001100)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10123
[0m
  [4;35;1mRoleAssignment Load (0.000978)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001350)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002075)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mUser Load (0.000805)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;35;1mUser Load (0.001468)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;36;1mUser Load (0.000768)[0m   [0;1mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;35;1mSQL (0.001300)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mFirm Load (0.000717)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;35;1mRole Load (0.001717)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mPermission Load (0.002022)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.000637)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10105, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.002054)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10105)
  [4;35;1mSQL (0.001341)[0m   [0mselect 'x' from roles where id = 10105 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.000574)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10105, 10124, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001684)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001833)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.001486)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;36;1mFirm Load (0.000729)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 3) [0m
=== FAILED permission check: change_name PhonyBlog X()
=== permission check: edit Role test role(10105)
  [4;35;1mSQL (0.002071)[0m   [0mselect 'x' from roles where id = 10105 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001343)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:26', NULL, NULL, 10105, 10168, NULL, 0, '2008-05-12 22:31:26', 'change_name', 3)[0m
  [4;35;1mPermission Load (0.001904)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: change_name PhonyBlog X()
=== permission check: change_name PhonyBlog X()
  [4;36;1mPhonyBlog Create (0.000609)[0m   [0;1mINSERT INTO blogs (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('FunkyBlog', '2008-05-12 22:31:26', 10013, 3, 3, '2008-05-12 22:31:26')[0m
=== permission check: destroy Role test role(10105)
  [4;35;1mRole Destroy (0.001151)[0m   [0m DELETE FROM roles
 WHERE id = 10105
[0m
  [4;36;1mRoleAssignment Load (0.001035)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001473)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000433)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10124
[0m
  [4;35;1mRoleAssignment Load (0.001649)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000612)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002541)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000694)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001740)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001223)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10106, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001372)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10106)
  [4;36;1mSQL (0.001993)[0m   [0;1mselect 'x' from roles where id = 10106 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001231)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10106, 10125, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001021)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002499)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000815)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grubbitz PhonyBlog FunkyBlog(10013)
=== permission check: edit Role test role(10106)
  [4;35;1mSQL (0.002060)[0m   [0mselect 'x' from roles where id = 10106 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001351)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:26', 10013, 'FunkyBlog', 10106, 10169, NULL, 0, '2008-05-12 22:31:26', 'grubbitz', NULL)[0m
  [4;35;1mPermission Load (0.002013)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grubbitz PhonyBlog FunkyBlog(10013)
=== permission check: destroy Role test role(10106)
  [4;36;1mRole Destroy (0.001263)[0m   [0;1m DELETE FROM roles
 WHERE id = 10106
[0m
  [4;35;1mRoleAssignment Load (0.001043)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001474)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000434)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10125
[0m
  [4;36;1mRoleAssignment Load (0.001640)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000606)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002627)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000725)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001725)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001227)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10107, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001390)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10107)
  [4;35;1mSQL (0.002009)[0m   [0mselect 'x' from roles where id = 10107 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001232)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10107, 10126, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001018)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002600)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000841)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grabbitz PhonyBlog FunkyBlog(10013)
=== permission check: edit Role test role(10107)
  [4;36;1mSQL (0.002073)[0m   [0;1mselect 'x' from roles where id = 10107 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001342)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:26', 10013, 'FunkyBlog', 10107, 10170, NULL, 0, '2008-05-12 22:31:26', 'grabbitz', NULL)[0m
  [4;36;1mPermission Load (0.001996)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grabbitz PhonyBlog FunkyBlog(10013)
=== permission check: grabbitz PhonyBlog FunkyBlog(10013)
=== permission check: destroy Role test role(10107)
  [4;35;1mRole Destroy (0.001266)[0m   [0m DELETE FROM roles
 WHERE id = 10107
[0m
  [4;36;1mRoleAssignment Load (0.001042)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.001470)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.000440)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10126
[0m
  [4;35;1mRoleAssignment Load (0.001646)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.000610)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002634)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000722)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mRole Load (0.001731)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001231)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10108, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001528)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10108)
  [4;36;1mSQL (0.002096)[0m   [0;1mselect 'x' from roles where id = 10108 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001241)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10108, 10127, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001032)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002618)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000844)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: grubbitz PhonyBlog FunkyBlog(10013)
=== permission check: edit Role test role(10108)
  [4;35;1mSQL (0.002093)[0m   [0mselect 'x' from roles where id = 10108 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001343)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyBlog', 0, 0, '2008-05-12 22:31:26', 10013, 'FunkyBlog', 10108, 10171, NULL, 0, '2008-05-12 22:31:26', 'grubbitz', NULL)[0m
  [4;35;1mPermission Load (0.002118)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: grubbitz PhonyBlog FunkyBlog(10013)
=== permission check: destroy Role test role(10108)
  [4;36;1mRole Destroy (0.001295)[0m   [0;1m DELETE FROM roles
 WHERE id = 10108
[0m
  [4;35;1mRoleAssignment Load (0.001056)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.001489)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.000445)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10127
[0m
  [4;36;1mRoleAssignment Load (0.001656)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.000612)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002759)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyNeverPermits Load (0.007408)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM blogs ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001594)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000779)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001310)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000734)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001744)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002018)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000664)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10109, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002072)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10109)
  [4;36;1mSQL (0.001354)[0m   [0;1mselect 'x' from roles where id = 10109 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000576)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10109, 10128, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001704)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001848)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: edit Role test role(10109)
  [4;36;1mSQL (0.002132)[0m   [0;1mselect 'x' from roles where id = 10109 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001353)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('PhonyNeverPermits', 0, 0, '2008-05-12 22:31:26', NULL, NULL, 10109, 10172, NULL, 0, '2008-05-12 22:31:26', 'any', NULL)[0m
  [4;36;1mPermission Load (0.001920)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mPhonyNeverPermits Load (0.007128)[0m   [0mSELECT * FROM blogs WHERE (2 + 2 = 5) [0m
=== FAILED permission check: forbidden_operation PhonyNeverPermits mertz family blog(1)
=== permission check: destroy Role test role(10109)
  [4;36;1mRole Destroy (0.000609)[0m   [0;1m DELETE FROM roles
 WHERE id = 10109
[0m
  [4;35;1mRoleAssignment Load (0.001742)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000821)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001105)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10128
[0m
  [4;36;1mRoleAssignment Load (0.000988)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001282)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001866)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mUser Load (0.001567)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mRole Load (0.000861)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mPermission Load (0.002695)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: assign Role twiddler(3)
  [4;36;1mSQL (0.001553)[0m   [0;1mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mUser Load (0.001509)[0m   [0mSELECT * FROM users WHERE (users.id = 4) [0m
=== permission check: administer User ricky(4)
  [4;36;1mSQL (0.001284)[0m   [0;1mselect 'x' from users where id = 4 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000655)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 3, 10129, 4, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;36;1mRoleAssignment Update (0.001232)[0m   [0;1mUPDATE role_assignments SET updated_at = '2008-05-12 22:31:26', default_firm_id = NULL, role_id = 3, user_id = 4, invalid_after = NULL, default_user_id = NULL, created_at = '2008-05-12 22:31:26' WHERE id = 10129[0m
  [4;35;1mRole Load (0.000886)[0m   [0mSELECT * FROM roles WHERE (roles.id = 2) [0m
=== permission check: assign Role admin(2)
=== FAILED permission check: forbidden_operation RoleAssignment X(10129)
  [4;36;1mUser Load (0.001486)[0m   [0;1mSELECT * FROM users WHERE (users.id = 3) [0m
=== permission check: administer User ricky(4)
=== permission check: administer User lucy(3)
=== FAILED permission check: forbidden_operation RoleAssignment X(10129)
=== FAILED permission check: forbidden_operation RoleAssignment X(10129)
=== FAILED permission check: forbidden_operation RoleAssignment X(10129)
  [4;35;1mUser Load (0.000825)[0m   [0mSELECT * FROM users WHERE (users.id = 3) [0m
  [4;36;1mUser Load (0.001462)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.001437)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.000644)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.001396)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001065)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002678)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.001338)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10110, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.001420)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10110)
  [4;36;1mSQL (0.002015)[0m   [0;1mselect 'x' from roles where id = 10110 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.001243)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10110, 10130, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001030)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.002513)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.000843)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: administer User lucy(3)
=== permission check: edit Role test role(10110)
  [4;35;1mSQL (0.002105)[0m   [0mselect 'x' from roles where id = 10110 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mPermission Create (0.001354)[0m   [0;1mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('User', 0, 0, '2008-05-12 22:31:26', 3, 'lucy', 10110, 10173, NULL, 0, '2008-05-12 22:31:26', 'administer', NULL)[0m
  [4;35;1mPermission Load (0.002022)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: administer User lucy(3)
  [4;36;1mSQL (0.011112)[0m   [0;1mselect 'x' from users where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 5)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10110)
  [4;35;1mRole Destroy (0.000633)[0m   [0m DELETE FROM roles
 WHERE id = 10110
[0m
  [4;36;1mRoleAssignment Load (0.001737)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000812)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001105)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10130
[0m
  [4;35;1mRoleAssignment Load (0.000984)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001284)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001991)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mRole Load (0.001630)[0m   [0;1mSELECT * FROM roles WHERE (roles.id = 3) [0m
  [4;35;1mSQL (0.000645)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mRole Load (0.001727)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role test role()
  [4;35;1mRole Create (0.001229)[0m   [0mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10111, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;36;1mSQL (0.001387)[0m   [0;1mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10111)
  [4;35;1mSQL (0.002005)[0m   [0mselect 'x' from roles where id = 10111 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;36;1mRoleAssignment Create (0.001237)[0m   [0;1mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10111, 10131, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;35;1mRoleAssignment Load (0.001022)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.002598)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mSQL (0.000836)[0m   [0mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
=== FAILED permission check: assign Role twiddler(3)
=== permission check: edit Role test role(10111)
  [4;36;1mSQL (0.002096)[0m   [0;1mselect 'x' from roles where id = 10111 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001331)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:31:26', 3, 'twiddler', 10111, 10174, NULL, 0, '2008-05-12 22:31:26', 'assign', NULL)[0m
  [4;36;1mPermission Load (0.002004)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: assign Role twiddler(3)
  [4;35;1mSQL (0.011702)[0m   [0mselect 'x' from roles where id = 3 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 5
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 5)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: destroy Role test role(10111)
  [4;36;1mRole Destroy (0.000626)[0m   [0;1m DELETE FROM roles
 WHERE id = 10111
[0m
  [4;35;1mRoleAssignment Load (0.001720)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mUser Load (0.000808)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;35;1mRoleAssignment Destroy (0.001098)[0m   [0m DELETE FROM role_assignments
 WHERE id = 10131
[0m
  [4;36;1mRoleAssignment Load (0.000984)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mSQL (0.001278)[0m   [0mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mPermission Load (0.001994)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRoleAssignment Create (0.000615)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 3, 10132, 3, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;36;1mFirm Load (0.001445)[0m   [0;1mSELECT * FROM firms WHERE (firms.id = 4) [0m
  [4;35;1mRole Load (0.012624)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name IS NULL AND roles.owner_firm_id IS NULL) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.022606)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name IS NULL AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mUser Load (0.000892)[0m   [0mSELECT * FROM users WHERE (users.id = 2) [0m
  [4;36;1mRole Load (0.001664)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name IS NULL AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.000963)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name IS NULL AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.007954)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = '' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.007365)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'x' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.008015)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'ab' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.007377)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'admin' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.011783)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.007426)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'twiddler' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mRole Load (0.008063)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mRole Load (0.001145)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;36;1mUser Load (0.001489)[0m   [0;1mSELECT * FROM users WHERE (users.id = 5) [0m
  [4;35;1mUser Load (0.000771)[0m   [0mSELECT * FROM users WHERE (users.id = 6) [0m
  [4;36;1mSQL (0.001299)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mFirm Load (0.000713)[0m   [0mSELECT * FROM firms WHERE (firms.id = 2) [0m
  [4;36;1mRole Load (0.001711)[0m   [0;1mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'test role' AND roles.owner_firm_id = 2) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
  [4;35;1mPermission Load (0.002014)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 6
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
=== permission check: create Role test role()
  [4;36;1mRole Create (0.000651)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('test role', '2008-05-12 22:31:26', 10112, 2, 5, '2008-05-12 22:31:26')[0m
=== permission check: administer User unprivileged(5)
  [4;35;1mSQL (0.002075)[0m   [0mselect 'x' from users where id = 5 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'administer' or p.privilege = 'any')
 and (p.class_name = 'User')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or users.id = 6)
 and (p.target_id is null or users.id = p.target_id) and (p.target_owner_firm_id is null or users.owner_firm_id = p.target_owner_firm_id)
 )
[0m
=== permission check: assign Role test role(10112)
  [4;36;1mSQL (0.001370)[0m   [0;1mselect 'x' from roles where id = 10112 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'assign' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mRoleAssignment Create (0.000582)[0m   [0mINSERT INTO role_assignments (default_firm_id, updated_at, role_id, id, user_id, invalid_after, created_at, default_user_id) VALUES(NULL, '2008-05-12 22:31:26', 10112, 10133, 5, NULL, '2008-05-12 22:31:26', NULL)[0m
  [4;36;1mRoleAssignment Load (0.001689)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001840)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;36;1mSQL (0.001500)[0m   [0;1mSELECT count(*) AS count_all FROM roles INNER JOIN role_assignments ON roles.id = role_assignments.role_id WHERE ((role_assignments.user_id = 5) AND (((role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate)))) [0m
  [4;35;1mRole Load (0.001103)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== FAILED permission check: create Role xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx()
=== permission check: edit Role test role(10112)
  [4;36;1mSQL (0.002106)[0m   [0;1mselect 'x' from roles where id = 10112 and exists
 (select 'x' from permissions p
 where exists (select 'x' from role_assignments
 where user_id = 6
 and role_assignments.role_id = p.role_id
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))
 and (p.privilege = 'edit' or p.privilege = 'any')
 and (p.class_name = 'Role')
 and (p.is_grant = 0)
 and (p.target_owned_by_self = 0 or roles.owner_id = 6)
 and (p.target_id is null or roles.id = p.target_id) and (p.target_owner_id is null or roles.owner_id = p.target_owner_id) and (p.target_owner_firm_id is null or roles.owner_firm_id = p.target_owner_firm_id)
 )
[0m
  [4;35;1mPermission Create (0.001353)[0m   [0mINSERT INTO permissions (class_name, is_grant, target_owned_by_self, updated_at, target_id, target_name, role_id, id, target_owner_firm_id, has_grant_option, created_at, privilege, target_owner_id) VALUES('Role', 0, 0, '2008-05-12 22:31:26', NULL, NULL, 10112, 10175, 4, 0, '2008-05-12 22:31:26', 'create', NULL)[0m
  [4;36;1mPermission Load (0.002011)[0m   [0;1mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
  [4;35;1mRole Load (0.001856)[0m   [0mselect * from (select raw_sql_.*, rownum raw_rnum_ from (SELECT * FROM roles WHERE (roles.name = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' AND roles.owner_firm_id = 4) ) raw_sql_ where rownum <= 1) where raw_rnum_ > 0[0m
=== permission check: create Role xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx()
  [4;36;1mRole Create (0.004129)[0m   [0;1mINSERT INTO roles (name, updated_at, id, owner_firm_id, owner_id, created_at) VALUES('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx', '2008-05-12 22:31:26', 10113, 4, 2, '2008-05-12 22:31:26')[0m
=== permission check: destroy Role test role(10112)
  [4;35;1mRole Destroy (0.000588)[0m   [0m DELETE FROM roles
 WHERE id = 10112
[0m
  [4;36;1mRoleAssignment Load (0.001751)[0m   [0;1mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mUser Load (0.000810)[0m   [0mSELECT * FROM users WHERE (users.id = 5) [0m
=== permission check: administer User unprivileged(5)
  [4;36;1mRoleAssignment Destroy (0.001104)[0m   [0;1m DELETE FROM role_assignments
 WHERE id = 10133
[0m
  [4;35;1mRoleAssignment Load (0.000980)[0m   [0mSELECT * FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;36;1mSQL (0.001275)[0m   [0;1mSELECT count(*) AS count_all FROM role_assignments WHERE (role_assignments.user_id = 5) [0m
  [4;35;1mPermission Load (0.001952)[0m   [0mSELECT * FROM permissions WHERE (role_id in (select role_id from role_assignments
 where user_id = 5
 and (role_assignments.invalid_after is null
 or role_assignments.invalid_after > sysdate))) [0m
